
<!DOCTYPE html>
<html lang="zh">

<head>
    <link href='../../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../../theme/stylesheet/normalize.min.css">
    <script src="../../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../../..">
                <img src="../../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="输入以搜索">
            </form>
        </div>


        <ul class="global_lang">
                    <li><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../../standard/language-independent.html">Language Independent 缺陷文档</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../../standard/c.html">c/c++ 缺陷文档</a>
                        (316)
                    </li>
                    <li>
                        <a href="../../../standard/csharp.html">csharp 缺陷文档</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../../standard/golang.html">golang 缺陷文档</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../../standard/java.html">java 缺陷文档</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../../standard/javascript.html">javascript 缺陷文档</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../../standard/objective-c.html">objective-c 缺陷文档</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../../standard/php.html">php 缺陷文档</a>
                        (58)
                    </li>
                    <li>
                        <a href="../../../standard/python.html">python 缺陷文档</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../../standard/swift.html">swift 缺陷文档</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            安全策略管理 (27)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE2004">使用危险函数strcpy</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用危险函数strcpy</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">c</a>
                <a href="../../../tag/objective-c.html">objective-c</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE2005">使用危险函数strcat</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用危险函数strcat</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">c</a>
                <a href="../../../tag/objective-c.html">objective-c</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE2006">使用危险函数gets</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用危险函数gets</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">c</a>
                <a href="../../../tag/objective-c.html">objective-c</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0109">使用弱随机算法生成固定密钥</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用弱随机算法生成固定密钥</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">c</a>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4007">存储可恢复的口令</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>采用双向可逆的加密算法加密口令并将口令存储在外部文件或数据库中。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者有机会通过解密算法对口令进行解密。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>低</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>当业务不需要取已存储的口令进行还原时，使用单向加密算法对口令进行加密并存储。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"aes.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">AESEncryption</span> <span class="n">aesEncryptor</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">aesEncryptor</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="n">output</span><span class="p">);</span>  <span class="c1">//使用双向可逆的AES加密算法</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">store_password</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">);</span>  <span class="c1">//将口令存放到数据库中</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
    <span class="kt">char</span> <span class="n">psw</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">encryptor</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">psw</span><span class="p">);</span>  <span class="c1">//加密password</span>
    <span class="n">store_password</span><span class="p">(</span><span class="n">psw</span><span class="p">);</span>  <span class="c1">//存放加密后的psw</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"sha.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encrypt</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">SHA256</span> <span class="n">sha256</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">r</span><span class="o">=</span> <span class="n">sha256</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>  <span class="c1">//使用单向不可逆的SHA256加密算法</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">store_password</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">);</span>  <span class="c1">//将口令存放到数据库中</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
    <span class="kt">char</span> <span class="n">psw</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">encryptor</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">psw</span><span class="p">);</span>  <span class="c1">//加密password</span>
    <span class="n">store_password</span><span class="p">(</span><span class="n">psw</span><span class="p">);</span>  <span class="c1">//存放加密后的psw</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4006">公有函数返回私有数组</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>类中定义的私有数组属性在该类的公有函数中被作为返回值返回。</p>
<h1 id="_2">漏洞与风险</h1>
<p>类中的私有数组作为函数的返回值暴露到了公有区域，存在该私有数组成员在公有区域被篡改的风险。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>当私有数组成员的数据需要作为公有函数的返回值时，应返回该私有数组的副本。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">CTest</span>
<span class="p">{</span>
    <span class="nl">private</span><span class="p">:</span>
        <span class="kt">char</span> <span class="n">secret</span><span class="p">[</span><span class="n">MAX_SIZE</span><span class="p">]</span> <span class="o">=</span> <span class="s">"abcd"</span><span class="p">;</span>
    <span class="nl">public</span><span class="p">:</span>
        <span class="kt">char</span><span class="p">[]</span> <span class="n">get_value</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">secret</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">CTest</span>
<span class="p">{</span>
    <span class="nl">private</span><span class="p">:</span>
        <span class="kt">char</span> <span class="n">secret</span><span class="p">[</span><span class="n">MAX_SIZE</span><span class="p">]</span> <span class="o">=</span> <span class="s">"abcd"</span><span class="p">;</span>
    <span class="nl">public</span><span class="p">:</span>
        <span class="kt">char</span> <span class="n">cpy_secret</span><span class="p">[</span><span class="n">MAX_SIZE</span><span class="p">];</span>
        <span class="kt">char</span><span class="p">[]</span> <span class="n">get_value</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">memcpy</span><span class="p">(</span><span class="n">cpy_secret</span><span class="p">,</span> <span class="n">secret</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">secret</span><span class="p">));</span>  <span class="c1">//创建私有数组的副本</span>
            <span class="k">return</span> <span class="n">cpy_secret</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1107">脆弱的哈希加密算法</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>该软件对密码进行了哈希加密，但该哈希加密算法使用到的计算性力度达不到使破解攻击无法进行或需要耗资才能达到的程度。</p>
<h1 id="_2">漏洞与风险</h1>
<p>很多哈希算法都以执行迅速、开销小为目标，其中甚至包含加密用的哈希算法。但这样设计出来的高效哈希算法会给存储密码带来问题，因为它们在高效的同时也给攻击者的蛮力破解算法加了把劲。如果攻击者能过通过某些途径（如对存储哈希加密后的密码的数据库进行SQL注入）获取到这些哈希值，他们就能够将这些哈希值离线保存，然后再用各种方法来高效地计算这些哈希值，最终将密码破解。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>使用可调整计算性力度的哈希函数。</li>
<li>在使用工业界认可的技术时，请正确地使用它们。</li>
</ul>
<h1 id="_5">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/916.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1073">代码的正确性</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
<li><a href="#2">漏洞代码示例2</a></li>
<li><a href="#2_1">漏洞代码修复示例2</a></li>
</ul>
</li>
<li><a href="#_8">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>在JVM中，两个类是一个相同的类（也就是相同的类型）当且仅当他们是被相同的类加载器加载且拥有相同的完全拓展名<a href="https://wiki.sei.cmu.edu/confluence/display/java/Rule+AA.+References#RuleAA.References-JVMSpec99">JVMSpec 1999</a>。类名相同但包名不同的两个类归为不同的类，类型的，有用相同的完全拓展名但以不同的类加载器加载的两个类归为不同的类。</p>
<h1 id="_2">漏洞与风险</h1>
<p>有时候，检查一个对象是否属于某个特定的类，或两个对象是否属于相同的类是有必要的，例如，当实现<code>equals()</code>方法时。如果这样的比较没有处理正确，那么将有可能出现实际上不相同的两个类被判为相同的类的情况。因此，你不应该使用类名来判断两个类是否属于同一个类。</p>
<p>依据不安全代码的行为，这样的缺陷可能会引发混合匹配（mix-and-match）攻击。</p>
<p>相反地，源自于同一个codebase的类必然是相同的——这种假设充满疑点，是不可靠的。尽管在众多的桌面应用中，上述假设都被视作成立，但若涉及到J2EE的servlet容器，那么情况就不是这样了。servlet容器可以再运行时不重启JVM来实现通过不同的类加载器来部署和重复调用应用。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>通过类之间的等价关系来决定类型（通过使用<code>getClass()</code>方法以及<code>==</code>操作符），而不是通过类名。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>这段缺陷代码通过比较类名来判断<code>auth</code>对象是否属于<code>com.application.auth.DefaulAuthenticationHandler</code>类，并以结果来选择分支：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class object</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span>
      <span class="s">"com.application.auth.DefaultAuthenticationHandler"</span><span class="o">))</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>因为不同的类加载器能加载本该相同的类（如果同一个类两次加载都是使用相同的类加载器的话）到一个JVM中，只与完全拓展类名进行比较还是不足够的。</p>
<h3 id="_7">漏洞代码修复示例</h3>
<p>这段合规代码通过将<code>auth</code>对象的类对象（<code>class object</code>）与标准的验证<code>handler</code>的类对象进行比较：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class name</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">com</span><span class="o">.</span><span class="na">application</span><span class="o">.</span><span class="na">auth</span><span class="o">.</span><span class="na">DefaultAuthenticationHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p><code>==</code>操作符的右部直接展示了标准的验证<code>handler</code>的类名，在这种标准的验证<code>handler</code>类还没有被类加载器加载的情况下，Java Runtime会对该类的加载进行管理，最终，这两个类对象的比较正确地进行。</p>
<h3 id="2">漏洞代码示例2</h3>
<p>这段不合规的代码通过使用<code>equals()</code>方法来比较对象<code>x</code>和<code>y</code>的类对象名。存在这样的情况，虽然<code>x</code>和<code>y</code>拥有相同的名字，但他们是被不同的类加载器加载的，那么他们是两个不同的类。</p>
<h3 id="2_1">漏洞代码修复示例2</h3>
<p>这段合规的代码正确地比较了两个对象的类：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether objects x and y have the same class</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="o">{</span>
  <span class="c1">// Objects have the same class</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_8">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/OBJ09-J.+Compare+classes+and+not+class+names <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/486.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4008">使用已破解或危险的加密算法</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>软件采用已破解或自定义的非标准加密算法。</p>
<h1 id="_2">漏洞与风险</h1>
<p>使用已破解或非标准的加密算法是很危险的，因为攻击者有可能会破解算法，从而窃取所保护的数据。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>采用目前加密领域中加密强度较高的标准加密算法。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"des.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">get_key</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">[]);</span>  <span class="c1">//从安全存储中取密钥</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">output</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="c1">//使用加密强度较低的DES加密算法</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="n">DES</span><span class="o">::</span><span class="n">KEYLENGTH</span><span class="p">];</span>
    <span class="n">DESEncryption</span> <span class="n">desEncryptor</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">get_key</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
    <span class="p">...</span>
    <span class="n">desEncryptor</span><span class="p">.</span><span class="n">SetKey</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">DES</span><span class="o">::</span><span class="n">KEYLENGTH</span><span class="p">);</span>  <span class="c1">//设置密钥</span>
    <span class="n">desEncryptor</span><span class="p">.</span><span class="n">ProcessBlock</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>  <span class="c1">//加密input并保存到output中</span>
    <span class="k">return</span> <span class="n">output</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"aes.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">get_key</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">[]);</span>  <span class="c1">//从安全存储中取密钥</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">output</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="c1">//使用加密强度较高的AES加密算法</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="n">AES</span><span class="o">::</span><span class="n">BLOCKSIZE</span><span class="p">];</span>
    <span class="n">AESEncryption</span> <span class="n">aesEncryptor</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">xorBlock</span><span class="p">[</span><span class="n">AES</span><span class="o">::</span><span class="n">BLOCKSIZE</span><span class="p">];</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">xorBlock</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AES</span><span class="o">::</span><span class="n">BLOCKSIZE</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">get_key</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
    <span class="p">...</span>
    <span class="n">aesEncryptor</span><span class="p">.</span><span class="n">SetKey</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">::</span><span class="n">DEFAULT_KEYLENGTH</span><span class="p">);</span>  <span class="c1">//设置密钥</span>
    <span class="n">aesEncryptor</span><span class="p">.</span><span class="n">ProcessAndXorBlock</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">xorBlock</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>  <span class="c1">//加密input并保存到output中</span>
    <span class="k">return</span> <span class="n">output</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1070">不安全的SSL</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#_8">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>当软件通过被盗用的CA签发的证书来与站点建立连接，攻击者可以通过中间人攻击盗取敏感数据。
为了确保数据完整性，证书必须有效并且必须与正在访问的站点有关。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者将能够拦截信任这些被盗CA的SSL/TLS</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>仅使用受信任的证书</li>
<li>使用有效并且与站点相关的证书</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">connect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">URLConnection</span> <span class="n">urlConnection</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
                <span class="k">return</span> <span class="n">urlConnection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="o">...</span>
            <span class="o">}</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>使用默认的CA建立SSL连接</p>
<h3 id="_7">漏洞代码修复示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">safeConnect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">TrustManager</span><span class="o">[]</span> <span class="n">tm</span> <span class="o">=</span> <span class="o">{</span> <span class="k">new</span> <span class="n">X509TrustManager</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkClientTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkServerTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="n">X509Certificate</span><span class="o">[]</span> <span class="nf">getAcceptedIssuers</span><span class="o">()</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>
            <span class="o">}};</span>
            <span class="n">SSLContext</span> <span class="n">context</span> <span class="o">=</span> <span class="n">SSLContext</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SSL"</span><span class="o">);</span>
            <span class="n">context</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">tm</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>

            <span class="n">HttpsURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpsURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">setSSLSocketFactory</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getSocketFactory</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">...</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>使用自定义的信任的证书建立了SSL/TLS连接</p>
<h1 id="_8">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE310">
<p>https://cwe.mitre.org/data/definitions/310.html <a class="footnote-backref" href="#fnref-CWE310" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A3">
<p>https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure <a class="footnote-backref" href="#fnref-OWASP-A3" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1109">不安全的存储</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>该软件没有在存储或传输前对敏感或关键数据进行加密。</p>
<h1 id="_2">漏洞与风险</h1>
<p>没有对HTTPS session中敏感的cookie值的<code>Secure</code>属性进行设置，使得用户代理可能会在一个HTTPS session中以明文形式传递coockie。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>明确设计指明哪些重要的数据或资源需要进行加密保护。</li>
<li>确保系统设计中妥善处理好加密这一环。</li>
<li>区分不同场景下对加密的需求。</li>
<li>在使用工业界认可的方法时，请正确使用它们。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>以下的缺陷代码片段来自一个servlet doPost()方法，它会设置cookie中accountID这一敏感者，但中途缺少了对<code>setSecure(true)</code>的调用：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Cookie</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="n">ACCOUNT_ID</span><span class="o">,</span> <span class="n">acctID</span><span class="o">);</span>
<span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="_7">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe1">
<p>https://cwe.mitre.org/data/definitions/614.html <a class="footnote-backref" href="#fnref-cwe1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe2">
<p>https://cwe.mitre.org/data/definitions/311.html <a class="footnote-backref" href="#fnref-cwe2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4013">没有对口令域进行掩饰</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>用户输入口令时没有对口令域进行掩饰。</p>
<h1 id="_2">漏洞与风险</h1>
<p>增加了攻击者通过观察屏幕获取到口令的可能性。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>用户输入口令时对口令域进行掩饰。通常，用户输入的每一个字符都应该以星号形式回显。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="n">password</span><span class="p">[</span><span class="n">MAX_STR_LEN</span><span class="p">];</span>  <span class="c1">//MAX_STR_LEN的值为15</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="sc">'0'</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Please enter the password: "</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_STR_LEN</span> <span class="o">&amp;&amp;</span> <span class="n">c</span><span class="o">!=</span><span class="sc">'\n'</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%c"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">c</span><span class="p">);</span>  <span class="c1">//没对用户输入的口令进行掩饰</span>
        <span class="n">password</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="n">password</span><span class="p">[</span><span class="n">MAX_STR_LEN</span><span class="p">];</span>  <span class="c1">//MAX_STR_LEN的值为15</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="sc">'0'</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Please enter the password: "</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_STR_LEN</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">getch</span><span class="p">())</span><span class="o">!=</span><span class="sc">'\n'</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">password</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">putchar</span><span class="p">(</span><span class="sc">'*'</span><span class="p">);</span>  <span class="c1">//用星号代替用户所输入的口令</span>
        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1074">访问控制</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#_8">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>调用安全敏感型方法的应用代码必须对传入该类方法的参数进行验证。</p>
<h1 id="_2">漏洞与风险</h1>
<p>特别地，某些安全敏感型方法会将null值解释为无害的值，但它们可能会重写默认的设置。尽管安全敏感型方法应该保守性编码，但用户端代码仍要对方法的参数进行验证，否则，未经验证的参数可能会被视作有效值被接收。没做到这点，那么将有可能出现权限放大及任意代码执行问题。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>透彻地理解安全敏感型方法并对它们的参数进行验证，以避免因意外参数值导致的边界情况。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>这段存在缺陷的代码展示了接收两个参数且以第二个参数作为访问控制上下文的<code>doPrivileged()</code>方法，它从先前保存的上下文中恢复访问权限：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>当传入的访问控制上下文为null时，<code>doPrivileged()</code>方法无法将当前的访问控制权限降至先前保存的上下文的访问控制权限。因此，当<code>accessCibtrikCibtext</code>参数为<code>null</code>时，这段代码将给当前访问控制上下文赋予过高的权限。</p>
<h3 id="_7">漏洞代码修复示例</h3>
<p>这个合规的解决方案通过确保<code>accessControlContext</code>不为<code>null</code>来避免赋予过高的权限：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">(</span><span class="n">accessControlContext</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">SecurityException</span><span class="o">(</span><span class="s">"Missing AccessControlContext"</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="_8">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC55-J.+Ensure+that+security-sensitive+methods+are+called+with+validated+arguments <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1083">不安全的随机性</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#_8">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>伪随机数生成器（Pseudorandom number generators，即PRNGs）使用决定性的数学算法来产生具有良好统计属性的数字序列，但这样产生的数字序列并没有真正的随机性。PRNGs通常需要一个起始的种子，实现算法将使用这个种子来产生一个数字以及一个新的种子，并再借由新产生的种子来往复循环相同的过程。</p>
<h1 id="_2">漏洞与风险</h1>
<p>Java API中<code>java.util.Random</code>包提供了一种PRNG实现。这个PRGN具有便携性和可重复性，因此，在所有Java版本的实现中，使用同一个种子创建的两个<code>java.util.Random</code>类的实例会生成相同的随机数序列。随机数种子的值通常会在应用初始化时被重用，除非重启了机器。排除掉重启机器的情况时，随机数种子值由来自系统时钟的现时时间决定。攻击者会通过监测缺陷目标中的随机数种子值，然后创建一张查找表来预测未来的随机数种子值。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>使用安全性更好的随机数生成器，如<code>java.security.SecureRandom</code>类。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>这段缺陷代码使用了不安全的<code>java.util.Random</code>类，因为这个类对相同的种子值能产生同样的伪随机数序列，也就是说这个序列是可预测的：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="n">Random</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="mi">123L</span><span class="o">);</span>
<span class="c1">//...</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="c1">// Generate another random integer in the range [0, 20]</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">);</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">漏洞代码修复示例</h3>
<p>这段合规代码使用<code>java.security.SecureRandom</code>类来产生可靠的随机数序列：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
  <span class="n">SecureRandom</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
  <span class="c1">// Generate 20 integers 0..20</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_8">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/MSC02-J.+Generate+strong+random+numbers <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0133">成功登录后不会更新会话ID</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">缓解与预防</a></li>
<li><a href="#_4">漏洞利用威胁</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>对用户进行身份验证或以其他方式建立新用户会话，而不会使任何现有会话标识符失效，这使攻击者有机会窃取经过身份验证的会话。</p>
<p>这种情况通常在以下情况下观察到：
1 Web应用程序在不先使现有会话无效的情况下对用户进行身份验证，从而继续使用已与用户关联的会话。
2 攻击者能够强制用户已知的会话标识符，以便一旦用户认证，攻击者就可以访问已认证的会话。
3 应用程序或容器使用可预测的会话标识符。 在会话固定漏洞的通用漏洞攻击中，攻击者在Web应用程序上创建一个新会话并记录关联的会话标识符。 攻击者然后使受害者使用该会话标识符与服务器相关联，并可能进行身份验证，从而使攻击者能够通过活动会话访问用户的帐户。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者能够强制用户已知的会话标识符，以便一旦用户认证，攻击者就可以访问已认证的会话。</p>
<h1 id="_3">缓解与预防</h1>
<p>在授权新用户会话之前使任何现有的会话标识符失效。</p>
<h1 id="_4">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h3 id="_7">漏洞代码修复示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">invalidate</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>使用invalidate()把现有的会话标识符失效。</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/384.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/cwe-384.html">CWE-384</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4010">密码分组链接模式未使用随机初始化矢量</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>密码分组链接模式使用的初始化向量不是一个随机数。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者有机会通过字典式攻击读取加密的数据。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>密码分组链接模式使用随机的初始化向量。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"aes.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">key_size</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="n">key_size</span><span class="p">];</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">iv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x08</span><span class="p">};</span>
    <span class="p">...</span>
    <span class="n">CBC_Mode</span><span class="o">&lt;</span><span class="n">AES</span><span class="o">&gt;::</span><span class="n">Encryption</span> <span class="n">Encryptor</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key_size</span><span class="p">,</span> <span class="n">iv</span><span class="p">);</span>  <span class="c1">//使用固定的初始化向量</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;wincrypt.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">"aes.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">key_size</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">HCRYPTPROV</span> <span class="n">hcryptprov</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="n">key_size</span><span class="p">];</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">iv</span><span class="p">[</span><span class="n">key_size</span><span class="p">];</span>
    <span class="p">...</span>
    <span class="k">if</span><span class="p">(</span><span class="n">CryptGenRandom</span><span class="p">(</span><span class="n">hcryptprov</span><span class="p">,</span> <span class="n">EVP_MAX_IV_LENGTH</span><span class="p">,</span> <span class="n">iv</span><span class="p">))</span>  <span class="c1">//使用随机的初始化向量</span>
    <span class="p">{</span>
        <span class="n">CBC_Mode</span><span class="o">&lt;</span><span class="n">AES</span><span class="o">&gt;::</span><span class="n">Encryption</span> <span class="n">Encryptor</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key_size</span><span class="p">,</span> <span class="n">iv</span><span class="p">);</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1091">违反信任边界</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>可以把信任边界想象成划分一个程序的一条界线，在线的一边，这不是的数据是不受信的；而在线的另外一边，数据都是受信的。程序的验证逻辑都是围绕这条线开展的——通过验证不受信一边的数据，把验证通过的数据移动到受信数据的一边。当程序模糊了信任边界时，我们称程序违反了信任边界原则。当在同一个数据结构中混杂了受信与不受信的数据时，程序员会更轻易地把不受信的数据当成受信数据。</p>
<h1 id="_2">漏洞与风险</h1>
<p>当没有明确定义或久不维护信任边界时，程序员不可避免地会对哪些数据经过了认证而哪些没有经过验证的问题摸不着头脑。放任这种情况不管，最终会使得程序员直接使用没有经过验证的不受信数据。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>明确定义并尊重信任边界。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>以下的代码展现了程序不对HTTP请求中的用户名信息验证，判断用户是否经过了认证，直接就把用户名参数存在了HTTP会话对象中：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">usrname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"usrname"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">,</span> <span class="n">usrname</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_7">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/501.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1089">不安全的清洗规则</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>该软件没有或不恰当地中立化由上游设备接收到的输入信息中的特殊字符，如"&lt;"、"&gt;"和"&amp;"，当它们被送往处理网页内容的下游设备时，将会被错误地解释成Web脚本元素。</p>
<h1 id="_2">漏洞与风险</h1>
<p>这将会使类似的字符被当做控制字符，当在特定的用户会话（Session）下时会被客户端执行。尽管这样的问题可以分到注入类下，但更相关的问题是在展现给用户之前已经对这些特殊字符做了与各个上下文不相符的转换。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>仔细对照白名单中允许的字符和格式，对输入进行检查。</li>
<li>使用并指明读取上游输出的下游设备能够处理的输出编码。</li>
<li>在Struts下，直接写入来自将filter属性设置为true的表单bean的数据。</li>
<li>为了缓解针对用户会话Cookie的XSS攻击，请将会话Cookie设置为HttpOnly。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>在下面的例子中，在展示给客户端浏览器前，访客留言簿没有合理地被加密、过滤，即没有合理地对脚本相关的标签进行中立化：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">&lt;%</span> <span class="k">for</span> <span class="o">(</span><span class="n">Iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">guestbook</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();</span> <span class="o">)</span> <span class="o">{</span>
<span class="n">Entry</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="n">Entry</span><span class="o">)</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span> <span class="k">%&gt;</span>
<span class="nt">&lt;p&gt;</span>Entry #<span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getText</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="k">&lt;%</span>
<span class="o">}</span> <span class="k">%&gt;</span>
</pre></div>
</td></tr></table>
<h1 id="_7">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/80.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0094">使用伪随机数发生器（PRNG）</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">缓解与预防</a></li>
<li><a href="#_4">漏洞利用威胁</a></li>
<li><a href="#_5">演示示例</a><ul>
<li><a href="#1">漏洞缺陷示例 1</a></li>
<li><a href="#2">漏洞缺陷示例 2</a></li>
</ul>
</li>
<li><a href="#_6">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>伪随机数发生器（PRNG）通常不是为密码学设计的。有时对于使用随机数的算法来说，一个平庸的随机性来源是足够的或者更好的。 弱发生器通常需要较少的处理能力和不使用系统上珍贵的有限熵源。虽然这些PRNG可能具有非常有用的功能，但可以使用这些相同的功能来破解加密。</p>
<h1 id="_2">漏洞与风险</h1>
<p>如果使用PRNG进行身份验证和授权（例如会话ID或用于生成加密密钥的种子），则攻击者可能能够轻松地猜出ID或加密密钥并获得对受限功能的访问权限。</p>
<h1 id="_3">缓解与预防</h1>
<p>使用为所有加密使用基于硬件的随机数生成的函数。在Windows上使用CyptGenRandom，在Linux上使用hw_rand()。</p>
<h1 id="_4">漏洞利用威胁</h1>
<p>Low</p>
<h1 id="_5">演示示例</h1>
<h3 id="1">漏洞缺陷示例 1</h3>
<p>本例使用伪随机数发生器rand()生成一个随机数：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">());</span>
<span class="kt">int</span> <span class="n">randNum</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
</pre></div>
</td></tr></table>
<h3 id="2">漏洞缺陷示例 2</h3>
<p>这个例子使用random()函数生成一个10个伪随机数的序列。当random()缺少种子时，它的行为就像rand()，每次运行使用它的程序时都会产生相同的随机数序列。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">func</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* Always generates the same sequence */</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%ld, "</span><span class="p">,</span> <span class="n">random</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="_6">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/338.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/c.html">C++</a>
                <a href="../../../tag/cwe-338.html">CWE-338</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4016">RSA算法未使用最优非对称加密填充</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用RSA加密算法时未使用最优非对称加密填充。</p>
<h1 id="_2">漏洞与风险</h1>
<p>未使用最优非对称加密填充将降低攻击者解密的难度。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>使用RSA加密算法时使用最优非对称加密填充。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"rsa.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">RSAES_PKCS1v15_Encryptor</span> <span class="n">rsapkcs1</span><span class="p">;</span>  <span class="c1">//使用Pkcs1填充</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">rsapkcs1</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"rsa.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">RSAES_OAEP_SHA_Encryptor</span> <span class="n">rsaoaep</span><span class="p">;</span>  <span class="c1">//使用OAEP加密填充</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">rsaoaep</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1090">权限管理</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>因为应用没有合理地分配权限或者根据未知来源的信息分配权限，导致给用户赋予了危险的权限。</p>
<h1 id="_2">漏洞与风险</h1>
<p>不合理的权限管理可能会导致不受信的、权限不足的代码拥有某些需要额外权限的操作的执行权。然而，把权限管理精细地做到位会增加很多复杂性。因此，安全方面提升带来的收益必须要盖过额外的复杂度以及相应降低可维护性带来的问题。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>小心地处理好配置、管理以及权限相关的问题，明确管理软件中的可信区域。</li>
<li>用可完成相应任务的最低权限来运行你的代码。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>以下程序为使接收方程序以备份意图来读取数据文件，在发送的内容中增加了一个标志：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">();</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="s">"com.example.BackupUserData"</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">file_uri</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">addFlags</span><span class="o">(</span><span class="n">FLAG_GRANT_READ_URI_PERMISSION</span><span class="o">);</span>
<span class="n">sendBroadcast</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>任何恶意程序都能通过预先注册，从而接收到有关备份意图的数据。因为确实附着了<code>FLAG_GRANT_READ_URI_PERMISSION</code>标签，因而恶意的接收者都能读取用户的数据：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CallReceiver</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Uri</span> <span class="n">userData</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
    <span class="n">stealUserData</span><span class="o">(</span><span class="n">userData</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_7">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CWE264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A6">
<p>https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration <a class="footnote-backref" href="#fnref-OWASP-A6" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4002">不可信的搜索路径</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>程序使用关键资源时没有指定资源的路径，而是依赖操作系统去搜索资源。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者可以在搜索优先级更高的文件夹中放入相同名称的资源，程序会使用攻击者控制的资源。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>低</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>使用关键资源时指定资源所在的路径。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//攻击者可在搜索优先级更高的文件夹中放入和dir同名的恶意程序导致command的内容无法正确执行</span>
    <span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>  <span class="c1">//本例中command = "dir.exe E:\\data"</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//PATH是存放操作系统中dir命令所在完整路径的常量，本例中PATH="C:\\WINDOWS\\system32\\"</span>
    <span class="kt">char</span> <span class="n">cmd</span><span class="p">[</span><span class="n">MAX_SIZE</span><span class="p">]</span> <span class="o">=</span> <span class="n">PATH</span><span class="p">;</span>  <span class="c1">//使用完整路径确保command的内容能正确执行</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">command</span><span class="p">);</span>  <span class="c1">//本例中command = "dir.exe E:\\data"</span>
    <span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">);</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4014">通过用户控制的SQL关键字绕过授权</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>软件使用的数据库表其中包括了某个用户不应有权访问的记录，但该软件执行的一个SQL语句中的关键字却可以受该用户控制。</p>
<h1 id="_2">漏洞与风险</h1>
<p>如果用户可以将关键字设置为任何值，那么该用户就可以修改该关键字指向未经授权的记录。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>对用户输入的关键字进行验证，确保其只能访问该用户有权访问的记录。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="kt">char</span> <span class="n">username</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>  <span class="c1">//用户名</span>
<span class="p">...</span>
<span class="kt">int</span> <span class="n">sql_compare</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">);</span>  <span class="c1">//判断字符串是否符合构建sql语句的要求，是则返回1，否则返回0</span>
<span class="kt">void</span> <span class="nf">sql_query</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">staffID</span><span class="p">)</span>  <span class="c1">//staffID为用户输入数据，不超过10个字符</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sql_compare</span><span class="p">(</span><span class="n">staffID</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="kt">char</span> <span class="n">sqlQuery</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span> <span class="o">=</span> <span class="s">"SELECT * FROM employee WHERE staffID = '"</span><span class="p">;</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">sqlQuery</span><span class="p">,</span> <span class="n">staffID</span><span class="p">);</span>  <span class="c1">//用户输入的staffID可能不在其访问权限内</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">sqlQuery</span><span class="p">,</span> <span class="s">"'"</span><span class="p">);</span>
        <span class="c1">//在数据库中执行sqlQuery语句</span>
        <span class="p">...</span>
    <span class="p">}</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="kt">char</span> <span class="n">username</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>  <span class="c1">//用户名</span>
<span class="p">...</span>
<span class="kt">int</span> <span class="n">sql_compare</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">);</span>  <span class="c1">//判断字符串是否符合构建sql语句的要求，是则返回1，否则返回0</span>
<span class="kt">char</span><span class="o">*</span> <span class="nf">find_departID</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">);</span>  <span class="c1">//根据用户名返回其所在部门的部门ID</span>
<span class="kt">void</span> <span class="nf">sql_query</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">staffID</span><span class="p">)</span>  <span class="c1">//staffID为用户输入数据，不超过10个字符</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sql_compare</span><span class="p">(</span><span class="n">staffID</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="c1">//查询语句增加部门ID查询条件</span>
        <span class="kt">char</span> <span class="n">sqlQuery</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span> <span class="o">=</span> <span class="s">"SELECT * FROM employee WHERE staffID = '"</span><span class="p">;</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">sqlQuery</span><span class="p">,</span> <span class="n">staffID</span><span class="p">);</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">sqlQuery</span><span class="p">,</span> <span class="s">"' and DepartID = '"</span><span class="p">);</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">sqlQuery</span><span class="p">,</span> <span class="n">find_departID</span><span class="p">(</span><span class="n">username</span><span class="p">));</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">sqlQuery</span><span class="p">,</span> <span class="s">"'"</span><span class="p">);</span>
        <span class="c1">//在数据库中执行sqlQuery语句</span>
        <span class="p">...</span>
    <span class="p">}</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4004">堆检查</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用realloc()来调整存储敏感信息的缓冲区。</p>
<h1 id="_2">漏洞与风险</h1>
<p>使用realloc()来调整存储敏感信息的缓冲区会将敏感信息暴露给攻击者，因为这些信息并没有从内存中删除掉，攻击者可能使用 “堆检查”方法（如内存转储方法）读取堆内存中的敏感信息。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>使用realloc()函数前先清空该内存块中的敏感信息。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">get_memory</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">ptr</span> <span class="p">,</span><span class="kt">int</span> <span class="n">new_size</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ptr</span> <span class="o">=</span> <span class="n">realloc</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">new_size</span><span class="p">);</span>  <span class="c1">//使用realloc()重新分配内存之前未清空该内存块信息</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ptr</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">get_memory</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">ptr</span> <span class="p">,</span><span class="kt">int</span> <span class="n">new_size</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">strlen</span><span class="p">(</span><span class="n">ptr</span><span class="p">));</span>  <span class="c1">//使用memset()置0</span>
    <span class="n">ptr</span> <span class="o">=</span> <span class="n">realloc</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">new_size</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ptr</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4015">未使用盐值计算散列值</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>软件针对口令等不应可逆的输入使用了单向加密散列，但未使用盐值。</p>
<h1 id="_2">漏洞与风险</h1>
<p>如果未使用盐值计算散列值，攻击者就更容易利用彩虹表等字典攻击技术破解口令。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>使用盐值计算散列值，增加攻击者破解口令的难度。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"sha.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">SHA256</span> <span class="n">sha256</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">Sha256</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span>  <span class="c1">//password最大长度为20个字符</span>
<span class="p">{</span>
    <span class="p">...</span>
    <span class="kt">char</span> <span class="n">psw</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">encryptor</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">psw</span><span class="p">);</span>  <span class="c1">//仅使用单向加密，还是容易被攻击者用彩虹表等方式破解口令</span>
    <span class="c1">//将加密得到的psw字符串存储到数据库中</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"sha.h"</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">"aes.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">SHA256</span> <span class="n">sha256</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">Sha256</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">send_salt</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">salt</span><span class="p">)</span>  <span class="c1">//用AES算法加密盐值后传输到另一台服务器上</span>
<span class="p">{</span>
    <span class="n">AESEncryption</span> <span class="n">aesEncryptor</span><span class="p">;</span>
    <span class="p">...</span>
    <span class="kt">char</span> <span class="n">output</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">aesEncryptor</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">salt</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
    <span class="c1">//发送加密后盐值（output）到另一台服务器上</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">char</span><span class="o">*</span> <span class="nf">random_str</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>  <span class="c1">//随机生成字符串</span>
<span class="kt">int</span> <span class="n">saltLength</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span>  <span class="c1">//password最大长度为20个字符</span>
<span class="p">{</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">salt</span> <span class="o">=</span> <span class="n">random_str</span><span class="p">(</span><span class="n">saltLength</span><span class="p">);</span>  <span class="c1">//获得一个长度为saltLength的随机字符串</span>
    <span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">password</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">salt</span><span class="p">);</span>  <span class="c1">//加入salt值</span>
    <span class="kt">char</span> <span class="n">psw</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">encryptor</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">psw</span><span class="p">);</span>  <span class="c1">//为攻击者破解口令增加难度</span>
    <span class="c1">//将加密得到的psw字符串存储到数据库中</span>
    <span class="p">...</span>
    <span class="c1">//将salt字符串加密后存储到另一台服务器的数据库中</span>
    <span class="n">send_salt</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4009">可逆的散列算法</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>软件采用的散列算法具有可逆算法，该算法可利用生成的散列值确定原始输入,或者可以找到一个输入产生相同的散列值。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者可通过逆向算法获取原始输入或产生相同散列值的输入，进而绕过依赖散列算法的安全认证。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>采用当前公认的不可逆标准散列算法。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"sha.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">SHA1</span> <span class="n">sha1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">sha1</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>  <span class="c1">//使用SHA1散列加密算法</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">"sha.h"</span><span class="cp"></span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">CryptoPP</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">encryptor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">input</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">output</span><span class="p">)</span>  <span class="c1">//加密函数，输出参数返回加密后的字符串</span>
<span class="p">{</span>
    <span class="n">SHA256</span> <span class="n">sha256</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">.</span><span class="n">enc</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>  <span class="c1">//使用SHA256标准散列加密算法</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE4011">安全关键的行为依赖反向域名解析</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">规范用法示例</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>通过反向域名解析获取IP地址的域名，然后依赖域名对主机进行身份鉴别。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者可通过DNS欺骗修改IP地址与域名的对应关系，从而绕过依赖域名的主机身份鉴别。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>要避免该漏洞，你应该：</p>
<ul>
<li>通过用户名口令、数字证书等其他手段对主机身份进行鉴别。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;arpa/inet.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;winsock.h&gt;</span><span class="cp"></span>
<span class="p">...</span>
<span class="kt">int</span> <span class="n">is_trusted</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">address</span><span class="p">)</span>  <span class="c1">//验证主机是否值得信任</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">hostent</span> <span class="o">*</span><span class="n">hp</span><span class="p">;</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">trustedHost</span> <span class="o">=</span> <span class="s">"trustme.com"</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">in_addr</span> <span class="n">myaddress</span><span class="p">;</span>
    <span class="n">myaddress</span><span class="p">.</span><span class="n">s_addr</span> <span class="o">=</span> <span class="n">inet_addr</span><span class="p">(</span><span class="n">address</span><span class="p">);</span>  <span class="c1">//将address转换成32位Ipv4地址</span>
    <span class="c1">//通过反向解析获取myaddr地址的域名</span>
    <span class="n">hp</span> <span class="o">=</span> <span class="n">gethostbyaddr</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">myaddress</span><span class="p">.</span><span class="n">s_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">in_addr</span><span class="p">),</span> <span class="n">AF_INET</span><span class="p">);</span>
    <span class="c1">//通过域名对主机进行身份鉴别</span>
    <span class="c1">//攻击者可通过DNS欺骗绕过依赖域名的主机身份鉴别</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">hp</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">hp</span><span class="o">-&gt;</span><span class="n">h_name</span><span class="p">,</span> <span class="n">trustedHost</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">trustedHost</span><span class="p">)))</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">规范用法示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">is_true</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span><span class="p">);</span>  <span class="c1">//判断用户名口令是否正确，是则返回1，否则返回0</span>
<span class="kt">int</span> <span class="nf">is_trusted</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">username</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span>  <span class="c1">//验证主机是否值得信任</span>
<span class="p">{</span>
    <span class="c1">//通过用户名口令对主机进行身份鉴别</span>
    <span class="k">return</span> <span class="n">is_true</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Pinpoint 源代码静态缺陷分析系统, 源伞科技有限公司 - 保留所有权利
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>