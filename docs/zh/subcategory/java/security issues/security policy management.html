
<!DOCTYPE html>
<html lang="zh">

<head>
    <link href='../../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../../theme/stylesheet/normalize.min.css">
    <script src="../../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../../..">
                <img src="../../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="输入以搜索">
            </form>
        </div>


        <ul class="global_lang">
                    <li><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../../standard/language-independent.html">Language Independent 缺陷文档</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../../standard/c.html">c/c++ 缺陷文档</a>
                        (316)
                    </li>
                    <li>
                        <a href="../../../standard/csharp.html">csharp 缺陷文档</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../../standard/golang.html">golang 缺陷文档</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../../standard/java.html">java 缺陷文档</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../../standard/javascript.html">javascript 缺陷文档</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../../standard/objective-c.html">objective-c 缺陷文档</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../../standard/php.html">php 缺陷文档</a>
                        (58)
                    </li>
                    <li>
                        <a href="../../../standard/python.html">python 缺陷文档</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../../standard/swift.html">swift 缺陷文档</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            安全策略管理 (69)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0145">蚂蚁军规9：编程式事务中catch全部异常的接口没有设置回滚标示</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>蚂蚁军规9：编程式事务中catch全部异常的接口没有设置回滚标示</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0146">声明式事务中没有设置回滚异常类型</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>声明式事务中没有设置回滚异常类型</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0147">危险类型的金额变量</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>危险类型的金额变量</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0148">金额变量进行一次危险的类型转换</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>金额变量进行一次危险的类型转换</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0149">大数除法明确精度参数</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>大数除法明确精度参数</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0139">弱哈希函数</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>弱哈希函数</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0140">不安全的cookie</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>不安全的cookie</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0141">使用异常抛出结果码</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用异常抛出结果码</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0142">服务端方法返回boolean类型结果码</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>服务端方法返回boolean类型结果码</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0143">服务端方法返回的对象中不包含结果码</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>服务端方法返回的对象中不包含结果码</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0144">事务中包含远程调用</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>事务中包含远程调用</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0138">弱加密函数</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>弱加密函数</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>建议改进</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0109">使用弱随机算法生成固定密钥</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用弱随机算法生成固定密钥</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>严重</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">c</a>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0127">敏感数据存入数据库</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>敏感数据存入数据库</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>一般</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0128">敏感数据存入缓存</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>敏感数据存入缓存</p>
<h1 id="_2">漏洞利用威胁</h1>
<p>一般</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7539">未加密的套接字</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>未加密的套接字</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
使用的通信信道未加密。拦截网络流量的攻击者可以读取流量。
</p>
<p>
<b>易受攻击的代码：</b><br/>
普通套接字（Cleartext通信）：
<pre>Socket soc = new Socket("www.google.com",80);</pre>
</p>
<p>
<b>解决方案：</b><br/>
SSL套接字（安全通信）：
<pre>Socket soc = SSLSocketFactory.getDefault().createSocket("www.google.com", 443);</pre>
</p>
<p>除了使用SSL套接字之外，您还需要确保使用SSLSocketFactory执行所有相应的证书验证检查，以确保您不会受到中间人攻击。请阅读OWASP传输层保护cheat sheet，了解有关如何正确执行此操作的详细信息。
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_4">引用</h1>
<p><a href="https://www.owasp.org/index.php/Top_10_2010-A9">OWASP: Top 10 2010-A9-Insufficient Transport Layer Protection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure">OWASP: Top 10 2013-A6-Sensitive Data Exposure</a><br/>
<a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">OWASP: Transport Layer Protection Cheat Sheet</a><br/>
<a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7537">Hazelcast对称加密</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>Hazelcast对称加密</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>Hazelcast的网络通信配置使用对称加密算法（可能是DES或blowfish）。</p>
<p>仅这些加密算法不提供完整性或安全身份验证。 使用非对称加密更佳。</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://docs.hazelcast.org/docs/3.5/manual/html/encryption.html">Hazelcast Documentation: Encryption</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7538">NullCipher不安全</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>NullCipher不安全</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
NullCipher很少在正式的应用程序中使用。它通过返回与提供的明文相同的密文来实现Cipher接口。在一些情况下，例如测试，可以使用NullCipher。
</p>
<p>
<b>易受攻击的代码：</b><br/>
<pre>Cipher doNothingCihper = new NullCipher();
[...]
//产生的密文与明文相同。
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>解决方案：</b><br/>
    避免使用NullCipher。 其意外使用可能会带来严重的安全风险。
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_4">引用</h1>
<p><a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7065">没有设置数据库密码</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>没有设置数据库密码</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>此代码使用空密码创建数据库连接。这表示数据库不受密码保护。如果设计私密数据，请设置密码以保证安全。
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7578">启用地理位置的WebView（Android）</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>启用地理位置的WebView（Android）</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
   建议用户确认是否允许获得其地理定位。
</p>
<p>
<b>有风险的代码：</b><br/>
<pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);
    }
});
</pre>
</p>
<p>
<b>建议的代码：</b><br/>
    限制地理定位的采样，并要求用户确认。
<pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);
        //Ask the user for confirmation
    }
});
</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD15-J.+Consider+privacy+concerns+when+using+Geolocation+API">CERT: DRD15-J. Consider privacy concerns when using Geolocation API</a><br/>
<a href="http://en.wikipedia.org/wiki/W3C_Geolocation_API">Wikipedia: W3C Geolocation API</a><br/>
<a href="http://dev.w3.org/geo/api/spec-source.html">W3C: Geolocation Specification</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7584">信任边界违规</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>信任边界违规</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
    "一个信任边界可以被看作是通过一个程序绘制的分界线。在线的一边，数据是不可信的。
在这条线的另一边，数据则是可信的。
验证逻辑的目的是允许数据安全地跨越信任边界——从不可信到可信。
当一个程序模糊了受信任的和不可信的之间的界限时，就会发生信任边界违规。
通过将可信的和不受信任的数据组合在相同的数据结构中，程序员就更容易错误地信任未经验证的数据。" <sup>[1]</sup>
</p>
<p>
<b>有风险的代码</b><br/>
<pre>
public void doSomething(HttpServletRequest req, String activateProperty) {
    //..
    req.getSession().setAttribute(activateProperty,"true");
}
</pre>
<pre>
public void loginEvent(HttpServletRequest req, String userSubmitted) {
    //..
    req.getSession().setAttribute("user",userSubmitted);
}
</pre>
</p>
<p>
<b>解决方案：</b><br/>
<p>
解决方案是在设定新的会话属性之前添加验证。在可能的情况下，更喜欢来自安全位置的数据，而不是直接使用用户输入的数据。
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>低</p>
<h1 id="_4">引用</h1>
<p>[1] <a href="https://cwe.mitre.org/data/definitions/501.html">CWE-501: Trust Boundary Violation</a><br/>
<a href="https://www.owasp.org/index.php/Trust_Boundary_Violation">OWASP : Trust Boundary Violation</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7550">Blowfish使用短密钥</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>Blowfish使用短密钥</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
Blowfish密码支持32位到448位的密钥。 短密钥使密文易受暴力攻击。
如果需要使用Blowfish，则在生成密钥时应使用至少128位熵。
</p>
<p>
如果可以更改算法，则应使用AES块密码。
</p>
<p><b>易受攻击的代码：</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(64);</pre>
</p>
<p><b>解决方案：</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(128);</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_4">引用</h1>
<p><a href="http://en.wikipedia.org/wiki/Blowfish_(cipher)">Blowfish (cipher)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1107">脆弱的哈希加密算法</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>该软件对密码进行了哈希加密，但该哈希加密算法使用到的计算性力度达不到使破解攻击无法进行或需要耗资才能达到的程度。</p>
<h1 id="_2">漏洞与风险</h1>
<p>很多哈希算法都以执行迅速、开销小为目标，其中甚至包含加密用的哈希算法。但这样设计出来的高效哈希算法会给存储密码带来问题，因为它们在高效的同时也给攻击者的蛮力破解算法加了把劲。如果攻击者能过通过某些途径（如对存储哈希加密后的密码的数据库进行SQL注入）获取到这些哈希值，他们就能够将这些哈希值离线保存，然后再用各种方法来高效地计算这些哈希值，最终将密码破解。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>使用可调整计算性力度的哈希函数。</li>
<li>在使用工业界认可的技术时，请正确地使用它们。</li>
</ul>
<h1 id="_5">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/916.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1115">使用的不安全Jackson反序列化配置</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a><ul>
<li><a href="#_5">官方修复方式</a></li>
<li><a href="#_6">修复建议</a></li>
</ul>
</li>
<li><a href="#_7">演示示例</a><ul>
<li><a href="#_8">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_9">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>该漏洞存在于Jackson框架下的enableDefaultTyping方法，通过该漏洞，攻击者可以远程在服务器主机上越权执行任意代码，从而取得该网站服务器的控制权。</p>
<h1 id="_2">漏洞与风险</h1>
<p>Jackson是一个开源的Java序列化与反序列化工具，可以将java对象序列化为xml或json格式的字符串，或者反序列化回对应的对象，由于其使用简单，速度较快，且不依靠除JDK外的其他库，被众多用户所使用。但是其组件Jackson-databind可以指定特定的反序列化类，这样就存在代码执行的风险。</p>
<p>通过java生态中的第三方库存在的序列化方法构造序列化恶意攻击代码，并将恶意代码base64编码后拼接到一个精心构造的json数据包中，代码层如果在使用ObjectMapper对象实例时（ObjectMapper mapper = new ObjectMapper();）开启了enableDefaultType特性（例如mapper.enableDefaultTyping();），会在readValue时对传入的JSON自动调用第三方库的反序列化方法，被攻击者利用即可越权执行代码。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_4">缓解与预防</h1>
<h3 id="_5">官方修复方式</h3>
<p>官方在漏洞产生后，通过黑名单的方式禁止黑名单中的第三方库因为反序列化问题而产生的代码执行漏洞。 </p>
<h3 id="_6">修复建议</h3>
<p>1.升级到最新版本jackson-databind 2.7.9.2，2.8.11，2.9.3.1及后续版本;</p>
<p>2.禁用enableDefaultTyping()方法；</p>
<p>3.对客户端传入的JSON数据，进行过滤或者类型检查。</p>
<h1 id="_7">演示示例</h1>
<h3 id="_8">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ABean</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">AnotherBean</span> <span class="o">{</span>
        <span class="nd">@JsonTypeInfo</span><span class="o">(</span><span class="n">use</span> <span class="o">=</span> <span class="n">JsonTypeInfo</span><span class="o">.</span><span class="na">Id</span><span class="o">.</span><span class="na">CLASS</span><span class="o">)</span> <span class="c1">// or JsonTypeInfo.Id.MINIMAL_CLASS</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">example</span><span class="o">(</span><span class="n">String</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">JsonMappingException</span> <span class="o">{</span>
         <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">enableDefaultTyping</span><span class="o">();</span> <span class="c1">//using enableDefaultTyping() method</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">json</span><span class="o">,</span> <span class="n">ABean</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">exampleTwo</span><span class="o">(</span><span class="n">String</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">JsonMappingException</span> <span class="o">{</span>
         <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">json</span><span class="o">,</span> <span class="n">AnotherBean</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_9">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-github1">
<p>https://github.com/FasterXML/jackson-databind/issues/1599 <a class="footnote-backref" href="#fnref-github1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-github2">
<p>https://github.com/mbechler/marshalsec <a class="footnote-backref" href="#fnref-github2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1073">代码的正确性</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
<li><a href="#2">漏洞代码示例2</a></li>
<li><a href="#2_1">漏洞代码修复示例2</a></li>
</ul>
</li>
<li><a href="#_8">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>在JVM中，两个类是一个相同的类（也就是相同的类型）当且仅当他们是被相同的类加载器加载且拥有相同的完全拓展名<a href="https://wiki.sei.cmu.edu/confluence/display/java/Rule+AA.+References#RuleAA.References-JVMSpec99">JVMSpec 1999</a>。类名相同但包名不同的两个类归为不同的类，类型的，有用相同的完全拓展名但以不同的类加载器加载的两个类归为不同的类。</p>
<h1 id="_2">漏洞与风险</h1>
<p>有时候，检查一个对象是否属于某个特定的类，或两个对象是否属于相同的类是有必要的，例如，当实现<code>equals()</code>方法时。如果这样的比较没有处理正确，那么将有可能出现实际上不相同的两个类被判为相同的类的情况。因此，你不应该使用类名来判断两个类是否属于同一个类。</p>
<p>依据不安全代码的行为，这样的缺陷可能会引发混合匹配（mix-and-match）攻击。</p>
<p>相反地，源自于同一个codebase的类必然是相同的——这种假设充满疑点，是不可靠的。尽管在众多的桌面应用中，上述假设都被视作成立，但若涉及到J2EE的servlet容器，那么情况就不是这样了。servlet容器可以再运行时不重启JVM来实现通过不同的类加载器来部署和重复调用应用。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>通过类之间的等价关系来决定类型（通过使用<code>getClass()</code>方法以及<code>==</code>操作符），而不是通过类名。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>这段缺陷代码通过比较类名来判断<code>auth</code>对象是否属于<code>com.application.auth.DefaulAuthenticationHandler</code>类，并以结果来选择分支：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class object</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span>
      <span class="s">"com.application.auth.DefaultAuthenticationHandler"</span><span class="o">))</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>因为不同的类加载器能加载本该相同的类（如果同一个类两次加载都是使用相同的类加载器的话）到一个JVM中，只与完全拓展类名进行比较还是不足够的。</p>
<h3 id="_7">漏洞代码修复示例</h3>
<p>这段合规代码通过将<code>auth</code>对象的类对象（<code>class object</code>）与标准的验证<code>handler</code>的类对象进行比较：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class name</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">com</span><span class="o">.</span><span class="na">application</span><span class="o">.</span><span class="na">auth</span><span class="o">.</span><span class="na">DefaultAuthenticationHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p><code>==</code>操作符的右部直接展示了标准的验证<code>handler</code>的类名，在这种标准的验证<code>handler</code>类还没有被类加载器加载的情况下，Java Runtime会对该类的加载进行管理，最终，这两个类对象的比较正确地进行。</p>
<h3 id="2">漏洞代码示例2</h3>
<p>这段不合规的代码通过使用<code>equals()</code>方法来比较对象<code>x</code>和<code>y</code>的类对象名。存在这样的情况，虽然<code>x</code>和<code>y</code>拥有相同的名字，但他们是被不同的类加载器加载的，那么他们是两个不同的类。</p>
<h3 id="2_1">漏洞代码修复示例2</h3>
<p>这段合规的代码正确地比较了两个对象的类：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether objects x and y have the same class</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="o">{</span>
  <span class="c1">// Objects have the same class</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_8">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/OBJ09-J.+Compare+classes+and+not+class+names <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/486.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7503">MD2，MD4和MD5是弱散列函数</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>MD2，MD4和MD5是弱散列函数</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>MD2、MD4和MD5算法不是推荐的MessageDigest。例如，应该使用<b>PBKDF2</b>来对密码进行散列。</p>
<blockquote>
    "MD5哈希函数的安全性受到了严重的损害。在一台拥有2.6 GHz奔腾4处理器的电脑（复杂度为2<sup>24.1</sup>）中，碰撞攻击可以在几秒钟内找到碰撞。[1] 此外，还有一个chosen-prefix碰撞攻击，可以使用现成的计算硬件（复杂度为2<sup>39</sup>）在几个小时内产生两个具有特定前缀的输入冲突。[2]"<br/>
    - 
<a href="https://en.wikipedia.org/wiki/MD5#Security">Wikipedia: MD5 - Security</a>
</blockquote>
<blockquote>
    "<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, 和SHA-512/256</b>:<br/>
    所有哈希函数应用程序都可以使用这些哈希函数。"<br/>
    - 
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<blockquote>
    "PBKDF的主要思想是通过增加时间来减慢字典或暴力攻击密码的速度。一个带有可能密码列表的攻击者可以使用已知的迭代计数器和salt来评估PBKDF。由于攻击者每次尝试都要花费大量的计算时间，所以应用字典或蛮力攻击变得更加困难。"<br/>
- 
<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation  p.12</a>
</blockquote>
<br/>
<p>
<b>易受攻击的代码：</b><br/>
<pre>MessageDigest md5Digest = MessageDigest.getInstance("MD5");
    md5Digest.update(password.getBytes());
    byte[] hashValue = md5Digest.digest();</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;pre&gt;</span>byte[] hashValue = DigestUtils.getMd5Digest().digest(password.getBytes());<span class="nt">&lt;/pre&gt;</span>
</pre></div>
</td></tr></table>
</p>
<p>
<b>解决方案(使用bouncy castle):</b>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    PKCS5S2ParametersGenerator gen = new PKCS5S2ParametersGenerator(new SHA256Digest());
    gen.init(password.getBytes("UTF-8"), salt.getBytes(), 4096);
    return ((KeyParameter) gen.generateDerivedParameters(256)).getKey();
}</pre>
<b>解决方案(java 8 或以上版本):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    KeySpec spec = new PBEKeySpec(password.toCharArray(), salt, 4096, 256 * 8);
    SecretKeyFactory f = SecretKeyFactory.getInstance(""PBKDF2WithHmacSHA256"");
    return f.generateSecret(spec).getEncoded();
}</pre>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<p><br/>
<p>
<b>引用</b><br/>
[1]<a href="http://www.win.tue.nl/hashclash/On%20Collisions%20for%20MD5%20-%20M.M.J.%20Stevens.pdf">On Collisions for MD5</a>: Master Thesis by M.M.J. Stevens<br/>
[2] 
<a href="http://homepages.cwi.nl/~stevens/papers/stJOC%20-%20Chosen-Prefix%20Collisions%20for%20MD5%20and%20Applications.pdf">Chosen-prefix collisions for MD5 and applications</a>: Paper written by Marc Stevens<br/>
[3]<a href="https://en.wikipedia.org/wiki/MD5">Wikipedia: MD5</a><br/>
[4]<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</a><br/>
[5]<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation</a><br/>
[6]<a href="http://stackoverflow.com/questions/22580853/reliable-implementation-of-pbkdf2-hmac-sha256-for-java">Stackoverflow: Reliable implementation of PBKDF2-HMAC-SHA256 for Java</a><br/>
[7]<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7498">接受任何签名证书的HostnameVerifier</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>接受任何签名证书的HostnameVerifier</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>接受任何主机的<code>HostnameVerifier</code>经常被使用，因为在许多主机上都有证书重用。因此，这很容易受到
<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attacks</a>
的攻击，因为客户端会信任任何证书。</p>
<p>
应该建立一个允许特定证书（例如基于truststore）的TrustManager。
应该创建通配符证书，以便在多重子域上重用。
关于适当执行的详细信息可参考：
<a href="http://stackoverflow.com/a/6378872/89769">[1]</a>
<a href="http://stackoverflow.com/a/5493452/89769">[2]</a>
</p>
<br/>
<p>
<b>易受攻击的代码：</b><br/>
<pre>public class AllHosts implements HostnameVerifier {
    public boolean verify(final String hostname, final SSLSession session) {
        return true;
    }
}</pre>
</p>
<br/>
<p>
<b>解决方法 (基于密钥存储库的TrustMangager)：</b><br/>
<pre>KeyStore ks = //Load keystore containing the certificates trusted
SSLContext sc = SSLContext.getInstance("TLS");
TrustManagerFactory tmf = TrustManagerFactory.getInstance("SunX509");
tmf.init(ks);
sc.init(kmf.getKeyManagers(), tmf.getTrustManagers(),null);
</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7563">ECB模式不安全</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>ECB模式不安全</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
Electronic Codebook（ECB）不能为加密数据提供良好机密性，应该使用一种提供更好机密性的认证加密模式。
具体来说，ECB模式每次都为相同的输入产生相同的输出。
因此，例如，如果用户发送密码，每次加密的值都是相同的。
这允许攻击者拦截和重放数据。</p>
<p>
要解决这个问题，应该使用Galois/Counter模式（GCM）。
</p>
<p>
<b>有风险的代码：</b>
<pre>Cipher c = Cipher.getInstance("AES/ECB/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>解决方案：</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Electronic_codebook_.28ECB.29">Wikipedia: Block cipher modes of operation</a><br/>
<a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST: Recommendation for Block Cipher Modes of Operation</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7543">没有填充的RSA是不安全的</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>没有填充的RSA是不安全的</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
该软件使用RSA算法，但未包含最佳非对称加密填充（OAEP），这可能会削弱加密。
</p>
<p>
<b>缺陷代码：</b><br/>
<pre>Cipher.getInstance("RSA/NONE/NoPadding")</pre>
</p>
<p>
<b>解决方案：</b><br/>
代码应替换为：<br/>
<pre>Cipher.getInstance("RSA/ECB/OAEPWithMD5AndMGF1Padding")</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://cwe.mitre.org/data/definitions/780.html">CWE-780: Use of RSA Algorithm without OAEP</a><br/>
<a href="http://rdist.root.org/2009/10/06/why-rsa-encryption-padding-is-critical/">Root Labs: Why RSA encryption padding is critical</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1070">不安全的SSL</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#_8">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>当软件通过被盗用的CA签发的证书来与站点建立连接，攻击者可以通过中间人攻击盗取敏感数据。
为了确保数据完整性，证书必须有效并且必须与正在访问的站点有关。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者将能够拦截信任这些被盗CA的SSL/TLS</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>仅使用受信任的证书</li>
<li>使用有效并且与站点相关的证书</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">connect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">URLConnection</span> <span class="n">urlConnection</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
                <span class="k">return</span> <span class="n">urlConnection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="o">...</span>
            <span class="o">}</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>使用默认的CA建立SSL连接</p>
<h3 id="_7">漏洞代码修复示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">safeConnect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">TrustManager</span><span class="o">[]</span> <span class="n">tm</span> <span class="o">=</span> <span class="o">{</span> <span class="k">new</span> <span class="n">X509TrustManager</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkClientTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkServerTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="n">X509Certificate</span><span class="o">[]</span> <span class="nf">getAcceptedIssuers</span><span class="o">()</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>
            <span class="o">}};</span>
            <span class="n">SSLContext</span> <span class="n">context</span> <span class="o">=</span> <span class="n">SSLContext</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SSL"</span><span class="o">);</span>
            <span class="n">context</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">tm</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>

            <span class="n">HttpsURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpsURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">setSSLSocketFactory</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getSocketFactory</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">...</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>使用自定义的信任的证书建立了SSL/TLS连接</p>
<h1 id="_8">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE310">
<p>https://cwe.mitre.org/data/definitions/310.html <a class="footnote-backref" href="#fnref-CWE310" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A3">
<p>https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure <a class="footnote-backref" href="#fnref-OWASP-A3" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7477">过分宽松的CORS政策</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>过分宽松的CORS政策</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
在HTML5之前，Web浏览器强制执行Same Origin Policy，以确保JavaScript能够访问Web页面的内容，JavaScript和Web页面都必须来自同一个域。
如果没有Same Origin Policy，恶意网站就可以使用客户凭证使JavaScript从其它网站加载敏感信息，并通过它进行筛选，并将其反馈给攻击者。
如果一个名为Access-Control-Allow-Origin的新HTTP头被定义，那么HTML5就有可能使JavaScript访问跨域的数据。
有了这个头，一个Web服务器就定义了哪些其它域可以使用跨源请求访问它的域。
然而，在定义头时应该谨慎，因为过于宽松的CORS策略将允许恶意应用程序以不恰当的方式与受害者应用程序通信，从而导致欺骗、数据窃取、中继和其它攻击。
</p>
<p>
<b>易受攻击的代码：</b>
<pre>response.addHeader("Access-Control-Allow-Origin", "*");</pre>
</p>
<p>
<b>解决方案：</b>
<br/>
避免使用Access-Control-Allow-Origin header的值，这表明任何域上运行的JavaScript可以对应用程序的数据进行访问。
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="references">References</h1>
<p><a href="https://www.w3.org/TR/cors/">W3C Cross-Origin Resource Sharing</a><br/>
<a href="http://enable-cors.org/">Enable Cross-Origin Resource Sharing</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1109">不安全的存储</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>该软件没有在存储或传输前对敏感或关键数据进行加密。</p>
<h1 id="_2">漏洞与风险</h1>
<p>没有对HTTPS session中敏感的cookie值的<code>Secure</code>属性进行设置，使得用户代理可能会在一个HTTPS session中以明文形式传递coockie。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>明确设计指明哪些重要的数据或资源需要进行加密保护。</li>
<li>确保系统设计中妥善处理好加密这一环。</li>
<li>区分不同场景下对加密的需求。</li>
<li>在使用工业界认可的方法时，请正确使用它们。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>以下的缺陷代码片段来自一个servlet doPost()方法，它会设置cookie中accountID这一敏感者，但中途缺少了对<code>setSecure(true)</code>的调用：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Cookie</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="n">ACCOUNT_ID</span><span class="o">,</span> <span class="n">acctID</span><span class="o">);</span>
<span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="_7">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe1">
<p>https://cwe.mitre.org/data/definitions/614.html <a class="footnote-backref" href="#fnref-cwe1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe2">
<p>https://cwe.mitre.org/data/definitions/311.html <a class="footnote-backref" href="#fnref-cwe2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7490">没有HttpOnly标志的Cookie</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>没有HttpOnly标志的Cookie</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
一个新的cookie是在没有<code>HttpOnly</code>标记集的情况下创建的。
<code>HttpOnly</code>标志是对浏览器的一个指令，以确保cookie不能被恶意脚本所使用。
当用户是“跨站点脚本”的目标时，攻击者将从获得会话id方面获得很大的好处。 </p>
</p>
<p>
<p><b>有风险的代码：</b><br/></p>
<p><pre>
 Cookie cookie = new Cookie("email",userName);
 response.addCookie(cookie);
 </pre></p>
</p>
<p>
<p><b>解决方案(特定的配置)：</b><br/></p>
<p><pre>
 Cookie cookie = new Cookie("email",userName);
 cookie.setSecure(true);
 cookie.setHttpOnly(true); //HttpOnly flag
 </pre></p>
</p>
<p>
<p><b>解决方案(Servlet 3.0 配置):</b><br/></p>
<p><pre>
 &lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"&gt;
 [...]
 &lt;session-config&gt;
  &lt;cookie-config&gt;
  &lt;http-only&gt;true&lt;/http-only&gt;
  &lt;secure&gt;true&lt;/secure&gt;
  &lt;/cookie-config&gt;
 &lt;/session-config&gt;
 &lt;/web-app&gt;
 </pre></p>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="http://blog.codinghorror.com/protecting-your-cookies-httponly/">Coding Horror blog: Protecting Your Cookies: HttpOnly</a><br/>
<a href="https://www.owasp.org/index.php/HttpOnly">OWASP: HttpOnly</a><br/>
<a href="https://www.rapid7.com/db/vulnerabilities/http-cookie-http-only-flag">Rapid7: Missing HttpOnly Flag From Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7577">MODE_WORLD_READABLE模式文件（Android）</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>MODE_WORLD_READABLE模式文件（Android）</p>
<h1 id="_2">漏洞与风险</h1>
<p>
<p>在此上下文中所写的文件使用了<code>MODE_WORLD_READABLE</code>的创建模式。
公开所写内容可能程序员的本意。</p>
</p>
<p>
<p><b>有风险的代码：</b><br/></p>
<p><pre>
 fos = openFileOutput(filename, MODE_WORLD_READABLE);
 fos.write(userInfo.getBytes());
 </pre></p>
</p>
<p><br/></p>
<p>
<p><b>解决方案(使用MODE_PRIVATE):</b><br/></p>
<p><pre>
 fos = openFileOutput(filename, MODE_PRIVATE);
 </pre></p>
</p>
<p>
<p><b>解决方案(使用本地SQLite数据库):</b><br/></p>
<p>使用本地SQLite数据库可能是存储结构化数据的最佳解决方案。
确保数据库文件不是在外部存储器上创建的。
请参阅下面的参考资料了解如何实现。</p>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD11-J.+Ensure+that+sensitive+data+is+kept+secure">CERT: DRD11-J. Ensure that sensitive data is kept secure</a><br/>
<a href="http://developer.android.com/training/articles/security-tips.html#InternalStorage">Android Official Doc: Security Tips</a><br/>
<a href="http://developer.android.com/reference/android/content/Context.html#MODE_PRIVATE">Android Official Doc: Context.MODE_PRIVATE</a><br/>
<a href="http://www.vogella.com/tutorials/AndroidSQLite/article.html#databasetutorial_database">vogella.com: Android SQLite database and content provider - Tutorial</a><br/>
<a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
<a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7497">接受任何证书的TrustManager</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>接受任何证书的TrustManager</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>空的TrustManager实现通常被用来轻松地连接到一个没有root的主机<a href="http://en.wikipedia.org/wiki/Certificate_authority">certificate authority</a>. 因此，这很容易受到<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attacks</a>的影响，因为客户端会信任任何证书。
</p>
<p>
应该建立一个允许特定证书（例如基于truststore）的TrustManager。关于适当执行的详细信息可参考：
<a href="http://stackoverflow.com/a/6378872/89769">[1]</a>
<a href="http://stackoverflow.com/a/5493452/89769">[2]</a>
</p>
<br/>
<p>
<b>易受攻击的代码：</b><br/>
<pre>class TrustAllManager implements X509TrustManager {
    @Override
    public void checkClientTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {
        //Trust any client connecting (no certificate validation)
    }
    @Override
    public void checkServerTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {
        //Trust any remote server (no certificate validation)
    }
    @Override
    public X509Certificate[] getAcceptedIssuers() {
        return null;
    }
}</pre>
</p>
<br/>
<p>
<b>解决方案(基于密钥库的TrustMangager)：</b><br/>
<pre>KeyStore ks = //Load keystore containing the certificates trusted
SSLContext sc = SSLContext.getInstance("TLS");
TrustManagerFactory tmf = TrustManagerFactory.getInstance("SunX509");
tmf.init(ks);
sc.init(kmf.getKeyManagers(), tmf.getTrustManagers(),null);
</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7044">类加载器只应在doPrivileged块内创建</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>类加载器只应在doPrivileged块内创建</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>这段代码创建一个类加载器。如果系统安装了安全管理，则这段代码运行需要权限。如果此代码由没有安全权限的代码调用，则类加载器的创建需要在doPrivileged块中进行。</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7479">可预测的伪随机数发生器（Scala）</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>可预测的伪随机数发生器（Scala）</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>在某些安全非常重要的环境中使用可预测的随机值会导致漏洞。
例如，当值被用作：</p>
<ul>
<li>CSRF令牌：可预测的令牌可以导致CSRF攻击，攻击者将知道令牌的值。</li>
<li>密码重置令牌（通过电子邮件发送）：可预测的密码令牌可以导致帐户接管，因为攻击者会猜测更改密码表单的URL
  </li>
<li>任何其它密钥值
</li>
</ul>
<p>一个快速的解决方案可能是用更强的随机值替换使用<b>java.util.Random</b>，比如<b>java.security.SecureRandom</b>.
</p>
<p>
<b>易受攻击的代码：</b><br/>
<pre>import scala.util.Random
def generateSecretToken() {
    val result = Seq.fill(16)(Random.nextInt)
    return result.map("%02x" format <em>).mkString
}</em></pre>
</p>
<p>
<b>解决方法：</b>
<pre>import java.security.SecureRandom
def generateSecretToken() {
    val rand = new SecureRandom()
    val value = Array.ofDim<a href="16">Byte</a>
    rand.nextBytes(value)
    return value.map("%02x" format </pre></p></p>).mkString
}

<p>
<b>
解决方法：</b>
<pre>import java.security.SecureRandom
import scala.util.Random.<em>
def generateSecretToken() {
    val secRandom = javaRandomToRandom(new SecureRandom())
    val result = Seq.fill(16)(secRandom.nextInt)
    return result.map("%02x" format </em>).mkString
}</pre>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://jazzy.id.au/default/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (http://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="http://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="http://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1074">访问控制</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#_8">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>调用安全敏感型方法的应用代码必须对传入该类方法的参数进行验证。</p>
<h1 id="_2">漏洞与风险</h1>
<p>特别地，某些安全敏感型方法会将null值解释为无害的值，但它们可能会重写默认的设置。尽管安全敏感型方法应该保守性编码，但用户端代码仍要对方法的参数进行验证，否则，未经验证的参数可能会被视作有效值被接收。没做到这点，那么将有可能出现权限放大及任意代码执行问题。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>透彻地理解安全敏感型方法并对它们的参数进行验证，以避免因意外参数值导致的边界情况。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>这段存在缺陷的代码展示了接收两个参数且以第二个参数作为访问控制上下文的<code>doPrivileged()</code>方法，它从先前保存的上下文中恢复访问权限：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>当传入的访问控制上下文为null时，<code>doPrivileged()</code>方法无法将当前的访问控制权限降至先前保存的上下文的访问控制权限。因此，当<code>accessCibtrikCibtext</code>参数为<code>null</code>时，这段代码将给当前访问控制上下文赋予过高的权限。</p>
<h3 id="_7">漏洞代码修复示例</h3>
<p>这个合规的解决方案通过确保<code>accessControlContext</code>不为<code>null</code>来避免赋予过高的权限：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">(</span><span class="n">accessControlContext</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">SecurityException</span><span class="o">(</span><span class="s">"Missing AccessControlContext"</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="_8">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC55-J.+Ensure+that+security-sensitive+methods+are+called+with+validated+arguments <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7566">使用ESAPI加密器</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>使用ESAPI加密器</p>
<h1 id="_2">漏洞与风险</h1>
<p>
<p>ESAPI在密码学组件中有一个漏洞历史。
下面是一个快速验证列表，以确保经过验证的加密工作按预期工作。</p>
</p>
<p><p><b>1.库版本</b></p></p>
<p>
<p>这个问题在ESAPI2.1.0版本中得到了纠正。version&lt;=2.0.1很容易受到MAC旁路（c2013-5679）的影响。<br/></p>
</p>
<p>
<p>对于Maven用户，插件<a href="http://mojo.codehaus.org/versions-maven-plugin/">versions</a> 可以使用下面的命令来调用。ESAPI的有效版本将在输出中可用。<br/></p>
<p><pre>$ mvn versions:display-dependency-updates</pre>
<br/>Output:<br/>
<pre>
 [...]
 [INFO] The following dependencies in Dependencies have newer versions:
 [INFO] org.slf4j:slf4j-api ................................... 1.6.4 -&gt; 1.7.7
 [INFO] org.owasp.esapi:esapi ................................. 2.0.1 -&gt; 2.1.0
 [...]
  </pre></p>
</p>
<p>
<p>或者直接看一下配置。<br/></p>
<p><pre>
 &lt;dependency&gt;
  &lt;groupId&gt;org.owasp.esapi&lt;/groupId&gt;
  &lt;artifactId&gt;esapi&lt;/artifactId&gt;
  &lt;version&gt;2.1.0&lt;/version&gt;
 &lt;/dependency&gt;</pre></p>
</p>
<p>
<p>对于ant用户，使用的jar包应该是 <a href="http://repo1.maven.org/maven2/org/owasp/esapi/esapi/2.1.0/esapi-2.1.0.jar">esapi-2.1.0.jar</a>.</p>
</p>
<p><p><b>2.配置：</b></p></p>
<p>
<p>版本2.1.0仍然很容易受到密文定义（c2013-5960）的密钥大小的影响。需要采取一些预防措施。<br/></p>
<p><br/></p>
<p><div><b>如果有任何这些元素存在，那么ESAPI的加密配置也会很容易受到攻击：</b><br/></div></p>
<p><b>不安全配置:</b><br/></p>
<p><pre>
 Encryptor.CipherText.useMAC=false
 Encryptor.EncryptionAlgorithm=AES
 Encryptor.CipherTransformation=AES/CBC/PKCS5Padding
 Encryptor.cipher_modes.additional_allowed=CBC</pre></p>
</p>

<p>
<div>
<p><b>安全配置：</b><br/></p>
<p><pre>
 #Needed
 Encryptor.CipherText.useMAC=true
 #Needed to have a solid auth. encryption
 Encryptor.EncryptionAlgorithm=AES
 Encryptor.CipherTransformation=AES/GCM/NoPadding
 #CBC mode should be removed to avoid padding oracle
 Encryptor.cipher_modes.additional_allowed=</pre></p>
</div>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://owasp-esapi-java.googlecode.com/svn/trunk/documentation/ESAPI-security-bulletin1.pdf">ESAPI Security bulletin 1 (CVE-2013-5679)</a><br/>
<a href="http://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-5679">Vulnerability Summary for CVE-2013-5679</a><br/>
<a href="http://www.synacktiv.com/ressources/synacktiv_owasp_esapi_hmac_bypass.pdf">Synactiv: Bypassing HMAC validation in OWASP ESAPI symmetric encryption</a><br/>
<a href="http://cwe.mitre.org/data/definitions/310.html">CWE-310: Cryptographic Issues</a><br/>
<a href="http://lists.owasp.org/pipermail/esapi-dev/2015-March/002533.html">ESAPI-dev mailing list: Status of CVE-2013-5960</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7575">外部文件访问（Android）</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>外部文件访问（Android）</p>
<h1 id="_2">漏洞与风险</h1>
<p>
<p>应用程序将数据写入外部存储器（如SD卡）。
这具有多重安全问题。
首先，SD卡上的文件存储将被应用程序访问，它有</p>
<p><a href="http://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE"><code>READ_EXTERNAL_STORAGE</code></a> 的允许。</p>
<p>另外，如果数据中存在关于用户的机密信息，则需要进行加密。</p>
</p>
<p>
<p><b>有风险的代码：</b><br/></p>
<p><pre>
 file file = new File(getExternalFilesDir(TARGET_TYPE), filename);
 fos = new FileOutputStream(file);
 fos.write(confidentialData.getBytes());
 fos.flush();
 </pre></p>
</p>
<p>
<p><b>修复示例:</b><br/></p>
<p><pre>
 fos = openFileOutput(filename, Context.MODE_PRIVATE);
 fos.write(string.getBytes());
 </pre></p>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="http://developer.android.com/training/articles/security-tips.html#ExternalStorage">Android Official Doc: Security Tips</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/DRD00-J.+Do+not+store+sensitive+information+on+external+storage+%28SD+card%29+unless+encrypted+first">CERT: DRD00-J: Do not store sensitive information on external storage [...]</a><br/>
<a href="http://developer.android.com/guide/topics/data/data-storage.html#filesExternal">Android Official Doc: Using the External Storage</a><br/>
<a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
<a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a></p>

            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7474">不安全的SMTP SSL连接</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>不安全的SMTP SSL连接</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
在进行SSL连接时，服务器身份验证是禁用的。
一些启用SSL连接的电子邮件库在默认情况下不会验证服务器证书。
这相当于信任所有的证书。当试图连接到服务器时，这个应用程序将很容易地接受给“hacserver.com”的证书。
该应用程序现在可能会在断开的SSL连接上泄漏敏感的用户信息。
</p>
<p>
<b>
易受攻击的代码：</b><br/>
<pre>...
Email email = new SimpleEmail();
email.setHostName("smtp.servermail.com");
email.setSmtpPort(465);
email.setAuthenticator(new DefaultAuthenticator(username, password));
email.setSSLOnConnect(true);
email.setFrom("user@gmail.com");
email.setSubject("TestMail");
email.setMsg("This is a test mail ... :-)");
email.addTo("foo@bar.com");
email.send();
...</pre>
</p>
<p>
<b>解决方案：</b><br/>
请添加以下检查，以验证服务器的证书：
<pre>email.setSSLCheckServerIdentity(true);</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="https://cwe.mitre.org/data/definitions/297.html">CWE-297: Improper Validation of Certificate with Host Mismatch</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7029">如果扩展了类，GetResource的使用可能不安全</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>如果扩展了类，GetResource的使用可能不安全</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>如果此类被另一个包中的类所扩展，那么调用this.getClass().getResource(...)可能给出除预期外的结果。</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7478">可预测的伪随机数发生器</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>可预测的伪随机数发生器</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>在某些安全很重要的环境中使用可预测的随机值会导致漏洞。
例如，当值被用作：
</p>
<ul>
<li>CSRF令牌：可预测的令牌可以导致CSRF攻击，攻击者将知道令牌的值。</li>
<li>密码重置令牌（通过电子邮件发送）：可预测的密码令牌可以导致帐户接管，因为攻击者会猜测更改密码表单的URL
 </li>
<li>任何其它密钥值</li>
</ul>
<p>一个快速的解决方案可能是用更强的随机值替换使用<b>java.util.Random</b>，比如<b>java.security.SecureRandom</b>。</p>
<p>
<b>易受攻击的代码：</b><br/>
<pre>String generateSecretToken() {
    Random r = new Random();
    return Long.toHexString(r.nextLong());
}</pre>
</p>
<p>
<b></b></p>
<p>解决方法：</p></p>
<pre>import org.apache.commons.codec.binary.Hex;
String generateSecretToken() {
    SecureRandom secRandom = new SecureRandom();
    byte[] result = new byte[32];
    secRandom.nextBytes(result);
    return Hex.encodeHexString(result);
}</pre>

<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://jazzy.id.au/default/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (http://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="http://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="http://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7043">调用的方法应该只在doPrivileged块内被调用</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>调用的方法应该只在doPrivileged块内被调用</p>
<h1 id="_2">漏洞与风险</h1>
<p><p> 此代码调用了一个需要安全权限检查的方法。如果这段代码将被授予了安全权限，但被没有授予安全权限的代码调用，则调用需要在doPrivileged块中进行。</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1083">不安全的随机性</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#_8">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>伪随机数生成器（Pseudorandom number generators，即PRNGs）使用决定性的数学算法来产生具有良好统计属性的数字序列，但这样产生的数字序列并没有真正的随机性。PRNGs通常需要一个起始的种子，实现算法将使用这个种子来产生一个数字以及一个新的种子，并再借由新产生的种子来往复循环相同的过程。</p>
<h1 id="_2">漏洞与风险</h1>
<p>Java API中<code>java.util.Random</code>包提供了一种PRNG实现。这个PRGN具有便携性和可重复性，因此，在所有Java版本的实现中，使用同一个种子创建的两个<code>java.util.Random</code>类的实例会生成相同的随机数序列。随机数种子的值通常会在应用初始化时被重用，除非重启了机器。排除掉重启机器的情况时，随机数种子值由来自系统时钟的现时时间决定。攻击者会通过监测缺陷目标中的随机数种子值，然后创建一张查找表来预测未来的随机数种子值。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>使用安全性更好的随机数生成器，如<code>java.security.SecureRandom</code>类。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>这段缺陷代码使用了不安全的<code>java.util.Random</code>类，因为这个类对相同的种子值能产生同样的伪随机数序列，也就是说这个序列是可预测的：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="n">Random</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="mi">123L</span><span class="o">);</span>
<span class="c1">//...</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="c1">// Generate another random integer in the range [0, 20]</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">);</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">漏洞代码修复示例</h3>
<p>这段合规代码使用<code>java.security.SecureRandom</code>类来产生可靠的随机数序列：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
  <span class="n">SecureRandom</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
  <span class="c1">// Generate 20 integers 0..20</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_8">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/MSC02-J.+Generate+strong+random+numbers <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0133">成功登录后不会更新会话ID</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">缓解与预防</a></li>
<li><a href="#_4">漏洞利用威胁</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>对用户进行身份验证或以其他方式建立新用户会话，而不会使任何现有会话标识符失效，这使攻击者有机会窃取经过身份验证的会话。</p>
<p>这种情况通常在以下情况下观察到：
1 Web应用程序在不先使现有会话无效的情况下对用户进行身份验证，从而继续使用已与用户关联的会话。
2 攻击者能够强制用户已知的会话标识符，以便一旦用户认证，攻击者就可以访问已认证的会话。
3 应用程序或容器使用可预测的会话标识符。 在会话固定漏洞的通用漏洞攻击中，攻击者在Web应用程序上创建一个新会话并记录关联的会话标识符。 攻击者然后使受害者使用该会话标识符与服务器相关联，并可能进行身份验证，从而使攻击者能够通过活动会话访问用户的帐户。</p>
<h1 id="_2">漏洞与风险</h1>
<p>攻击者能够强制用户已知的会话标识符，以便一旦用户认证，攻击者就可以访问已认证的会话。</p>
<h1 id="_3">缓解与预防</h1>
<p>在授权新用户会话之前使任何现有的会话标识符失效。</p>
<h1 id="_4">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h3 id="_7">漏洞代码修复示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">invalidate</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>使用invalidate()把现有的会话标识符失效。</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/384.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/cwe-384.html">CWE-384</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7149">公共静态方法可能由于返回数组来暴露内部表示</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>公共静态方法可能由于返回数组来暴露内部表示</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>公共静态方法返回对数组的引用，该数组是类的静态状态的一部分。</p>
<p>调用此方法的任何代码都可以自由地修改基础数组。</p>
<p>一种解决方法是返回数组的副本。</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1091">违反信任边界</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>可以把信任边界想象成划分一个程序的一条界线，在线的一边，这不是的数据是不受信的；而在线的另外一边，数据都是受信的。程序的验证逻辑都是围绕这条线开展的——通过验证不受信一边的数据，把验证通过的数据移动到受信数据的一边。当程序模糊了信任边界时，我们称程序违反了信任边界原则。当在同一个数据结构中混杂了受信与不受信的数据时，程序员会更轻易地把不受信的数据当成受信数据。</p>
<h1 id="_2">漏洞与风险</h1>
<p>当没有明确定义或久不维护信任边界时，程序员不可避免地会对哪些数据经过了认证而哪些没有经过验证的问题摸不着头脑。放任这种情况不管，最终会使得程序员直接使用没有经过验证的不受信数据。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>明确定义并尊重信任边界。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>以下的代码展现了程序不对HTTP请求中的用户名信息验证，判断用户是否经过了认证，直接就把用户名参数存在了HTTP会话对象中：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">usrname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"usrname"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">,</span> <span class="n">usrname</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_7">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/501.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7565">此加密算法不提供数据完整性保证</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>此加密算法不提供数据完整性保证</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
所产生的密文很容易被其他人修改。
这意味着该加密算法无法检测数据是否被篡改过。
如果密文可以由攻击者控制，那么它可以被修改而不被发现。</p>
<p></p>
<p>
 解决方案是使用一个包含Hash based Message Authentication Code（HMAC）的加密算法来签署数据。
将一个HMAC函数与现有加密结合起来很容易出错<sup><a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">[1]</a></sup>. 具体地说，它总是建议您首先验证HMAC，并且只有当数据未被修改时，您才可以对数据执行任何加密功能。
</p>
<p>下面的模式是易受攻击的，因为它们不提供HMAC：<br/>
    - CBC<br/>
    - OFB<br/>
    - CTR<br/>
    - ECB<br/><br/>
    下面的代码片段是一些易受攻击的代码例子。<br/><br/>
<b>有风险的代码：</b><br/>
<i>CBC模式中的AES</i><br/>
<pre>Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
<br/>
<i>ECB模式中的三倍DES</i><br/>
<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>解决方案：</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
在上面的例子解决方案中，GCM模式将一个HMAC引入到最终的加密数据中，从而提供了结果的完整性。
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">Moxie Marlinspike's blog: The Cryptographic Doom Principle</a><br/>
<a href="http://cwe.mitre.org/data/definitions/353.html">CWE-353: Missing Support for Integrity Check</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7562">加密时使用了固定的初始化向量IV</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>加密时使用了固定的初始化向量IV</p>
<h1 id="_2">漏洞与风险</h1>
<p>
<p>必须重新生成初始化向量，以便对每条消息进行加密。</p>
</p>
<p><p><b>易受攻击的代码：</b></p></p>
<p>
<p><pre>
 private static byte[] IV = new byte[16] {(byte)0,(byte)1,(byte)2,[...]};
 public void encrypt(String message) throws Exception {
  IvParameterSpec ivSpec = new IvParameterSpec(IV);
 [...]
 </pre></p>
<p><p><b>解决方案：</b></p></p>
<p>
<p><pre>
 public void encrypt(String message) throws Exception {
  byte[] iv = new byte[16];
  new SecureRandom().nextBytes(iv);
  IvParameterSpec ivSpec = new IvParameterSpec(iv);
 [...]
 </pre></p>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_4">引用</h1>
<p><a href="http://en.wikipedia.org/wiki/Initialization_vector">Wikipedia: Initialization vector</a><br/>
<a href="http://cwe.mitre.org/data/definitions/329.html">CWE-329: Not Using a Random IV with CBC Mode</a><br/>
<a href="https://defuse.ca/cbcmodeiv.htm">Encryption - CBC Mode IV: Secret or Not?</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7576">广播（Android）</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>广播（Android）</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
任何具有权限的应用程序都可以侦听广播。
建议尽量避免在广播中传输敏感信息。
</p>
<p>
<b>有风险的代码：</b><br/>
<pre>
 Intent i = new Intent();
 i.setAction("com.insecure.action.UserConnected");
 i.putExtra("username", user);
 i.putExtra("email", email);
 i.putExtra("session", newSessionId);
 this.sendBroadcast(v1);
 </pre></p>
</p>
<p><br/>
<p>
<b>解决方案(如果有可能)：</b><br/>
<pre>
Intent i = new Intent();
i.setAction("com.secure.action.UserConnected");
sendBroadcast(v1);
</pre>
</p>
<br/>
<p>
<b>配置(接收端)<sup>[1] Source: StackOverflow</sup>:</b><br/></p>
<p><pre>
 &lt;manifest ...&gt;
  &lt;!-- Permission declaration --&gt;
  &lt;permission android:name="my.app.PERMISSION" /&gt;
  &lt;receiver
  android:name="my.app.BroadcastReceiver"
  android:permission="my.app.PERMISSION"&gt; &lt;!-- Permission enforcement --&gt;
  &lt;intent-filter&gt;
  &lt;action android:name="com.secure.action.UserConnected" /&gt;
  &lt;/intent-filter&gt;
  &lt;/receiver&gt;
  ...
 &lt;/manifest&gt;
 </pre>
</p>
<p>
<b>Configuration (sender)<sup>[1] Source: StackOverflow</sup>:</b><br/>
<pre>
 &lt;manifest&gt;
  &lt;!-- We declare we own the permission to send broadcast to the above receiver --&gt;
  &lt;uses-permission android:name="my.app.PERMISSION"/&gt;
  &lt;!-- With the following configuration, both the sender and the receiver apps need to be signed by the same developer certificate. --&gt;
  &lt;permission android:name="my.app.PERMISSION" android:protectionLevel="signature"/&gt;
 &lt;/manifest&gt;
 </pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD03-J.+Do+not+broadcast+sensitive+information+using+an+implicit+intent">CERT: DRD03-J. Do not broadcast sensitive information using an implicit intent</a><br/>
<a href="http://developer.android.com/reference/android/content/BroadcastReceiver.html#Security">Android Official Doc: BroadcastReceiver (Security)</a><br/>
<a href="http://developer.android.com/guide/topics/manifest/receiver-element.html">Android Official Doc: Receiver configuration (see <code>android:permission</code>)</a><br/>
<sup>[1]</sup> <a href="http://stackoverflow.com/a/21513368/89769">StackOverflow: How to set permissions in broadcast sender and receiver in android</a><br/>
<a href="https://cwe.mitre.org/data/definitions/925.html">CWE-925: Improper Verification of Intent by Broadcast Receiver</a><br/>
<a href="https://cwe.mitre.org/data/definitions/927.html">CWE-927: Use of Implicit Intent for Sensitive Communication</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7545">不安全的哈希匹配</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>不安全的哈希匹配</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
攻击者可能根据比较时间的长短检测加密哈希的值。 当调用函数<code>Arrays.equals()</code> 或<code>String.equals()</code>时，一旦字节不匹配，它们就会立刻退出。
</p>
<p>
<p><b>易受攻击的代码：</b><br/>
<pre>
String actualHash = ...
if(userInput.equals(actualHash)) {
    ...
}</pre>
</p>
<p><b>解决方案：</b><br/>
<pre>
String actualHash = ...
if(MessageDigest.isEqual(userInput.getBytes(),actualHash.getBytes())) {
    ...
}</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="https://cwe.mitre.org/data/definitions/203.html">CWE-203: Information Exposure Through DiscrepancyKey</a><br/>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7580">带JavaScript接口（Android）的WebView</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>带JavaScript接口（Android）的WebView</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
使用JavaScript接口会将WebView暴露给高风险的API。
如果在WebView中触发了XSS，那么这个类就可以被恶意JavaScript代码调用。</p>
</p>
<p>
<p><b>有风险的代码：</b><br/></p>
<pre>
WebView myWebView = (WebView) findViewById(R.id.webView);

myWebView.addJavascriptInterface(new FileWriteUtil(this), "fileWriteUtil");

WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);

[...]
class FileWriteUtil {
    Context mContext;

    FileOpenUtil(Context c) {
        mContext = c;
    }

    public void writeToFile(String data, String filename, String tag) {
        [...]
    }
}</pre>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29">Android Official Doc: WebView.addJavascriptInterface()</a><br/>
<a href="https://cwe.mitre.org/data/definitions/749.html">CWE-749: Exposed Dangerous Method or Function</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1089">不安全的清洗规则</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">参考资料</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>该软件没有或不恰当地中立化由上游设备接收到的输入信息中的特殊字符，如"&lt;"、"&gt;"和"&amp;"，当它们被送往处理网页内容的下游设备时，将会被错误地解释成Web脚本元素。</p>
<h1 id="_2">漏洞与风险</h1>
<p>这将会使类似的字符被当做控制字符，当在特定的用户会话（Session）下时会被客户端执行。尽管这样的问题可以分到注入类下，但更相关的问题是在展现给用户之前已经对这些特殊字符做了与各个上下文不相符的转换。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>仔细对照白名单中允许的字符和格式，对输入进行检查。</li>
<li>使用并指明读取上游输出的下游设备能够处理的输出编码。</li>
<li>在Struts下，直接写入来自将filter属性设置为true的表单bean的数据。</li>
<li>为了缓解针对用户会话Cookie的XSS攻击，请将会话Cookie设置为HttpOnly。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>在下面的例子中，在展示给客户端浏览器前，访客留言簿没有合理地被加密、过滤，即没有合理地对脚本相关的标签进行中立化：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">&lt;%</span> <span class="k">for</span> <span class="o">(</span><span class="n">Iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">guestbook</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();</span> <span class="o">)</span> <span class="o">{</span>
<span class="n">Entry</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="n">Entry</span><span class="o">)</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span> <span class="k">%&gt;</span>
<span class="nt">&lt;p&gt;</span>Entry #<span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getText</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="k">&lt;%</span>
<span class="o">}</span> <span class="k">%&gt;</span>
</pre></div>
</td></tr></table>
<h1 id="_7">参考资料</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/80.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7507">消息摘要是自定义的</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>消息摘要是自定义的</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>实现自定义MessageDigest是容易出错的。</p></p>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST</a> 推荐使用 SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, or SHA-512/256.

</p>
<blockquote>
<p>"<b>数字签名生成的SHA-1：</b><br/>SHA-1只能用于NIST协议特定指导的数字签名生成。对于所有其它应用，<u>“SHA-1”不能用于数字签名生成</u>。<br/></p>
<p><b>用于数字签名验证的SHA-1：</b><br/>对于数字签名验证，<u>SHA-1是允许合法使用的</u>。<br/></p>
<p>[...]<br/></p>
<p><b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224，和 SHA-512/256</b>:<br/></p>
<p>所有哈希函数应用程序都可以使用这些哈希函数。"<br/></p>
<ul>
<li><a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a></li>
</ul>
</blockquote>
<p>
<p><b>易受攻击的代码：</b><br/></p>
<p><pre>MyProprietaryMessageDigest extends MessageDigest {
  @Override
  protected byte[] engineDigest() {
  [...]
  //创造力是个坏主意
  return [...];
  }
 }</pre></p>
</p>
<p>
<p><p>升级您的安装使用以使用已批准的一个算法。使用一种足够强大的算法来满足您的特定安全需求。</p></p>
<p>
<p><b></b></p>
<p>解决方案示例：</p></p></p><br/>
<p><pre>MessageDigest sha256Digest = MessageDigest.getInstance(""SHA256"");
sha256Digest.update(password.getBytes());</pre></p>

<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST Approved Hashing Algorithms</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7151">可以因为引用可变对象而暴露内部的字段表示</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>可以因为引用可变对象而暴露内部的字段表示</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>该代码将一个外部可变对象的引用存储到对象的内部表示中。</p>
<p>如果实例是由不受信任的代码访问的，并且对可变对象的未检查的更改将危及安全性或其它重要属性，那么你将需要做一些不同的事情。</p>
<p>在许多情况下，存储对象的副本是更好的方法。</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>低</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7150">可能因为返回对可变对象的引用暴露内部的字段表示</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>可能因为返回对可变对象的引用暴露内部的字段表示</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>返回对存储在对象的一个​​字段中的可变对象值的引用会公开对象的内部表示。
   如果不受信任的代码访问实例，并且对可变对象的未经检查的更改会危及安全性或其它重要属性，则需要执行不同的操作。
  在许多情况下，返回对象的新副本是更好的方法。</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>低</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7489">没有安全标志的Cookie</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>没有安全标志的Cookie</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
  一个新的cookie在没有<code>Secure</code>标志的情况下创建。
<code>Secure</code>标志是对浏览器的一个指令，以确保cookie不会被发送到不安全的通信中 (<code>http://</code>)。</p>
</p>
<p>
<p><b>有风险的代码：</b><br/></p>
<pre>
Cookie cookie = new Cookie("userName",userName);
response.addCookie(cookie);
</pre>
</p>
<p>
<p><b>解决方案(特定配置)：</b><br/>
<pre>
Cookie cookie = new Cookie("userName",userName);
cookie.setSecure(true); // Secure flag
cookie.setHttpOnly(true);
</pre></p>
</p>
<p>
<p><b>解决方案(Servlet 3.0配置)：</b><br/></p>
<pre>
&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"&gt;
[...]
&lt;session-config&gt;
 &lt;cookie-config&gt;
  &lt;http-only&gt;true&lt;/http-only&gt;
  &lt;secure&gt;true&lt;/secure&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;
&lt;/web-app&gt;
</pre>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="reference">Reference</h1>
<p><a href="https://cwe.mitre.org/data/definitions/614.html">CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a><br/>
<a href="https://cwe.mitre.org/data/definitions/315.html">CWE-315: Cleartext Storage of Sensitive Information in a Cookie</a><br/>
<a href="https://cwe.mitre.org/data/definitions/311.html">CWE-311: Missing Encryption of Sensitive Data</a><br/>
<a href="https://www.owasp.org/index.php/SecureFlag">OWASP: Secure Flag</a><br/>
<a href="https://www.rapid7.com/db/vulnerabilities/http-cookie-secure-flag">Rapid7: Missing Secure Flag From SSL Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7541">DES是不安全的</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>DES是不安全的</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
DES被认为是现代应用的强加密算法。 目前，NIST建议使用AES分组加密而不是DES。</p>
<p></p>
<p>
<b>缺陷示例代码：</b>
<pre>Cipher c = Cipher.getInstance("DES/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>示例解决方案：</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://www.nist.gov/itl/fips/060205_des.cfm">NIST Withdraws Outdated Data Encryption Standard</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7504">SHA-1是一个弱散列函数</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>SHA-1是一个弱散列函数</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>算法SHA-1并不是用于哈希密码、签名验证和其它用途的推荐算法。
例如，应该使用<b>PBKDF2</b> 来对密码进行散列。</p>
<blockquote>
    “<b>数字签名生成的SHA-1：</b><br/>SHA-1只能用于NIST协议特定指导的数字签名生成。对于所有其它应用程序，<u>SHA-1不能用于数字签名生成</u>。<br/>
<b>用于数字签名验证的SHA-1：</b><br/>对于数字签名验证，<u>SHA-1是允许使用的</u>。<br/>
    [...]<br/>
<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, 和SHA-512/256</b>:<br/>所有哈希函数应用程序都可以使用这些哈希函数。”<br/>
    - 
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<blockquote>
“PBKDF的主要思想是通过增加测试每个密码所需的时间来减慢字典或对密码的暴力破解。一个带有可能密码列表的攻击者可以使用已知的迭代计数器和salt来评估PBKDF。由于攻击者每次尝试都要花费大量的计算时间，所以应用字典或蛮力攻击变得更加困难。”<br/>
- 
<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation  p.12</a>
</blockquote>
<br/>
<p>
<b>易受攻击的代码：</b><br/>
<pre>MessageDigest sha1Digest = MessageDigest.getInstance("SHA1");
    sha1Digest.update(password.getBytes());
    byte[] hashValue = sha1Digest.digest();</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;pre&gt;</span>byte[] hashValue = DigestUtils.getSha1Digest().digest(password.getBytes());<span class="nt">&lt;/pre&gt;</span>
</pre></div>
</td></tr></table>
</p>
<p>
<b>
解决方案（使用bouncy castle）：</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    PKCS5S2ParametersGenerator gen = new PKCS5S2ParametersGenerator(new SHA256Digest());
    gen.init(password.getBytes("UTF-8"), salt.getBytes(), 4096);
    return ((KeyParameter) gen.generateDerivedParameters(256)).getKey();
}</pre>
<b>解决方案（java 8或以上版本）：</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    KeySpec spec = new PBEKeySpec(password.toCharArray(), salt, 4096, 256 * 8);
    SecretKeyFactory f = SecretKeyFactory.getInstance(""PBKDF2WithHmacSHA256"");
    return f.generateSecret(spec).getEncoded();
}</pre>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="https://community.qualys.com/blogs/securitylabs/2014/09/09/sha1-deprecation-what-you-need-to-know">Qualys blog: SHA1 Deprecation: What You Need to Know</a><br/>
<a href="https://googleonlinesecurity.blogspot.ca/2014/09/gradually-sunsetting-sha-1.html">Google Online Security Blog: Gradually sunsetting SHA-1</a><br/>
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</a><br/>
<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation</a><br/>
<a href="http://stackoverflow.com/questions/22580853/reliable-implementation-of-pbkdf2-hmac-sha256-for-java">Stackoverflow: Reliable implementation of PBKDF2-HMAC-SHA256 for Java</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7542">DESede不安全</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>DESede不安全</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
三重DES（也称为3DES或DESede）被认为是现代应用的强加密算法。 目前，NIST建议使用AES分组加密而不是3DES。
</p>
<p>
<b>缺陷代码示例：</b>
<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>示例解决方案：</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://www.nist.gov/itl/fips/060205_des.cfm">NIST Withdraws Outdated Data Encryption Standard</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1090">权限管理</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
</ul>
</li>
<li><a href="#_7">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>因为应用没有合理地分配权限或者根据未知来源的信息分配权限，导致给用户赋予了危险的权限。</p>
<h1 id="_2">漏洞与风险</h1>
<p>不合理的权限管理可能会导致不受信的、权限不足的代码拥有某些需要额外权限的操作的执行权。然而，把权限管理精细地做到位会增加很多复杂性。因此，安全方面提升带来的收益必须要盖过额外的复杂度以及相应降低可维护性带来的问题。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<ul>
<li>小心地处理好配置、管理以及权限相关的问题，明确管理软件中的可信区域。</li>
<li>用可完成相应任务的最低权限来运行你的代码。</li>
</ul>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<p>以下程序为使接收方程序以备份意图来读取数据文件，在发送的内容中增加了一个标志：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">();</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="s">"com.example.BackupUserData"</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">file_uri</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">addFlags</span><span class="o">(</span><span class="n">FLAG_GRANT_READ_URI_PERMISSION</span><span class="o">);</span>
<span class="n">sendBroadcast</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>任何恶意程序都能通过预先注册，从而接收到有关备份意图的数据。因为确实附着了<code>FLAG_GRANT_READ_URI_PERMISSION</code>标签，因而恶意的接收者都能读取用户的数据：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CallReceiver</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Uri</span> <span class="n">userData</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
    <span class="n">stealUserData</span><span class="o">(</span><span class="n">userData</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_7">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CWE264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A6">
<p>https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration <a class="footnote-backref" href="#fnref-OWASP-A6" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1079">操纵访问标识符</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">缓解与预防</a></li>
<li><a href="#_5">演示实例</a><ul>
<li><a href="#_6">漏洞代码示例</a></li>
<li><a href="#_7">漏洞代码修复示例</a></li>
</ul>
</li>
<li><a href="#_8">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>反射使Java程序能够分析和修改自身。特别是，程序可以发现正常无法访问的字段的值并对其进行更改。</p>
<h1 id="_2">漏洞与风险</h1>
<p>使用反射会使安全分析复杂化，并且可以轻松引入安全漏洞。因此，程序员应尽可能避免使用反射API。当需要使用反射时，请格外小心。</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">缓解与预防</h1>
<p>不得使用反射来提供对类，方法和字段的访问，除非那些项在不使用反射的情况下已经可以访问。 例如，不允许使用反射来访问或修改字段，除非这些字段已经可以通过其他方式（例如通过getter和setter方法）访问和修改。</p>
<h1 id="_5">演示实例</h1>
<h3 id="_6">漏洞代码示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setObjectId</span><span class="o">(</span><span class="n">Example</span> <span class="n">example</span><span class="o">,</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">example</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="_7">漏洞代码修复示例</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setObjectId</span><span class="o">(</span><span class="n">Example</span> <span class="n">example</span><span class="o">,</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">example</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="_8">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CWE264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT-SEC05-JAVA">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC05-J.+Do+not+use+reflection+to+increase+accessibility+of+classes%2C+methods%2C+or+fields <a class="footnote-backref" href="#fnref-CERT-SEC05-JAVA" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A6">
<p>https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration <a class="footnote-backref" href="#fnref-OWASP-A6" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7564">加密算法易受Padding Oracle影响</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>加密算法易受Padding Oracle影响</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
这种带有 PKCS5Padding的CBC模式容易受到padding oracle攻击。
如果系统暴露了明文与无效填充或有效填充之间的差异，则对手可能会对消息进行解密。
有效和无效的填充物之间的区别通常是通过为每个条件返回的不同的错误消息来表现的。
</p>
<p>
<b>有风险的代码：</b>
<pre>Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>解决方案：</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="http://www.infobytesec.com/down/paddingoracle_openjam.pdf">Padding Oracles for the masses (by Matias Soler)</a><br/>
<a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://capec.mitre.org/data/definitions/463.html">CAPEC: Padding Oracle Crypto Attack</a><br/>
<a href="http://cwe.mitre.org/data/definitions/696.html">CWE-696: Incorrect Behavior Order</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7152">可以通过将可变对象存储到静态字段中来暴露内部静态状态</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>可以通过将可变对象存储到静态字段中来暴露内部静态状态</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>此代码将外部可变对象的引用存储到静态字段中。</p>
<p>如果对可变对象的未检查更改会危及安全性或其它重要属性，则需要做一些不同的操作。</p>
<p>在许多情况下，存储对象的副本是更好的方法。
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>低</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7579">启用JavaScript的WebView（Android）</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>启用JavaScript的WebView（Android）</p>
<h1 id="_2">漏洞与风险</h1>
<p>
<p>为WebView启用JavaScript意味着它现在容易受到XSS攻击。
呈现的页面应该检查潜在的反射XSS、存储XSS和DOM XSS。<br/></p>
<p><pre>
 WebView myWebView = (WebView) findViewById(R.id.webView);
 WebSettings webSettings = myWebView.getSettings();
 webSettings.setJavaScriptEnabled(true);
</pre></p>
</p>
<p>
<p><b>有风险的代码：</b><br/></p>
<p>启用JavaScript并不是一种糟糕的做法。这只是意味着后端代码需要对潜在的XSS进行审计。</p>
<p>XSS也可以用DOM XSS引入客户端。</p>
<p><pre>
 function updateDescription(newDescription) {
  $("#userDescription").html("&lt;p&gt;"+newDescription+"&lt;/p&gt;");
 }</pre></p>
</p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="http://www.technotalkative.com/issue-using-setjavascriptenabled-can-introduce-xss-vulnerabilities-application-review-carefully/">Issue: Using setJavaScriptEnabled can introduce XSS vulnerabilities</a><br/>
<a href="http://developer.android.com/guide/webapps/webview.html#UsingJavaScript">Android Official Doc: WebView</a><br/>
<a href="http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting">WASC-8: Cross Site Scripting</a><br/>
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP: XSS Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29">OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7505">具有默认构造函数的DefaultHttpClient与TLS 1.2不兼容</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>具有默认构造函数的DefaultHttpClient与TLS 1.2不兼容</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
<b>易受攻击的代码：</b><br/>
<pre>
HttpClient client = new DefaultHttpClient();
</pre>
</p>
<p>
<p><b>解决方案：</b><br/>
升级您的安装启用以使用推荐的结构之一并配置https.protocols JVM选项包括TLSv 1.2：</p>
<p>
<ul>
<li>
使用<a href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/SystemDefaultHttpClient.html">SystemDefaultHttpClient</a>代替</li>
<p>
<b>
示例代码：</b><br/>
<pre>
HttpClient client = new SystemDefaultHttpClient();
</pre>
</p></ul></p>
<li>用<a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ssl/SSLSocketFactory.html#getSystemSocketFactory()">getSystemSocketFactory()</a>创建基于SSLSocketFactory的HttpClient——获得一个SSLScoketFactory实例并使用这个实例进行HttpClient创建。</li>
<li>创建基于SSLConnectionSocketFactory的HttpClient——用<a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ssl/SSLConnectionSocketFactory.html#getSystemSocketFactory()">getSystemSocketFactory()</a>获取一个实例并使用这个实例进行HttpClient创建。</li>
<li>在调用build()前使用HttpClientBuilder调用<a href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/HttpClientBuilder.html#useSystemProperties()">useSystemProperties()</a></li>
<p>
<b>示例代码：
</b><br/>
<pre>
HttpClient client = HttpClientBuilder.create().useSystemProperties().build();
</pre>
</p>
<li>HttpClients调用<a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/HttpClients.html#createSystem()">createSystem()</a>来产生一个实例。</li>
<p>
<b>示例代码：</b><br/>
<pre>
HttpClient client = HttpClients.createSystem();
</pre>
</p>
</p></p>

<h1 id="_3">漏洞利用威胁</h1>
<p>高</p>
<h1 id="_4">引用</h1>
<p><a href="https://blogs.oracle.com/java-platform-group/entry/diagnosing_tls_ssl_and_https">Diagnosing TLS, SSL, and HTTPS</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7549">RSA使用短密钥</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>RSA使用短密钥</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
   NIST建议使用<u>2048位和更高位的</u>密钥进行RSA算法。
</p>
<blockquote>
    "Digital Signature Verification | RSA: 1024 ≤ len(n) &lt; 2048 | Legacy-use"<br/>
    "Digital Signature Verification | RSA: len(n) ≥ 2048 | Acceptable"<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.7</a>
</blockquote>
<p><b>易受攻击的代码：</b><br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(512);
</pre>
</p>
<p><b>解决方案：</b><br/>
创建KeyPairGenerator至少应为2048位密钥大小<br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(2048);
</pre>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>严重</p>
<h1 id="_4">引用</h1>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/key_management.html">NIST: Latest publication on key management</a><br/>
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.7</a><br/>
<a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/how-large-a-key-should-be-used.htm">RSA Laboratories: 3.1.5 How large a key should be used in the RSA cryptosystem?</a><br/>
<a href="http://en.wikipedia.org/wiki/Key_size#Asymmetric%5Falgorithm%5Fkey%5Flengths">Wikipedia: Asymmetric algorithm key lengths</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a><br/>
<a href="http://www.keylength.com/en/compare/">Keylength.com (BlueKrypt): Aggregate key length recommendations.</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">安全问题</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">安全策略管理</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7506">弱SSLContext</h1>
                <p>
                    在 2024-九月-28 发布于 <a href="../../../category/security-policy-management.html">安全策略管理</a> 分类

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#_1">缺陷描述</a></li>
<li><a href="#_2">漏洞与风险</a></li>
<li><a href="#_3">漏洞利用威胁</a></li>
<li><a href="#_4">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="_1">缺陷描述</h1>
<p>弱SSLContext</p>
<h1 id="_2">漏洞与风险</h1>
<p><p>
<b>易受攻击的代码：</b><br/>
<pre>
    SSLContext.getInstance("SSL");
</pre>
</p>
<p>
<p><b>解决方案：</b><br/></p>
<p>将安装启用升级到以下内容，并配置https.protocols JVM选项以包含TLSv 1.2：</p>
<pre>
    SSLContext.getInstance("TLS");
</pre>
<p>
</p></p>
<h1 id="_3">漏洞利用威胁</h1>
<p>中</p>
<h1 id="_4">引用</h1>
<p><a href="https://blogs.oracle.com/java-platform-group/entry/diagnosing_tls_ssl_and_https">Diagnosing TLS, SSL, and HTTPS</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Pinpoint 源代码静态缺陷分析系统, 源伞科技有限公司 - 保留所有权利
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>