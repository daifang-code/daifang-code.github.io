
<!DOCTYPE html>
<html lang="en">

<head>
    <link href='../../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../../theme/stylesheet/normalize.min.css">
    <script src="../../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../../..">
                <img src="../../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="Input to search">
            </form>
        </div>


        <ul class="global_lang">
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../../standard/language-independent.html">Language Independent documents</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../../standard/c.html">c/c++ documents</a>
                        (317)
                    </li>
                    <li>
                        <a href="../../../standard/csharp.html">csharp documents</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../../standard/golang.html">golang documents</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../../standard/java.html">java documents</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../../standard/javascript.html">javascript documents</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../../standard/objective-c.html">objective-c documents</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../../standard/python.html">python documents</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../../standard/shell.html">shell documents</a>
                        (334)
                    </li>
                    <li>
                        <a href="../../../standard/swift.html">swift documents</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            Logic errors (39)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0048">Copy Paste Error</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-behaviour">Unexpected Behaviour</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>A section of code was copied and pasted, and a systematic change was made to the copy. However, because that change was incomplete, it unintentionally left some portions of the copy unchanged.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-behaviour">Unexpected Behaviour</h4>
<p>Because that change was incomplete, it unintentionally left some portions of the copy unchanged.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Check the logic of codes.   </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CopyPasteBad</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">square</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span>

  <span class="kt">int</span> <span class="n">example</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// "square(a)" should read "square(b)"</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the second instance of a should be replaced with b at line 11.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CopyPasteGood</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">square</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span>

  <span class="kt">int</span> <span class="n">example</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, using correct way to copy and paste code.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0052">boolean Assignment</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#portability-error">portability error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The boolean data type (bool) is intended to hold the values 1 (true) or 0 (false), but it can be forced to rely on ANSI typing rules, which are very flexible and allow boolean types to be treated as integer types. This can cause problems when porting between compilers with differing levels of flexibility, so this checker enforces a 1-byte allocation maximum for any boolean data type.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="portability-error">portability error</h4>
<p>Assignment to a bool type larger than 1 byte can cause problems when porting between compilers with differing levels of flexibility.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Don't interchange boolean data with other integer-type data. The C++ standard defines boolean keywords "true" and "false" to represent integer values 1 and 0, respectively. In addition, many compilers define TRUE and FALSE macros or suitable placeholders, or you can define your own values.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">char</span> <span class="n">BOOL</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">BOOL</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, assignment 256 to a bool type variable.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">char</span> <span class="n">BOOL</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">BOOL</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, assignment true to a bool type variable.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0011">Enum As Boolean</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>An enum-typed expression is inadvertently used in a boolean context, such as a predicate. This will lead to undefined behavior. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>An enum-typed expression is inadvertently used in a boolean context, such as a predicate. This will lead to undefined behavior. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not use an enum-typed expression in a boolean context.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="n">color</span> <span class="p">{</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span> <span class="p">};</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">green</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="c1">// detect</span>
  <span class="p">{</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">red</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, using an enum-typed variable c as a predicate at line 6.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="n">color</span> <span class="p">{</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span> <span class="p">};</span>

<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">green</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">green</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">red</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, using a boolean context as a predicate at line 6.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0067">Dead Store</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#invalid-code">Invalid code</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The assignment is not used until the next assignment or the end of the function, so such assignment or initialization is actually invalid. Such code may introduce logic errors.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="invalid-code">Invalid code</h4>
<p>The assignment is not used until the next assignment or the end of the function, so such assignment or initialization is actually invalid.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Remove invalid code.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// Value stored to x is never read.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the <code>x = 20</code> is a dead store.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The above example remove the invalid code.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0023">Missing Break</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unpredictable-behavior">unpredictable behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Missing break statements at the end of a block of code for a case or default statement. A missing break statement can lead to incorrect or unpredictable behavior.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unpredictable-behavior">unpredictable behavior</h4>
<p>A missing break statement can lead to incorrect or unpredictable behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Add break statement at the end of a block of code for a case or default statement.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{}</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="c1">// Defect: Missing break statement in this case</span>
    <span class="n">foo</span><span class="p">();</span>
  <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, missing break statement in case 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{}</span>

<span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
        <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, add break statement in case 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1042">Useless assignment</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#bad-example">bad Example</a></li>
<li><a href="#good-example">good Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Assignment of function parameter has no effect outside the function.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>May be you should pass the parameter as a pointer or reference instead of a value.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="bad-example">bad Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">){</span>
     <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In this code, the parameter as a value has no effect outside the function.</p>
<h3 id="good-example">good Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span> 
    <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The parameter as a pointer or reference instead of a value.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0041">No Effect</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#poor-code-quality">poor code quality</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Many statements or expressions that do not accomplish anything, or statements that perform an action that is not the intended action.</p>
<p>For example:</p>
<p>1.The left operand of a comma operator has no side effects.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">extra_comma</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">a</span><span class="o">++</span><span class="p">,</span> <span class="n">b</span><span class="o">++</span><span class="p">){</span> 
    <span class="cm">/* Extra comma, and so a &lt; 10 is not used */</span>
      <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>2.Patterns delete a, b, where only the first pointer is deleted.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">incomplete_delete</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="o">*</span><span class="n">q</span><span class="p">;</span>
  <span class="n">delete</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span> <span class="c1">// The pointer q is not deleted</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>3.Useless dereferences of pointers.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">no_effect_deref</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
  <span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="p">;</span> <span class="c1">// *p has no effect</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>4.An intended assignment instead of a comparison.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">no_effect_test</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="c1">// Test has no effect</span>
  <span class="c1">// and is likely intended to be the assignment a = b </span>
  <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>5.Switching on a comparison and indicates a likely intended assignment</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">bool_switch</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Boolean switch</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>6.Unsigned comparisons against 0, unless the expression's parent is a manual signed cast.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">unsigned_compare</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// a is unsigned, and so the comparison is never true</span>
    <span class="n">a</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>7.Assignments of fields or globals to self.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">self_assign</span><span class="p">(</span><span class="k">struct</span> <span class="n">foo</span> <span class="o">*</span><span class="n">ptr</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>           <span class="c1">// assignment to self, global</span>
  <span class="n">ptr</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">ptr</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span> <span class="c1">// assignment to self, field</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>8.Self assigns to local variables or parameters.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">self_assign_local</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="c1">// assignment to self, local</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="poor-code-quality">poor code quality</h4>
<p>The code has features that do not directly introduce a weakness or vulnerability, but indicate that the product has not been carefully developed or maintained. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Understand the logical of the code and remove useless code.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">;</span> <span class="c1">// detect</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the test at line 3 has no effect, and is likely intended to be the assignment a = b. </p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, using assignment instead of comparison at line 3.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0125">Strong type</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When assigning, passing, or evaluating a variable of an abstract type defined by typedef, the abstract type defined by typedef is ignored and the corresponding basic type is used directly.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Ignoring an abstract type defined by typedef and directly using the corresponding primitive type may have a logic error.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When a variable of an abstract type defined by typedef needs to be assigned, parameter passed, or computed with other types of variables, the type is cast.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>  <span class="c1">//A type variable is assigned to a type B variable</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">B</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="n">a</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.27 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0128">Hidden parameter</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Parameter hiding by local variables refers to the phenomenon that parameters and local variables have the same name.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When a local variable has the same name as a function parameter, it will invalidate these function parameters. This may not be the programmer's intention, which may result in incorrect program function implementation.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When writing a program, local variables should not have the same name as the parameters.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>     <span class="c1">// Local variables have the same name as </span>
                   <span class="c1">// function parameters</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.28 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0014">Missing Return</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unpredictable-behavior">unpredictable behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Not returning a value can result in unpredictable program behavior. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unpredictable-behavior">unpredictable behavior</h4>
<p>Not returning a value can result in unpredictable program behavior. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Provide a return value in a non-void function.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span> <span class="c1">// missing_return</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example if the value of x is neither 5 nor 3, the non-void function bad missed a return value.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<p>In the fixed code example  provide a return value at the end of function.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0113">implicit int function</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The obsolete "implicit int" rule is used when declaring a function or variable.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When a variable is not assigned a type, the default is "int", but modern C++ no longer supports this rule, which may make the code difficult to port.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When declaring a function or variable, you should specify the type of the variable or function return value.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   <span class="c1">// Type of constant not declared</span>
<span class="n">example_fun</span><span class="p">()</span>    <span class="c1">// The type of function return value not declared</span>
<span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   
<span class="kt">int</span> <span class="nf">example_fun</span><span class="p">()</span>    
<span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.30 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0005">Com Bad Free</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#use-after-free-memory">use-after-free memory</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>COM specifies that this management should be accomplished through the AddRef and Release methods in every COM interface. It is an error to circumvent the reference counting mechanism by explicitly free a pointer to an interface, because other clients may share ownership of the same object. </p>
<p>Explicitly free a pointer to a COM interface can leave other owners of the instance with dangling pointers. This can possibly result in use-after-free memory errors, including memory corruption and crashes.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="use-after-free-memory">use-after-free memory</h4>
<p>Explicitly free a pointer to a COM interface can leave other owners of the instance with dangling pointers. This can possibly result in use-after-free memory errors, including memory corruption and crashes.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use the AddRef or Release methods to manage the pointer to a COM interface.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">IUnknown</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CFoo</span><span class="p">;</span>
  <span class="n">delete</span> <span class="n">p</span><span class="p">;</span> <span class="c1">// bad</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, explicitly free a pointer to a CFoo interface at line 3.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">IUnknown</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CFoo</span><span class="p">;</span>
    <span class="n">p</span><span class="o">-&gt;</span><span class="n">AddRef</span><span class="p">();</span> <span class="c1">// or p-&gt;Release();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, use AddRef() method to manage the pointer p at line 3.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0004">Sizeof Mismatch</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When a pointer and sizeof expression occur together, the sizeof expression is usually the size of memory that the pointer points to. We will report defects in a limited number of cases where a size_t argument is expected but no sizeof expression is provided. This occurs when the semantics of a function are known and the size_t argument is expected to be the size of memory to which a pointer points, as well as in a small number of cases where it appears that the size_t argument is intended to be the size of some pointed to memory.</p>
<p>The following example contains a common mismatch between a two function arguments: a pointer and a sizeof expression (where sizeof(*ptr) was intended, instead of sizeof(ptr)):  </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">obj</span><span class="p">,</span> <span class="n">ptr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ptr</span><span class="p">))</span>
</pre></div>
</td></tr></table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>Using a sizeof(pointer) instead of a sizeof(value) to get the size of value, this will lead to undefined behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Using a sizeof in a correct way.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">BB</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
<span class="p">};</span>
<span class="kt">void</span> <span class="nf">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">BB</span> <span class="n">buf</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">));</span> <span class="c1">// bad</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, only 4 or 8 bytes of the 100-byte object buf are cleared at line 6.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">BB</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
<span class="p">};</span>
<span class="kt">void</span> <span class="nf">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">BB</span> <span class="n">buf</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span> <span class="c1">// good</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, all of the 100-byte object buf are cleared at line 6.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/csharp.html">CSHARP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0012">Missing Comma</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-results">unexpected results</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Omissions of a comma between lines in a string array initialization. A missing comma can lead to a single concatenated string element instead of separate string elements, and it can contribute to unexpected results or to an overrun.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-results">unexpected results</h4>
<p>A missing comma can lead to a single concatenated string element instead of separate string elements, and it can contribute to unexpected results or to an overrun.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Add a comma between lines in a string array initialization.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(){</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"hello "</span> <span class="c1">// bad</span>
               <span class="s">"world"</span><span class="p">};</span>     
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, missed a comma between lines in a string array arr initialization at line 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(){</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"hello "</span><span class="p">,</span>
               <span class="s">"world"</span><span class="p">};</span>     
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, add a comma between lines in a string array arr initialization at line 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0075">Virtual Call In Construction Or Destruction</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-result">unexpected result</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Call a virtual function directly or indirectly from a constructor or destructor. Since the object's construction order starts from the parent class and then the derived class, it is dangerous to try to call the derived class from the parent class during the construction process. This is why calling a virtual function from a constructor does not cause a function in the derived class to be called. In this process, the derived class object has not yet been initialized. Similarly, objects are destroyed in the reverse order of construction, so attempting to call a function in a derived class in the destructor results in accessing an object that has already been destroyed.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-result">unexpected result</h4>
<p>Call a virtual function directly or indirectly from a constructor or destructor. Since the object's construction order starts from the parent class and then the derived class, it is dangerous to try to call the derived class from the parent class during the construction process. This is why calling a virtual function from a constructor does not cause a function in the derived class to be called. In this process, the derived class object has not yet been initialized. Similarly, objects are destroyed in the reverse order of construction, so attempting to call a function in a derived class in the destructor results in accessing an object that has already been destroyed.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not call virtual functions in constructors or destructors.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">A</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="n">A</span><span class="p">(){</span> <span class="n">f</span><span class="p">();</span> <span class="p">};</span>
  <span class="n">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">);</span>

  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{};</span>

  <span class="n">virtual</span> <span class="kt">int</span> <span class="nf">foo</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// from Sema: expected-note {{'foo' declared here}}</span>
  <span class="n">virtual</span> <span class="kt">void</span> <span class="nf">bar</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">f</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Call to pure virtual function during construction has undefined behavior</span>
    <span class="n">foo</span><span class="p">();</span> 
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the above code, the virtual function foo() is called in the constructor of class A.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">A</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="n">A</span><span class="p">(){};</span>
  <span class="n">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">);</span>

  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{};</span>

  <span class="n">virtual</span> <span class="kt">int</span> <span class="nf">foo</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
  <span class="n">virtual</span> <span class="kt">void</span> <span class="nf">bar</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">f</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">foo</span><span class="p">();</span> 
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the above code, remove the call to the virtual function foo() in the constructor of class A.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0116">Infinite recursion function</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The method calls itself directly or indirectly without any condition checking.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Infinite recursion can cause the program stack overflow.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Remove infinite recursion function.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">this</span><span class="p">.</span><span class="n">example_fun</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="c1">//Infinite recursion function</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.8.2 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0114">Inappropriate iterator</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The iterator is assigned to one container but the iterator is used in another container.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Using an iterator on an unsuitable container can cause undefined behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Attention should be paid to the scope and effectiveness of the iterator.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="n">b</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">...</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">b</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
    <span class="p">{</span>
      <span class="n">b</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.15 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0016">Stray Semicolon</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#logic-error">logic error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When an if statement is prematurely terminated with a semicolon, the then portion which was intended to be conditional will execute unconditionally. When a semicolon prematurely terminates a while or for loop, the loop might iterate infinitely or it might iterate pointlessly, followed by the intended body of the loop that executes once, unconditionally.</p>
<p>A number of heuristics distinguish between extraneous and intentional semicolons. For if statements, if the if has no then and no else clause, it is a defect. The only exception to this behavior is if there is a C/C++ macro that expands to nothing in the location that the then clause is expected. In this case, it is assumed that the macro conditionally expands either to a non-empty statement or nothing.</p>
<p>The rule for loops is more complicated, because loops with no bodies are common. Generally speaking, a while or for loop will only be reported if it is followed by a block (a "compound statement") that is not justified for any purpose other than serving as the loop’s intended body.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="logic-error">logic error</h4>
<p>An extraneous semicolon alters the logic of the code. When an if statement is prematurely terminated with a semicolon, the then portion which was intended to be conditional will execute unconditionally. When a semicolon prematurely terminates a while or for loop, the loop might iterate infinitely or it might iterate pointlessly, followed by the intended body of the loop that executes once, unconditionally.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Look over the semicolon followed by if, for, while statements, remove the stray senicolon.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">){};</span>

  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// detect</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, a stray semicolon followed by the while statement at line 4.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">){};</span>

  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, remove the stray senicolon followed by the while statement at line 4.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0039">Infinite Loop</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#denial-of-service-attack">denial of service attack</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The program contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="denial-of-service-attack">denial of service attack</h4>
<p>An infinite loop can cause a program to hang up indefinitely or crash, possibly allowing a denial-of-service (DoS) attack due to excessive use of CPU or memory resources.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Change the logic of the loop to avoid an infinite loop.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">global_var</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">global_var</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the exit is based on variable <code>global_var</code>, which has been defined as a global variable outside the function <code>bad</code> and is never changed in the while loop. This will lead to an infinite loop.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">global_var</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">global_var</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="n">global_var</span><span class="o">--</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<p>In the fixed code example, change the value of variable <code>global_var</code> in the while loop.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0100">Missing parenthese in macro</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Missing parenthese in macro.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When an expression is passed to the parameter, it may produce an erroneous result.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Parentheses should be used when defining parameters with macros.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#define TRIPLE(a) (a*3)</span>
<span class="kt">void</span> <span class="nf">example_fun</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// TRIPLE(a + 5) is converted to (a + 5*3)</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">TRIPLE</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span> 
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#define TRIPLE(a) ((a)*3)</span>
<span class="kt">void</span> <span class="nf">example_fun</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">TRIPLE</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span> 
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.29 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0126">Using system literal macro</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>This is the limit that a typical compiler provides for its particular data model and functionality (usually in limits.h). Using these values ​​across platforms is dangerous because different compilers may provide different limits and widths, which can cause stack overflows, numerical overflows or underflows, and exhaustion of operations during operation.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>It may cause stack overflow, numerical overflow or underflow, and exhaustion of operations during operation.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Customize the required limits instead of relying on an abstract number provided by the platform-specific compiler.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">INT_MAX</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#define MY_INT_MAX 65535</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">MY_INT_MAX</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.7 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0002">Ignore Return Value</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unpredictable-behavior-1">unpredictable behavior 1</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example1c">Vulnerable code Example1(C)</a></li>
<li><a href="#fixed-code-example1c">Fixed Code Example1(C)</a></li>
<li><a href="#vulnerable-code-example2java">Vulnerable code Example2(JAVA)</a></li>
<li><a href="#fixed-code-example2java">Fixed Code Example2(JAVA)</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Ignoring returned function error codes and assuming that an operation was successful can cause incorrect program behavior, and in some cases system crashes. The only way to suppress returned function error codes is to cast the called function result to a void.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unpredictable-behavior-1">unpredictable behavior <sup id="fnref-cwe"><a class="footnote-ref" href="#fn-cwe">1</a></sup></h4>
<p>If an attacker can force the function to fail or otherwise return a value that is not expected, then the subsequent program logic could lead to a vulnerability, because the software is not in a state that the programmer assumes.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Check the return value of functions or methods.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example1c">Vulnerable code Example1(C)</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">test_check</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">test_check</span><span class="p">();</span>   <span class="c1">// Not check the return value</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the statement at line 6 is a defect because the return value of function test_check() is not checked.</p>
<h3 id="fixed-code-example1c">Fixed Code Example1(C)</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">test_check</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">test_check</span><span class="p">();</span> 
    <span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
      <span class="p">...</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, checked the return value of function test_check() at line 6.</p>
<h3 id="vulnerable-code-example2java">Vulnerable code Example2(JAVA)</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteFile</span><span class="o">(){</span>
  <span class="n">File</span> <span class="n">someFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">"someFileName.txt"</span><span class="o">);</span>
   <span class="n">someFile</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, it ignored the return value of someFile.delete().</p>
<h3 id="fixed-code-example2java">Fixed Code Example2(JAVA)</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteFile</span><span class="o">(){</span>
  <span class="n">File</span> <span class="n">someFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">"someFileName.txt"</span><span class="o">);</span>
   <span class="k">if</span> <span class="o">(!</span><span class="n">someFile</span><span class="o">.</span><span class="na">delete</span><span class="o">())</span> <span class="o">{</span>
    <span class="c1">// handle failure to delete the file</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code, it checked the return value of someFile.delete().</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/252.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/csharp.html">CSHARP</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0024">Nesting Indent Mismatch</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#dangling-else-issue">"dangling else" issue</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Braces improve the uniformity and readability of code. More important, when inserting an additional statement into a body containing only a single statement, it is easy to forget to add braces because the indentation gives strong (but misleading) guidance to the structure.</p>
<p>Braces also help ensure that macros with multiple statements are properly expanded. Such a macro should be wrapped in a do-while loop. However, when the do-while loop is not present, braces can still ensure that the macro expands as intended.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="dangling-else-issue">"dangling else" issue</h4>
<p>In the following example, it appears that the developer intended do_something_else() to be the else of the first if statement (that is, when condition1 is false). However, the else is incorrectly written to apply to the second if (that is, when condition1 is true and condition2 is false, with nothing happening when condition1 is false):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">condition1</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">condition2</span><span class="p">)</span>
    <span class="n">do_something</span><span class="p">();</span>
<span class="k">else</span> <span class="c1">// "dangling"</span>
  <span class="n">do_something_else</span><span class="p">();</span>
</pre></div>
</td></tr></table>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Opening and closing braces for if, for, and while statements should always be used even if the statement's body contains only a single statement.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">cond1</span><span class="p">();</span>
<span class="kt">bool</span> <span class="nf">cond2</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something_else</span><span class="p">();</span>

<span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">cond1</span><span class="p">())</span> 
    <span class="k">if</span> <span class="p">(</span><span class="n">cond2</span><span class="p">())</span>
      <span class="n">do_something</span><span class="p">();</span>
  <span class="k">else</span>
    <span class="n">do_something_else</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, missing opening and closing braces for if and else statements.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">cond1</span><span class="p">();</span>
<span class="kt">bool</span> <span class="nf">cond2</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something_else</span><span class="p">();</span>

<span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">cond1</span><span class="p">()){</span> 
    <span class="k">if</span> <span class="p">(</span><span class="n">cond2</span><span class="p">()){</span>
      <span class="n">do_something</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="n">do_something_else</span><span class="p">();</span>
  <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, add opening and closing braces for if and else statements.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0068">Float loop</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#dos-crash-exit-restart">DoS: crash / exit / restart</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Because floating-point numbers represent real numbers, it is often mistakenly assumed that they can represent any simple fraction exactly. Floating-point numbers are subject to representational limitations just as integers are, and binary floating-point numbers cannot represent all real numbers exactly, even if they can be represented in a small number of decimal digits.<br/>
In addition, because floating-point numbers can represent large values, it is often mistakenly assumed that they can represent all significant digits of those values. To gain a large dynamic range, floating-point numbers maintain a fixed number of precision bits (also called the significand) and an exponent, which limit the number of significant digits they can represent.<br/>
Different implementations have different precision limitations, and to keep code portable, floating-point variables must not be used as the loop induction variable.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="dos-crash-exit-restart">DoS: crash / exit / restart</h4>
<p>If floating-point variables are used as the loop induction variable. which may cause dead loop.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use integer as loop induction variable.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">float</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(;</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span><span class="n">a</span><span class="o">++</span><span class="p">){</span>
    <span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In this example, use float variable a as loop induction variable, which may cause infinite loop.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(;</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span><span class="n">a</span><span class="o">++</span><span class="p">){</span>
    <span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>Change a as integer type, the loop induction is controlable.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0129">Invariant condition</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The result of the conditional expression used to control the program flow is always true or false.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When a conditional expression used to control a program flow is a constant, part of the branch path of the code is never executed, and the conditional expression becomes meaningless. When the result of the conditional expression used to control the loop is always true, it may cause the program to do an infinite loop.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Eliminate the case where the conditional expression result is always true or false.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span> <span class="p">()</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1">//The conditional expression "a &gt; 0" used to control </span>
               <span class="c1">//the program flow is always true</span>
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>  
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.13 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0018">Com Addrof Leak</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#memory-leak">memory leak</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>A CComBSTR or CComPtr instance that might cause memory leaks because the value of the pointer that is internal to the instance can be modified through the pointer address.</p>
<p>Local non-static CComBSTR and CComPtr variables that have been determined as managing a non-null pointer. When the address of the pointer (obtained through the overloaded operator address-of (&amp;)) is passed as an argument to a function call, the pointer value can potentially be overwritten, causing a memory leak.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="memory-leak">memory leak</h4>
<p>Local non-static CComBSTR and CComPtr variables that have been determined as managing a non-null pointer. When the address of the pointer (obtained through the overloaded operator address-of (&amp;)) is passed as an argument to a function call, the pointer value can potentially be overwritten, causing a memory leak.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>High</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not pass the address of the CComBSTR or CComPtr pointer to a function call as an argument.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">Base</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="c1">// \pName is a pointer</span>
  <span class="kt">void</span> <span class="n">getName</span><span class="p">(</span><span class="n">BSTR</span> <span class="o">*</span><span class="n">pName</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> 
    <span class="o">*</span><span class="n">pName</span> <span class="o">=</span> <span class="o">::</span><span class="n">SysAllocString</span><span class="p">(</span><span class="n">name_</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">LPCOLESTR</span> <span class="n">name_</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">Release</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">};</span>

<span class="n">CComBSTR</span> <span class="nf">getBaseName</span><span class="p">(</span><span class="k">const</span> <span class="n">Base</span> <span class="o">&amp;</span><span class="n">base</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">CComBSTR</span> <span class="n">name</span><span class="p">;</span>
  <span class="n">name</span> <span class="o">=</span> <span class="sa">L</span><span class="s">"Lucky"</span><span class="p">;</span>
  <span class="n">base</span><span class="p">.</span><span class="n">getName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">name</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, The overloaded operator address-of (CComBSTR::operator &amp;) returns the address of the internal pointer and the value of the pointer is overwritten during the call to Base::getName(). The memory allocated during the construction of the object will never be deallocated and is therefore leaked.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">Base</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="c1">// \pName is a value</span>
  <span class="kt">void</span> <span class="n">getName</span><span class="p">(</span><span class="n">BSTR</span> <span class="n">pName</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
      <span class="n">pName</span> <span class="o">=</span> <span class="o">::</span><span class="n">SysAllocString</span><span class="p">(</span><span class="n">name_</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">LPCOLESTR</span> <span class="n">name_</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">Release</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">};</span>

<span class="n">CComBSTR</span> <span class="nf">getBaseName</span><span class="p">(</span><span class="k">const</span> <span class="n">Base</span> <span class="o">&amp;</span><span class="n">base</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">CComBSTR</span> <span class="n">name</span><span class="p">;</span>
  <span class="n">name</span> <span class="o">=</span> <span class="sa">L</span><span class="s">"Lucky"</span><span class="p">;</span>
  <span class="n">base</span><span class="p">.</span><span class="n">getName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, pass the CComBSTR or CComPtr pointer to a function call as an argument at line 14.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1053">Clarify operation precedence</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                <p>Summary：The computational expression is not clearly expressed, so there are many ways to understand the same expression</p>

<h1 id="description">Description</h1>
<p>The expression of the calculation expression is not clear, so that the same expression has multiple ways to understand. For example, 'a+b?c:d' might be intended to express (a+b)?c:d or a+(b?c:d). When an
'if' statement is terminated early by a semicolon, the 'then' statement will be executed forever, thus changing the logic of the 'if' statement. When loop statements such as 'while', 'for', etc. are terminated early by a semicolon, they may cause an infinite loop or the loop body part to be executed only once.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>If the expression is not properly understood, or the program execution logic is different from the original intention, the entire program will run out of the intended trajectory, even forming a dead loop and causing the program to crash.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>For expressions, using parentheses to indicate the operation steps. For judging and looping statements, note where the semicolon is.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>medium</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#define FAIL 0</span>
<span class="cp">#define SUCCESS 1</span>
<span class="p">...</span>
<span class="kt">int</span> <span class="n">validateUser</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">username</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">password</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">isUser</span> <span class="o">=</span> <span class="n">FAIL</span><span class="p">;</span>
  <span class="c1">// call method to authenticate username and password</span>
  <span class="c1">// if authentication fails then return failure otherwise return success</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">isUser</span> <span class="o">=</span> <span class="n">AuthenticateUser</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="o">==</span> <span class="n">FAIL</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//detect</span>
    <span class="k">return</span> <span class="n">isUser</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">isUser</span> <span class="o">=</span> <span class="n">SUCCESS</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">isUser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In this case, the priority of "==" is higher than "=", so for the judgment statement, the 'AuthenticateUser(username, password) == FAIL' comparison is performed first, and then the 'isUser' is assigned a value, resulting in an overall program logic error.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#define FAIL 0</span>
<span class="cp">#define SUCCESS 1</span>
<span class="p">...</span>
<span class="kt">int</span> <span class="n">validateUser</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">username</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">password</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">isUser</span> <span class="o">=</span> <span class="n">FAIL</span><span class="p">;</span>
  <span class="c1">// call method to authenticate username and password</span>
  <span class="c1">// if authentication fails then return failure otherwise return success</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">isUser</span> <span class="o">=</span> <span class="n">AuthenticateUser</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span> <span class="o">==</span> <span class="n">FAIL</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">isUser</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">isUser</span> <span class="o">=</span> <span class="n">SUCCESS</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">isUser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, we only need to add the parentheses and then perform the comparison operation.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0008">Function Address Comparison</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#logical-error">logical error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Many cases in which a comparison operator or function is misused. Typically, the behavior of the program is not what the programmer intended because the comparison often produces a fixed result. For example, many cases where a function is implicitly converted to its address and then compared with 0. Because function addresses are never 0, such comparisons always have a fixed result.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="logical-error">logical error</h4>
<p>Compare function's address with 0 always lead to a fixed result, which is not what the programmer intended.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Compare function's return value with 0.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">malloc</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* bad */</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, A comparison of a function's address to 0 occurred at line 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">malloc</span><span class="p">(</span><span class="n">len</span><span class="p">))</span> <span class="p">{</span> <span class="cm">/* good */</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, compare a function's return value to 0 at line 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1041">Redundant operation in switch</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#bad-example">bad Example</a></li>
<li><a href="#good-example">good Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Suspicious case label in switch(), Redundant bitwise operation in switch.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>中</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="bad-example">bad Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span>   <span class="k">switch</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
          <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>        <span class="c1">// &lt;- this assignment is redundant</span>
         <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
          <span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>        <span class="c1">// &lt;- case 2 falls through and sets y twice</span>
     <span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In this case，case 2 set value y twice.</p>
<h3 id="good-example">good Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">switch</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
       <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span><span class="k">break</span><span class="p">;</span>        
      <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
       <span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span><span class="k">break</span><span class="p">;</span>        
  <span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In this case，case 2 set y value 2 then jump out of the switch。</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-sourceforge">
<p>http://cppcheck.sourceforge.net/devinfo/doxyoutput/checkother_8cpp_source.html#l00732 <a class="footnote-backref" href="#fnref-sourceforge" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0020">Bad Evaluation Order</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#side-effect">Side Effect</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>If a single memory location is written more than once, or both read and written, without an intervening sequence point, then the program behavior is undefined. In practice, implementations may behave differently depending on compiler, compiler version, and optimization settings. This occurs even though the rules of precedence and associativity unambiguously define the syntactic expression structure.</p>
<p>In the following example, the value of b after the assignment is 3 if the left side of the operator is evaluated first, or 4 if the right side of the operator is evaluated first:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="side-effect">Side Effect</h4>
<p>Expression evaluation do not determine the order in which side effects happen.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Ensure that the expression has no side effects.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">++</span><span class="p">;</span> 
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example,  The right hand side of the assignment at line 3 is evaluated before the assignment itself takes place. However, the side effect order is unspecified because the side effect associated with ++ could happen before or after the side effect associated with the assignment.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">x</span><span class="o">++</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example,  the return value x is 1 at line 4.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0110">Condition body is null</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the conditional discrimination is established, the corresponding branch has no execution statement.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>This is usually not the intention of the program. It may be due to negligence and the statement is omitted. It may cause a program error or incorrect program function.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>The corresponding branch cannot be empty when the conditional discrimination is established.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">//When the conditional discrimination is established, the </span>
    <span class="c1">//corresponding branch has no execution statement.</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">a</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.10 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0109">Bad operation for BSTR</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Perform address operations on variables of type BSTR.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Address operations on variables of type BSTR may result in erroneous memory access.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Perform address operations on variables of type BSTR.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">BSTR</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="n">a</span><span class="o">++</span><span class="p">;</span>  <span class="c1">//Perform address operations on variables of type BSTR.</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.3.6 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0115">Inconsistent enumerator as case</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Multiple enumerator type are used in the same "switch" statement or in the "switch" tag statement, causing case tags to be inconsistent.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Inconsistent enumerator as case are usually caused by typing errors and may result in incorrect program functionality.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>低</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>If the variable type in the switch condition is an enumerated type, the case label should be an enumeration member of the enumerated type.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">enum</span> <span class="n">A</span><span class="p">{</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">}</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">B</span><span class="p">{</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">}</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="k">case</span> <span class="nl">b1</span><span class="p">:</span> <span class="p">...;</span> <span class="k">break</span><span class="p">;</span>  <span class="c1">//Inconsistent case label</span>
    <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">enum</span> <span class="n">A</span><span class="p">{</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">}</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">B</span><span class="p">{</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">}</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="k">case</span> <span class="nl">a1</span><span class="p">:</span> <span class="p">...;</span> <span class="k">break</span><span class="p">;</span> 
    <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.13 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0124">Self comparison or division</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Self comparison or division.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Dividing or comparing itself is usually not the intention of the program. There may be typing errors in the program. Dividing itself may cause program errors or incorrect program functions. Self-comparison may cause some code never be executed.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Fix typing error.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">)</span>   <span class="c1">//a&lt;a is always false</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.11 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0105">Assignment in argument</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Assignment in argument.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The order of evaluation in the C standard is not defined, so using syntax shortcuts when porting on different compilers may have operational implications. This assignment does not always occur before the function call, and will produce different results on different platforms.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assignment in argument.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun1</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">example_fun2</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">example_fun1</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>  <span class="c1">//Assignment in argument</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun1</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">example_fun2</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">example_fun1</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> 
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.4  <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0127">swapped arguments</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the function is called, the order of the actual participating parameters is inconsistent.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When the function is called, the inconsistent order of the actual participating parameters will cause the program function to be implemented incorrectly.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When the function is called, the order of the actual participating parameters is the same.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">authenticate</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">username</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span> 
<span class="p">{</span> 
  <span class="c1">// Verify the correctness of the username and password</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">exampleFun</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">bool</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">username</span><span class="p">);</span>  <span class="c1">//The order of the actual                       //participation parameters passed is inconsistent. </span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">authenticate</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">username</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span> 
<span class="p">{</span> 
  <span class="c1">// Verify the correctness of the username and password</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">exampleFun</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">bool</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.4.5 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0046">Negative Returns</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#program-crashes">program crashes</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Negative integers and function return values that can potentially be negative must be checked before being used (for example, as array indexes, loop bounds, algebraic expression variables or size/length arguments to a system call). Negative integer misuses can cause memory corruption, process crashes, infinite loops, integer overflows, and security defects (if a user is able to control improperly checked input).
Common negative integer misuses include:</p>
<ul>
<li>Assigning a negative value to a signed integer variable before using it as a static array index.</li>
<li>Using a negative function return value either directly or by casting it to an unsigned integer.</li>
</ul>
<p>A signed, negative integer implicitly cast to an unsigned integer will yield a very large value. If that value is incorrectly bounds-checked before being used, a process can, for example, allocate too much memory, allow a loop to process too long, overrun and corrupt memory, or yield an integer overflow. These defects are inherently hard to detect because their repercussions may not immediately appear during process execution.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="program-crashes">program crashes</h4>
<p>Negative integer misuses can cause memory corruption, process crashes, infinite loops, integer overflows, and security defects (if a user is able to control improperly checked input).</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Negative integers and function return values that can potentially be negative must be checked before being used.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">some_function</span><span class="p">();</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">buff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">some_function</span><span class="p">();</span> <span class="c1">// some_function() might return -1</span>
  <span class="n">buff</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Defect: buffer underrun at buff[-1]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, some_function() might return negative integer when it is used as array index.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">some_function</span><span class="p">();</span>

<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">buff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">some_function</span><span class="p">();</span> <span class="c1">// some_function() might return -1</span>
  <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">buff</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, the return value of function some_function() is checked before being used.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0013">Missing Copy Or Assign</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#wild-pointer">wild pointer</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Own resources such as dynamically allocated memory or operating system handles but lack either a user-written copy constructor or a user-written assignment operator.</p>
<p>A class is considered to own resources if at least one constructor allocates resources and retains them in fields of this and the destructor releases resources from fields of this. Not only must such a class have a copy constructor and an assignment operator but those functions must manage the resources.</p>
<p>In order to be considered as an assignment operator for the purposes of this rule  an assignment operator must be usable to assign entire objects. Private copy constructors or assignment operators are assumed not to be meant for use and are not required to manage resources.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="wild-pointer">wild pointer</h4>
<p>Own resources such as dynamically allocated memory or operating system handles but lack either a user-written copy constructor or a user-written assignment operator will lead to wild pointer.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Provide a user-written copy constructor or a user-written assignment operator if the class own resources such as dynamically allocated memory or operating system handles.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">bad</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>
  <span class="n">bad</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="o">:</span> <span class="n">p</span><span class="p">(</span><span class="n">_strdup</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="p">{}</span>
  <span class="o">~</span><span class="n">bad</span><span class="p">()</span> <span class="p">{</span> <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="p">}</span>

  <span class="c1">// no copy constructor at all</span>
  <span class="c1">// no assignment operator at all</span>
  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">p</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">operator</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">str</span><span class="p">();</span> <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example  Class bad owns resources has no user-written copy constructor or user-written assignment operator. The compiler-generated copy constructor or assignment operator does not properly manage owned resources.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">good</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>
  <span class="c1">// copy constructor</span>
  <span class="n">good</span><span class="p">(</span><span class="k">const</span> <span class="n">good</span> <span class="o">&amp;</span><span class="n">init</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">){</span>
      <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">init</span><span class="p">.</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">init</span><span class="p">.</span><span class="n">p</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// assignment operator</span>
  <span class="n">good</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">good</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">!=</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">){</span>
        <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">rhs</span><span class="p">.</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
      <span class="n">strcpy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">rhs</span><span class="p">.</span><span class="n">p</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="o">~</span><span class="n">good</span><span class="p">()</span> <span class="p">{</span> <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">p</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">operator</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">str</span><span class="p">();</span> <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example  provide a user-written copy constructor or a user-written assignment operator.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/c.html">c/c++</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0009">Char I/O Return Error</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#truncate-value-error">truncate value error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Functions fgetc(), getc(), getchar(), and istream::get(), which return int values, not char values. Assigning an int value to a char variable truncates the value. If the char variable is unsigned, the loworder 8 bits of the int value are not put into the char variable, which is a modulo operation if the int value is non-negative. If the int value is -1, the low-order 8 bits of the representation of -1 are put into the char variable, which results in a value of 255. If the char variable is signed, an int value of -1 remains -1 in the char variable, but any int value greater than 127 becomes a negative value in the char variable. Using a signed char variable is also unsafe. A stray ӱ character (0xFF) will cause the program to erroneously think that EOF is reached. The C standard requires that such functions be passed an integer in the range of -1 to 255. A signed char variable can potentially have values as low as -128.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="truncate-value-error">truncate value error</h4>
<p>Assigning an int value to a char variable truncates the value.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assigning the return value of functions fgetc(), getc(), getchar(), and istream::get() to a int value.  </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">getc</span><span class="p">(</span><span class="n">stdin</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, returns an int value to variable c, which is a char value at line 3.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="n">i</span> <span class="o">=</span> <span class="n">getc</span><span class="p">(</span><span class="n">stdin</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, returns an int value to variable i, which is a int value at line 3.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Rights reserve
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>