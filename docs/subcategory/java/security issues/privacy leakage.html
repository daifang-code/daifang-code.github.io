
<!DOCTYPE html>
<html lang="en">

<head>
    <link href='../../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../../theme/stylesheet/normalize.min.css">
    <script src="../../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../../..">
                <img src="../../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="Input to search">
            </form>
        </div>


        <ul class="global_lang">
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../../standard/language-independent.html">Language Independent documents</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../../standard/c.html">c/c++ documents</a>
                        (317)
                    </li>
                    <li>
                        <a href="../../../standard/csharp.html">csharp documents</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../../standard/golang.html">golang documents</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../../standard/java.html">java documents</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../../standard/javascript.html">javascript documents</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../../standard/objective-c.html">objective-c documents</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../../standard/python.html">python documents</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../../standard/shell.html">shell documents</a>
                        (334)
                    </li>
                    <li>
                        <a href="../../../standard/swift.html">swift documents</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            Privacy leakage (11)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0099">Sensitive data passing into unsafe API</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Black Hole Vulnerability</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Critical</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">c</a>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1081">Privacy Violation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software does not properly prevent private data (such as credit card numbers) from being accessed by actors who either (1) are not explicitly authorized to access the data or (2) do not have the implicit consent of the people to which the data is related.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Mishandling private information, such as customer passwords or Social Security numbers, can compromise user privacy and is often illegal. An exposure of private information does not necessarily prevent the software from working properly, and in fact it might be intended by the developer, but it can still be undesirable (or explicitly prohibited by law) for the people who are associated with this private information.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This code uses location to determine the user's current US State location.</p>
<p>First the application must declare that it requires the ACCESS_FINE_LOCATION permission in the application's manifest.xml:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.ACCESS_FINE_LOCATION"</span><span class="nt">/&gt;</span>
</pre></div>
</td></tr></table>
<p>During execution, a call to getLastLocation() will return a location based on the application's location permissions. In this case the application has permission for the most accurate location possible:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">locationClient</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LocationClient</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
<span class="n">locationClient</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
<span class="n">Location</span> <span class="n">userCurrLocation</span><span class="o">;</span>
<span class="n">userCurrLocation</span> <span class="o">=</span> <span class="n">locationClient</span><span class="o">.</span><span class="na">getLastLocation</span><span class="o">();</span>
<span class="n">deriveStateFromCoords</span><span class="o">(</span><span class="n">userCurrLocation</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>While the application needs this information, it does not need to use the ACCESS_FINE_LOCATION permission, as the ACCESS_COARSE_LOCATION permission will be sufficient to identify which US state the user is in.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/359.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7488">Potentially sensitive data in a cookie</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potentially sensitive data in a cookie</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The information stored in a custom cookie should not be sensitive or related to the session. In most cases, sensitive data should only be stored in session
and referenced by the user's session cookie. See HttpSession (HttpServletRequest.getSession())</p>
<p>Custom cookies can be used for information that needs to live longer than and is independent of a specific session.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/315.html">CWE-315: Cleartext Storage of Sensitive Information in a Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1114">Dangerous standard library functions</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and Risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Some standard library function was designed without foreseeing some security vulnerability, you should use the listed standard library functions with caution, or totally refuse to use them.</p>
<p>The vulnerable standard library functions:</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Risk</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>gets</td>
<td>Critical</td>
<td>Do not use gets(buf), use fgets(buf, size, stdin) instead</td>
</tr>
<tr>
<td>strcpy</td>
<td>High</td>
<td>Check the buffer size first, or use strncpy, or allocate buffer dynamically</td>
</tr>
<tr>
<td>strcat</td>
<td>High</td>
<td>Use strncat instead</td>
</tr>
<tr>
<td>sprintf</td>
<td>High</td>
<td>Use snprintf, or specify the precision</td>
</tr>
<tr>
<td>scanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>sscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>fscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>vfscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>vsprintf</td>
<td>High</td>
<td>Use vsnprintf, or specify the precision</td>
</tr>
<tr>
<td>vscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>vsscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>streadd</td>
<td>High</td>
<td>Make sure the allocated target buffer is four times as big as the source buffer</td>
</tr>
<tr>
<td>strecpy</td>
<td>High</td>
<td>Make sure the allocated target buffer is four times as big as the source buffer</td>
</tr>
<tr>
<td>strtrns</td>
<td>High</td>
<td>Check if the target buffer can hold the source string</td>
</tr>
<tr>
<td>getenv</td>
<td>High</td>
<td>Do not assume the envvar is of limited length</td>
</tr>
<tr>
<td>realpath</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Allocate the buffer with size PATH_MAX and manually check either input argument or output argument is within PATH_MAX</td>
</tr>
<tr>
<td>syslog</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getopt</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getopt_long</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getpass</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getchar</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>fgetc</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>getc</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>read</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>bcopy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>fgets</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>memcpy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>snprintf</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>strccpy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>strcadd</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>strncpy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>vsnprintf</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
</tbody>
</table>
<h1 id="vulnerability-and-risk">Vulnerability and Risk</h1>
<p>It may cause buffer overflow problem.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>High</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>use the listed standard library functions with caution, or totally refuse to use them.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>void BadFunc(char *src)
{
    char *dst = new char[5];
    strcpy(dst, src);
    ...
}
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span>void GoodFunc(char *src, size_t srcLen)
{
    char *dst = new char[5];
    if(srcLen &lt; 5)
    {
        strcpy(dst, src);
    }
    ...
}
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1101">File Disclosure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Files or directories are accessible in the environment that should not be.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>If some sensitive file is accessible to attackers, they may follow them along and find out more opportunities of other types of attack.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
</li>
<li>
<p>Understand all the potential areas where untrusted inputs can enter your software.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following code doesn't validate untrusted user input to build a path for forwarding:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">&lt;%</span> <span class="n">String</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"retUrl"</span><span class="o">);</span> <span class="k">%&gt;</span>
<span class="k">&lt;jsp:include page="&lt;%ret%&gt;</span>;" /&gt;
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/552.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0087">Leaking Sensitive Data</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 4 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a></li>
<li><a href="#fixed-code-example-1">Fixed Code Example 1</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable code Example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed code Example 2</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Logging is essential for debugging, incident response, and collecting forensic evidence. Nevertheless, logging sensitive data raises many concerns, including the privacy of the stakeholders, limitations imposed by the law on the collection of personal information, and the potential for data exposure by insiders. Sensitive information includes, but is not limited to, IP addresses, user names and passwords, email addresses, credit card numbers, and any personally identifiable information such as social security numbers. Many countries prohibit or restrict collection of personal data; others permit retention of personal data only when held in an anonymized form. For example, leaking unencrypted credit card numbers into a log file could be a violation of PCI DSS (Payment Card Industry Data Security Standard) regulations [PCI 2010]. Consequently, logs must not contain sensitive data, particularly when prohibited by law.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Unfortunately, violations of this rule are common. For example, prior to version 0.8.1, the LineControl Java client logged sensitive information, including the local user's password, as documented by CVE-2005-2990.</p>
<p>The java.util.logging class provides a basic logging framework for JDK versions 1.4 and higher. Other logging frameworks exist, but the basic principles apply regardless of the particular logging framework chosen.</p>
<p>Programs typically support varying levels of protection. Some information, such as access times, can be safely logged. Some information can be logged, but the log file must be restricted from everyone but particular administrators. Other information, such as credit card numbers, can be included in logs only in encrypted form. Information such as passwords should not be logged at all.</p>
<p>For the following code examples, the log lies outside the trust boundary of the information being recorded. Also, normal log messages should include additional parameters such as date, time, source event, and so forth. This information has been omitted from the following code examples for brevity. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Encrypt the data with a reliable encryption scheme before transmitting.</p>
<p>When using web applications with SSL, use SSL for the entire session from login to logout, not just for the initial login page.</p>
<p>Use tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session. These may be more effective than strictly automated techniques. This is especially the case with weaknesses that are related to design and business rules.</p>
<p>Configure servers to use encrypted channels for communication, which may include SSL or other secure protocols. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<p>In this noncompliant code example, a server logs the IP address of the remote client in the event of a security exception. This data can be misused, for example, to build a profile of a user's browsing habits. Such logging may violate legal restrictions in many countries.</p>
<p>When the log cannot contain IP addresses, it should not contain any information about a SecurityException, because it might leak an IP address. When an exception contains sensitive information, the custom MyExceptionReporter class should extract or cleanse it before returning control to the next statement in the catch block (see ERR00-J. Do not suppress or ignore checked exceptions).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">logRemoteIPAddress</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"com.organization.Log"</span><span class="o">);</span>
  <span class="n">InetAddress</span> <span class="n">machine</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="n">machine</span> <span class="o">=</span> <span class="n">InetAddress</span><span class="o">.</span><span class="na">getByName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnknownHostException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Exception</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyExceptionReporter</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Exception</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyExceptionReporter</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">machine</span><span class="o">.</span><span class="na">getHostAddress</span><span class="o">()</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span>
                  <span class="n">e</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-1">Fixed Code Example 1</h3>
<p>This compliant solution does not log security exceptions except for the logging implicitly performed by MyExceptionReporter:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="k">catch</span> <span class="o">(</span><span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">Exception</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyExceptionReporter</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable code Example 2</h3>
<p>Log messages with sensitive information should not be printed to the console display for security reasons (a possible example of sensitive information is passenger age). The java.util.logging.Logger class supports different logging levels that can be used for classifying such information: FINEST, FINER, FINE, CONFIG, INFO, WARNING, and SEVERE. By default, the INFO, WARNING, and SEVERE levels print the message to the console, which is accessible by end users and system administrators.
If we assume that the passenger age can appear in log files on the current system but not on the console display, this code example is noncompliant.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Age: "</span> <span class="o">+</span> <span class="n">passengerAge</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-2">Fixed code Example 2</h3>
<p>This compliant solution logs the passenger age at the FINEST level to prevent this information from displaying on the console. As noted previously, we are assuming the age may appear in system log files but not on the console.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Make sure that all handlers only print log messages rated INFO or higher</span>
<span class="n">Handler</span> <span class="n">handlers</span><span class="o">[]</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="na">getHandlers</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">handlers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">handlers</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">setLevel</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">// ...</span>
<span class="n">logger</span><span class="o">.</span><span class="na">finest</span><span class="o">(</span><span class="s">"Age: "</span> <span class="o">+</span> <span class="n">passengerAge</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/319.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT">
<p>https://wiki.sei.cmu.edu/confluence/display/java/FIO13-J.+Do+not+log+sensitive+information+outside+a+trust+boundary.html <a class="footnote-backref" href="#fnref-CERT" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/c.html">C++</a>
                <a href="../../../tag/java.html">Java</a>
                <a href="../../../tag/cwe-319.html">CWE-319</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1112">Hardcoded Password</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable Code Example 2</a></li>
<li><a href="#vulnerable-code-example-3">Vulnerable Code Example 3</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software contains a hard-coded password, which it uses for its own inbound authentication or for outbound communication to external components.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>A hard-coded password typically leads to a significant authentication failure that can be difficult for the system administrator to detect. Once detected, it can be difficult to fix, so the administrator may be forced into disabling the product entirely. There are two main variations:</p>
<ul>
<li>Inbound: the software contains an authentication mechanism that checks for a hard-coded password.</li>
<li>Outbound: the software connects to another system or component, and it contains hard-coded password for connecting to that component.</li>
</ul>
<p>In the Inbound variant, a default administration account is created, and a simple password is hard-coded into the product and associated with that account. This hard-coded password is the same for each installation of the product, and it usually cannot be changed or disabled by system administrators without manually modifying the program, or otherwise patching the software. If the password is ever discovered or published (a common occurrence on the Internet), then anybody with knowledge of this password can access the product. Finally, since all installations of the software will have the same password, even across different organizations, this enables massive attacks such as worms to take place.</p>
<p>The Outbound variant applies to front-end systems that authenticate with a back-end service. The back-end service may require a fixed password which can be easily discovered. The programmer may simply hard-code those back-end credentials into the front-end software. Any user of that program may be able to extract the password. Client-side systems with hard-coded passwords pose even more of a threat, since the extraction of a password from a binary is usually very simple.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>For outbound authentication: store passwords outside of the code in a strongly-protected, encrypted configuration file or database that is protected from access by all outsiders, including other local users on the same system.</li>
<li>For inbound authentication: Rather than hard-code a default username and password for first time logins, utilize a "first login" mode that requires the user to enter a unique strong password.</li>
<li>For inbound authentication: apply strong one-way hashes to your passwords and store those hashes in a configuration file or database with appropriate access control.</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following code uses a hard-coded password to connect to a database:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"scott"</span><span class="o">,</span> <span class="s">"tiger"</span><span class="o">);</span>
<span class="o">...</span>
</pre></div>
</td></tr></table>
<p>This is an example of an external hard-coded password on the client-side of a connection. This code will run successfully, but anyone who has access to it will have access to the password. Once the program has shipped, there is no going back from the database user "scott" with a password of "tiger" unless the program is patched. A devious employee with access to this information can use it to break into the system. Even worse, if attackers have access to the bytecode for application, they can use the javap -c command to access the disassembled code, which will contain the values of the passwords used. The result of this operation might look something like the following for the example above:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">javap</span> <span class="nt">-c</span> <span class="nt">ConnMngr</span><span class="p">.</span><span class="nc">class</span>
<span class="nt">22</span><span class="o">:</span> <span class="nt">ldc</span> <span class="p">#</span><span class="nn">36</span><span class="o">;</span> <span class="o">//</span><span class="nt">String</span> <span class="nt">jdbc</span><span class="p">:</span><span class="nd">mysql</span><span class="o">://</span><span class="nt">ixne</span><span class="p">.</span><span class="nc">com</span><span class="o">/</span><span class="nt">rxsql</span>
<span class="nt">24</span><span class="o">:</span> <span class="nt">ldc</span> <span class="p">#</span><span class="nn">38</span><span class="o">;</span> <span class="o">//</span><span class="nt">String</span> <span class="nt">scott</span>
<span class="nt">26</span><span class="o">:</span> <span class="nt">ldc</span> <span class="p">#</span><span class="nn">17</span><span class="o">;</span> <span class="o">//</span><span class="nt">String</span> <span class="nt">tiger</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable Code Example 2</h3>
<p>The following code is an example of an internal hard-coded password in the back-end:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">VerifyAdmin</span><span class="o">(</span><span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
<span class="k">if</span> <span class="o">(!</span><span class="n">password</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Mew!"</span><span class="o">))</span> <span class="o">{</span>
<span class="k">return</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<span class="o">}</span>
<span class="c1">//Diagnostic Mode</span>
<span class="k">return</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Every instance of this program can be placed into diagnostic mode with the same password. Even worse is the fact that if this program is distributed as a binary-only distribution, it is very difficult to change that password or disable this "functionality."</p>
<h3 id="vulnerable-code-example-3">Vulnerable Code Example 3</h3>
<p>This Java example shows a properties file with a plaintext username / password pair.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="err">#</span> <span class="n">Java</span> <span class="n">Web</span> <span class="n">App</span> <span class="n">ResourceBundle</span> <span class="n">properties</span> <span class="n">file</span> 
<span class="o">...</span>
<span class="n">webapp</span><span class="o">.</span><span class="na">ldap</span><span class="o">.</span><span class="na">username</span><span class="o">=</span><span class="n">secretUsername</span>
<span class="n">webapp</span><span class="o">.</span><span class="na">ldap</span><span class="o">.</span><span class="na">password</span><span class="o">=</span><span class="n">secretPassword</span>
<span class="o">...</span>
</pre></div>
</td></tr></table>
<p>Username and password information should not be included in a configuration file or a properties file in plaintext as this will allow anyone who can read the file access to the resource. If possible, encrypt this information and avoid <a href="http://cwe.mitre.org/data/definitions/260.html">CWE-260</a> and <a href="http://cwe.mitre.org/data/definitions/13.html">CWE-13</a>.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/259.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0134">Exposes Session IDs in the URL</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixing-suggestion">Fixing Suggestion</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>If the browser does not support cookies or the user blocks all cookies, the session ID can be appended to all URLs in the HTML page and these pages are sent to the client in response. In this way, when the user clicks on the URL, the session ID is automatically sent back to the server as part of the request line, not as a header line. This method is called URL rewriting.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>With URL rewriting, the session ID in the URL is exposed to the attacker, so that an attacker can enter the system without authentication and obtain sensitive data of the system.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not use URL rewriting or use HTTP POST method instead of directly using URL.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">encodeRedirectURL</span><span class="o">(</span><span class="s">"dfddf.jsp?ID=admin"</span><span class="o">));</span> 
</pre></div>
</td></tr></table>
<p>The session ID admin is exposed through the URL.</p>
<h3 id="fixing-suggestion">Fixing Suggestion</h3>
<p>Use HTTP POST method instead of directly using URL.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CEW264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CEW264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A2">
<p>https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication <a class="footnote-backref" href="#fnref-OWASP-A2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7389">Class extends Struts Action class and uses instance variables</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Class extends Struts Action class and uses instance variables</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    This class extends from a Struts Action class, and uses an instance member variable. Since only
    one instance of a struts Action class is created by the Struts framework, and used in a
    multithreaded way, this paradigm is highly discouraged and most likely problematic. Consider
    only using method local variables. Only instance fields that are written outside of a monitor
    are reported.
    </p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7390">Class extends Servlet class and uses instance variables</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Class extends Servlet class and uses instance variables</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    This class extends from a Servlet class, and uses an instance member variable. Since only
    one instance of a Servlet class is created by the J2EE framework, and used in a
    multithreaded way, this paradigm is highly discouraged and most likely problematic. Consider
    only using method local variables.
    </p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0136">Reveal stack traces</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The application server’s configuration allows detailed error messages, e.g. stack traces, to be returned to users. This potentially exposes sensitive information or underlying flaws such as component versions that are known to be vulnerable.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Such flaws frequently give attackers unauthorized access to some system data or functionality. Occasionally, such flaws result in a complete system compromise.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not reveal stack traces.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
  <span class="k">try</span><span class="o">{</span>
    <span class="o">...</span>
    <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"lavasoft"</span><span class="o">);</span>  
      <span class="n">log</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">,</span> <span class="s">"dfsf"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">finally</span><span class="o">{</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>The exception message e is exposed in the log.</p>
<h3 id="fixed-code-example">Fixed code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
  <span class="k">try</span><span class="o">{</span>
    <span class="o">...</span>
    <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"lavasoft"</span><span class="o">);</span>  
      <span class="n">log</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">,</span> <span class="s">"dfsf"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">finally</span><span class="o">{</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Remove the exception message e.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE">
<p>https://cwe.mitre.org/data/definitions/200.html <a class="footnote-backref" href="#fnref-CWE" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Rights reserve
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>