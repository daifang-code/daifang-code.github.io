
<!DOCTYPE html>
<html lang="en">

<head>
    <link href='../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../theme/stylesheet/normalize.min.css">
    <script src="../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../..">
                <img src="../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="Input to search">
            </form>
        </div>


        <ul class="global_lang">
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../standard/language-independent.html">Language Independent documents</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../standard/c.html">c/c++ documents</a>
                        (317)
                    </li>
                    <li>
                        <a href="../../standard/csharp.html">csharp documents</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../standard/golang.html">golang documents</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../standard/java.html">java documents</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../standard/javascript.html">javascript documents</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c documents</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../standard/python.html">python documents</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../standard/shell.html">shell documents</a>
                        (334)
                    </li>
                    <li>
                        <a href="../../standard/swift.html">swift documents</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            Quality issues (84)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0048">Copy Paste Error</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-behaviour">Unexpected Behaviour</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>A section of code was copied and pasted, and a systematic change was made to the copy. However, because that change was incomplete, it unintentionally left some portions of the copy unchanged.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-behaviour">Unexpected Behaviour</h4>
<p>Because that change was incomplete, it unintentionally left some portions of the copy unchanged.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Check the logic of codes.   </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CopyPasteBad</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">square</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span>

  <span class="kt">int</span> <span class="n">example</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// "square(a)" should read "square(b)"</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the second instance of a should be replaced with b at line 11.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CopyPasteGood</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">square</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span>

  <span class="kt">int</span> <span class="n">example</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, using correct way to copy and paste code.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0052">boolean Assignment</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#portability-error">portability error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The boolean data type (bool) is intended to hold the values 1 (true) or 0 (false), but it can be forced to rely on ANSI typing rules, which are very flexible and allow boolean types to be treated as integer types. This can cause problems when porting between compilers with differing levels of flexibility, so this checker enforces a 1-byte allocation maximum for any boolean data type.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="portability-error">portability error</h4>
<p>Assignment to a bool type larger than 1 byte can cause problems when porting between compilers with differing levels of flexibility.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Don't interchange boolean data with other integer-type data. The C++ standard defines boolean keywords "true" and "false" to represent integer values 1 and 0, respectively. In addition, many compilers define TRUE and FALSE macros or suitable placeholders, or you can define your own values.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">char</span> <span class="n">BOOL</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">BOOL</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, assignment 256 to a bool type variable.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">char</span> <span class="n">BOOL</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">BOOL</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, assignment true to a bool type variable.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0011">Enum As Boolean</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>An enum-typed expression is inadvertently used in a boolean context, such as a predicate. This will lead to undefined behavior. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>An enum-typed expression is inadvertently used in a boolean context, such as a predicate. This will lead to undefined behavior. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not use an enum-typed expression in a boolean context.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="n">color</span> <span class="p">{</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span> <span class="p">};</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">green</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="c1">// detect</span>
  <span class="p">{</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">red</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, using an enum-typed variable c as a predicate at line 6.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">enum</span> <span class="n">color</span> <span class="p">{</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span> <span class="p">};</span>

<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">green</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">green</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">red</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, using a boolean context as a predicate at line 6.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0067">Dead Store</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#invalid-code">Invalid code</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The assignment is not used until the next assignment or the end of the function, so such assignment or initialization is actually invalid. Such code may introduce logic errors.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="invalid-code">Invalid code</h4>
<p>The assignment is not used until the next assignment or the end of the function, so such assignment or initialization is actually invalid.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Remove invalid code.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// Value stored to x is never read.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the <code>x = 20</code> is a dead store.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The above example remove the invalid code.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1011">Beware of zero-length allocations</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#vulnerable-code-fixed-example">Vulnerable code fixed Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the requested size is 0, the behavior of the memory allocation functions malloc(), calloc(), and realloc() is implementation-defined.Subclause 7.22.3 of the C Standard [ISO/IEC 9899:2011] states:  </p>
<ul>
<li>If the size of the space requested is zero, the behavior is implementation-defined: either a null pointer is returned, or the behavior is as if the size were some nonzero value, except that the returned pointer shall not be used to access an object.</li>
</ul>
<p>In addition, the amount of storage allocated by a successful call to the allocation function when 0 bytes was requested is unspecified.</p>
<p>In cases where the memory allocation functions return a non-null pointer, reading from or writing to the allocated memory area results in undefined behavior. Typically, the pointer refers to a zero-length block of memory consisting entirely of control structures. Overwriting these control structures damages the data structures used by the memory manager.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Allocating 0 bytes can lead to abnormal program termination.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Beware of zero-length allocations</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>High</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// expected-warning {{Use of zero-allocated memory}}</span>
  <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="vulnerable-code-fixed-example">Vulnerable code fixed Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
  <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
  <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/c/MEM04-C.+Beware+of+zero-length+allocations.html <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0023">Missing Break</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unpredictable-behavior">unpredictable behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Missing break statements at the end of a block of code for a case or default statement. A missing break statement can lead to incorrect or unpredictable behavior.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unpredictable-behavior">unpredictable behavior</h4>
<p>A missing break statement can lead to incorrect or unpredictable behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Add break statement at the end of a block of code for a case or default statement.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{}</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="c1">// Defect: Missing break statement in this case</span>
    <span class="n">foo</span><span class="p">();</span>
  <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, missing break statement in case 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{}</span>

<span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">what</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
        <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
    <span class="n">foo</span><span class="p">();</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, add break statement in case 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0028">Error Sleep</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-behavior">unexpected behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Until the blocking function is executed, locks aren't released and other threads may be blocked. These situations can result in unexpected behavior, so it's best to avoid calling blocking functions in critical section.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-behavior">unexpected behavior</h4>
<p>Until the blocking function is executed, locks aren't released and other threads may be blocked. These situations can result in unexpected behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Avoid calling blocking functions in critical section.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="n">pthread_mutex_t</span> <span class="o">*</span><span class="n">mutex</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="n">mutex</span><span class="p">);</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">30000</span><span class="p">);</span>       <span class="c1">// detect</span>
    <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="n">mutex</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the call to blocking function sleep occurs at line 5 when the mutex was locked at line 4.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="n">pthread_mutex_t</span> <span class="o">*</span><span class="n">mutex</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="n">mutex</span><span class="p">);</span>
    <span class="c1">//...</span>
    <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="n">mutex</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, remove calling functon sleep.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0077">Struct Padding</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#waste-of-resources">waste of resources</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Struct members are arranged according to their declared order in the program text. Fill characters may be used in the struct to ensure that the structure is properly aligned in memory. Struct padding is designed to facilitate quick access by members on multiple architectures.
If the members in the struct are not properly defined, it may cause excessive struct padding, resulting in wasted system memory.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="waste-of-resources">waste of resources</h4>
<p>If the members in the struct are not properly defined, it may cause excessive struct padding, resulting in wasted system memory.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Check the order in which members of the struct are placed, rearranging members of the struct to save unnecessary space.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">bad</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">c1</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the above code, because the members of the struct are not properly distributed, each member of the character type(char) takes up a separate int bit length, resulting in excessive struct padding.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">bad</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">c1</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the above code, the member definitions of two char types are connected, occupying an int bit length, which reduces the memory waste caused by excessive struct padding.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0071">Invalid Use of strncat</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#buffer-overflows">buffer overflows</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Prototype: <code>extern char *strncat(char *dest,char *src,int n)</code>
Parameter description: src is the source string, dest is the destination string, and n is the first n characters in the specified src.
Function: Add the first n characters of the string pointed to by src to the end of dest, and cover the '\0' at the end of dest to implement string concatenation.</p>
<p>The last argument to strncat() should not be the total length of the buffer, but rather the length of the buffer remaining after strncpy() is called. Both of these functions require the remaining length to be specified instead of the total length of the buffer. Since the remaining length changes every time data is added or deleted, the programmer must track these changes or recalculate the remaining length. This process is prone to errors and can cause buffer overflows.
The following call correctly calculates the remaining space before using the strncat() connection string:  </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">strncat</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span> <span class="o">-</span> <span class="n">strlen</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="buffer-overflows">buffer overflows</h4>
<p>Incorrectly calculating the value of n may cause the string spliced ​​to dest to exceed the memory size of dest, causing buffer overflow.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Correctly calculate the length you need to copy.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">dest</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="sc">'a'</span><span class="p">,</span> <span class="sc">'b'</span><span class="p">,</span> <span class="sc">'c'</span><span class="p">};</span>
  <span class="n">strncat</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="s">"AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
  <span class="c1">// expected-warning {{Potential buffer overflow.</span>
  <span class="c1">// Replace with 'sizeof(dest) - strlen(dest) - 1' or use a safer 'strlcat' API}} </span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the length calculated using sizeof(dest) - 1 exceeds the remaining length of dest, causing buffer overflow.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">dest</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="sc">'a'</span><span class="p">,</span> <span class="sc">'b'</span><span class="p">,</span> <span class="sc">'c'</span><span class="p">};</span>
  <span class="n">strncat</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="s">"AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"</span><span class="p">,</span> \
          <span class="k">sizeof</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span> <span class="o">-</span> <span class="n">strlen</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the length of the copy to be copied is correctly calculated.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0111">Delete non virtual dtor</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#_1">引用</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Delete non virtual dtor.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>If the destructor is not declared as virtual, when the object of the derived class is deleted by the pointer of the base class, only the destructor of the base class is called, and the destructor of the derived class is not called, resulting in the object of the derived class not being recycling creates a resource leak problem.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Destructors should be declared as virtual.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span>               
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
  <span class="c1">// No virtual destructor</span>
  <span class="o">~</span><span class="n">MyClass</span><span class="p">();</span>
  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">example_fun</span><span class="p">();</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="nf">delete</span><span class="p">(</span><span class="n">MyClass</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">delete</span> <span class="n">m</span><span class="p">;</span>  <span class="c1">//Delete an object with a virtual method but </span>
             <span class="c1">//no virtual destructor</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span>               
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
  <span class="c1">//Virtual destructor</span>
  <span class="k">virtual</span>  <span class="o">~</span><span class="n">MyClass</span><span class="p">();</span>
  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">example_fun</span><span class="p">();</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="nf">delete</span><span class="p">(</span><span class="n">MyClass</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">delete</span> <span class="n">m</span><span class="p">;</span>      
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="_1">引用</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.21 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0064">Variable Length Array Size</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-result">unexpected result</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When declaring a variable-length array, the array length must meet the following requirements:</p>
<ol>
<li>The length of the array cannot be negative or 0.</li>
<li>The array length must be an initialized value.</li>
<li>The length of the array cannot be a taint data.</li>
</ol>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-result">unexpected result</h4>
<p>If the above requirements are not met while declaring a variable-length array, the array that may be applied does not match the expected, resulting in unexpected results.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When declaring a variable-length array, the array length must meet the following requirements:</p>
<ol>
<li>The length of the array cannot be negative or 0.</li>
<li>The array length must be an initialized value.</li>
<li>The length of the array cannot be a taint data.</li>
</ol>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="c1">// expected-warning{{Declared variable-length array (VLA) has zero size}</span>
  <span class="p">}</span> 
  <span class="kt">int</span> <span class="n">vla</span><span class="p">[</span><span class="n">x</span><span class="p">];</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, when the variable length array vla is declared, the array length x is 0.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">vla</span><span class="p">[</span><span class="n">x</span><span class="p">];</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, when the variable length array vla is declared, the array length x is not 0.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0003">Imcompatible Cast</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#out-of-bounds-memory-accesses">out-of-bounds memory accesses</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>There are many instances where an object in memory is accessed via a pointer cast to an incompatible type. Casting a pointer will not change memory layout so it will lead to a potential out-of-bounds memory accesses if we access the value via the incompatible type.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="out-of-bounds-memory-accesses">out-of-bounds memory accesses</h4>
<p>Cast a pointer value to an incompatible type will lead to a potential out-of-bounds memory accesses.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Cast a pointer value to an incompatible type.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span> <span class="p">}</span>

<span class="kt">void</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">uint16_t</span> <span class="n">y</span><span class="p">;</span>
  <span class="n">init</span><span class="p">((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">y</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, incompatible cast from uint16_t* to int* at line 5.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span> <span class="p">}</span>

<span class="kt">void</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">uint16_t</span> <span class="n">y</span><span class="p">;</span>
  <span class="n">init</span><span class="p">((</span><span class="kt">uint16_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">y</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, compatible cast from uint16_t* to uint16_t* at line 5.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/csharp.html">CSHARP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0121">Attribute Packed in typedef</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Use the packed attribute when defining an alias for a structure or union with a typedef.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The packed attribute can only be used for type definitions of structure or union. The packed attribute is ignored in the typedef.
The role of "packed" is to align bytes. Some platforms can only access certain types of data from certain addresses. For example, a variable is not byte aligned. Some architecture CPUs may occur error during access. If you do not align the data storage according to the requirements of its platform, it will reduce the efficiency of access.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use the packed attribute when you don't use an typedef to define an alias for a structure or union.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span>    
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">S</span><span class="p">;</span>  <span class="c1">// The packed property will be ignored</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span>    
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span> <span class="n">S</span><span class="p">;</span> 
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.32 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0041">No Effect</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#poor-code-quality">poor code quality</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Many statements or expressions that do not accomplish anything, or statements that perform an action that is not the intended action.</p>
<p>For example:</p>
<p>1.The left operand of a comma operator has no side effects.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">extra_comma</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">a</span><span class="o">++</span><span class="p">,</span> <span class="n">b</span><span class="o">++</span><span class="p">){</span> 
    <span class="cm">/* Extra comma, and so a &lt; 10 is not used */</span>
      <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>2.Patterns delete a, b, where only the first pointer is deleted.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">incomplete_delete</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="o">*</span><span class="n">q</span><span class="p">;</span>
  <span class="n">delete</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span> <span class="c1">// The pointer q is not deleted</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>3.Useless dereferences of pointers.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">no_effect_deref</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
  <span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="p">;</span> <span class="c1">// *p has no effect</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>4.An intended assignment instead of a comparison.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">no_effect_test</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="c1">// Test has no effect</span>
  <span class="c1">// and is likely intended to be the assignment a = b </span>
  <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>5.Switching on a comparison and indicates a likely intended assignment</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">bool_switch</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Boolean switch</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>6.Unsigned comparisons against 0, unless the expression's parent is a manual signed cast.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">unsigned_compare</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// a is unsigned, and so the comparison is never true</span>
    <span class="n">a</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>7.Assignments of fields or globals to self.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">self_assign</span><span class="p">(</span><span class="k">struct</span> <span class="n">foo</span> <span class="o">*</span><span class="n">ptr</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>           <span class="c1">// assignment to self, global</span>
  <span class="n">ptr</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="n">ptr</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span> <span class="c1">// assignment to self, field</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>8.Self assigns to local variables or parameters.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">self_assign_local</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="c1">// assignment to self, local</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="poor-code-quality">poor code quality</h4>
<p>The code has features that do not directly introduce a weakness or vulnerability, but indicate that the product has not been carefully developed or maintained. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Understand the logical of the code and remove useless code.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">;</span> <span class="c1">// detect</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the test at line 3 has no effect, and is likely intended to be the assignment a = b. </p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, using assignment instead of comparison at line 3.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0125">Strong type</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When assigning, passing, or evaluating a variable of an abstract type defined by typedef, the abstract type defined by typedef is ignored and the corresponding basic type is used directly.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Ignoring an abstract type defined by typedef and directly using the corresponding primitive type may have a logic error.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When a variable of an abstract type defined by typedef needs to be assigned, parameter passed, or computed with other types of variables, the type is cast.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">B</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>  <span class="c1">//A type variable is assigned to a type B variable</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">B</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="n">a</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.27 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0128">Hidden parameter</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Parameter hiding by local variables refers to the phenomenon that parameters and local variables have the same name.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When a local variable has the same name as a function parameter, it will invalidate these function parameters. This may not be the programmer's intention, which may result in incorrect program function implementation.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When writing a program, local variables should not have the same name as the parameters.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>     <span class="c1">// Local variables have the same name as </span>
                   <span class="c1">// function parameters</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.28 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0055">Pointer Subtraction</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#_1">意料之外的结果</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>If two pointers point to the same array, they can be subtracted, resulting in the number of elements between the two pointers.
If the two pointers do not point to the same array, they are meaningless and even produce erroneous results.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="_1">意料之外的结果</h4>
<p>If the two pointers do not point to the same array, they are meaningless and even produce erroneous results.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Only do this calculation if the pointers exist in the same memory chunk.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
  <span class="c1">// expected-warning{{Subtraction of two pointers that do not point to </span>
  <span class="c1">// the same memory chunk may cause incorrect result}} </span>
  <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">y</span> <span class="o">-</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, &amp;y and &amp;x point to different memory chunk, cannot be subtracted.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">q</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">q</span><span class="o">-</span><span class="n">p</span><span class="p">;</span> <span class="c1">// no-warning</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, both q and p point to the same array a, which can be subtracted.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0014">Missing Return</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unpredictable-behavior">unpredictable behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Not returning a value can result in unpredictable program behavior. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unpredictable-behavior">unpredictable behavior</h4>
<p>Not returning a value can result in unpredictable program behavior. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Provide a return value in a non-void function.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span> <span class="c1">// missing_return</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example if the value of x is neither 5 nor 3, the non-void function bad missed a return value.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<p>In the fixed code example  provide a return value at the end of function.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0113">implicit int function</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The obsolete "implicit int" rule is used when declaring a function or variable.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When a variable is not assigned a type, the default is "int", but modern C++ no longer supports this rule, which may make the code difficult to port.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When declaring a function or variable, you should specify the type of the variable or function return value.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   <span class="c1">// Type of constant not declared</span>
<span class="n">example_fun</span><span class="p">()</span>    <span class="c1">// The type of function return value not declared</span>
<span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>   
<span class="kt">int</span> <span class="nf">example_fun</span><span class="p">()</span>    
<span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.30 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0056">Out Of ArrayBound</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#crash">crash</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When a program reads data past the end, it will access memory outside the array.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="crash">crash</h4>
<p>An out of bounds array can cause crash.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>High</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Checks if the index value exceeds the length of the array before accessing the element.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the third line, the index value 4 exceeds the length of the array, causing the array to be out of bounds.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the index value in the range of the array length is used.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0005">Com Bad Free</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#use-after-free-memory">use-after-free memory</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>COM specifies that this management should be accomplished through the AddRef and Release methods in every COM interface. It is an error to circumvent the reference counting mechanism by explicitly free a pointer to an interface, because other clients may share ownership of the same object. </p>
<p>Explicitly free a pointer to a COM interface can leave other owners of the instance with dangling pointers. This can possibly result in use-after-free memory errors, including memory corruption and crashes.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="use-after-free-memory">use-after-free memory</h4>
<p>Explicitly free a pointer to a COM interface can leave other owners of the instance with dangling pointers. This can possibly result in use-after-free memory errors, including memory corruption and crashes.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use the AddRef or Release methods to manage the pointer to a COM interface.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">IUnknown</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CFoo</span><span class="p">;</span>
  <span class="n">delete</span> <span class="n">p</span><span class="p">;</span> <span class="c1">// bad</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, explicitly free a pointer to a CFoo interface at line 3.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">IUnknown</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CFoo</span><span class="p">;</span>
    <span class="n">p</span><span class="o">-&gt;</span><span class="n">AddRef</span><span class="p">();</span> <span class="c1">// or p-&gt;Release();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, use AddRef() method to manage the pointer p at line 3.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0004">Sizeof Mismatch</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When a pointer and sizeof expression occur together, the sizeof expression is usually the size of memory that the pointer points to. We will report defects in a limited number of cases where a size_t argument is expected but no sizeof expression is provided. This occurs when the semantics of a function are known and the size_t argument is expected to be the size of memory to which a pointer points, as well as in a small number of cases where it appears that the size_t argument is intended to be the size of some pointed to memory.</p>
<p>The following example contains a common mismatch between a two function arguments: a pointer and a sizeof expression (where sizeof(*ptr) was intended, instead of sizeof(ptr)):  </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">obj</span><span class="p">,</span> <span class="n">ptr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ptr</span><span class="p">))</span>
</pre></div>
</td></tr></table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>Using a sizeof(pointer) instead of a sizeof(value) to get the size of value, this will lead to undefined behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Using a sizeof in a correct way.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">BB</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
<span class="p">};</span>
<span class="kt">void</span> <span class="nf">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">BB</span> <span class="n">buf</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">));</span> <span class="c1">// bad</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, only 4 or 8 bytes of the 100-byte object buf are cleared at line 6.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">BB</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
<span class="p">};</span>
<span class="kt">void</span> <span class="nf">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">BB</span> <span class="n">buf</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span> <span class="c1">// good</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, all of the 100-byte object buf are cleared at line 6.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/java.html">JAVA</a>
                <a href="../../tag/csharp.html">CSHARP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0012">Missing Comma</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-results">unexpected results</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Omissions of a comma between lines in a string array initialization. A missing comma can lead to a single concatenated string element instead of separate string elements, and it can contribute to unexpected results or to an overrun.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-results">unexpected results</h4>
<p>A missing comma can lead to a single concatenated string element instead of separate string elements, and it can contribute to unexpected results or to an overrun.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Add a comma between lines in a string array initialization.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(){</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"hello "</span> <span class="c1">// bad</span>
               <span class="s">"world"</span><span class="p">};</span>     
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, missed a comma between lines in a string array arr initialization at line 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(){</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"hello "</span><span class="p">,</span>
               <span class="s">"world"</span><span class="p">};</span>     
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, add a comma between lines in a string array arr initialization at line 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0073">Copy To Self</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-result">Unexpected result</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Self-assignment is usually a typing error that can lead to program errors or incorrect program functionality.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-result">Unexpected result</h4>
<p>Self-assignment is usually a typing error that can lead to program errors or incorrect program functionality.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Check the code logic to remove invalid self-assigned code.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, line 4 is an invalid self-assignment code.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, remove the invalid self-assignment code.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0106">Byte order</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The multibyte value from the host boundary is not converted to the network byte order or obtained from the outside world or read a multibyte to the host boundary before sending or writing to the environment. The network byte order is converted to the host byte order.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The program runs under the system with different byte order methods, which need to be connected to each other. Incorrectly converting the byte order may result in incorrect program functionality.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>The unsigned short type should be converted from the host sequence to the network sequence by using htons function; </p>
<p>The unsigned long type should be converted from the host sequence to the network sequence by using htonl function; </p>
<p>The unsigned short type should be converted from the network sequence to the host sequence by using ntohs function; </p>
<p>The ntohl function converts the unsigned long type from the network order to the host order.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">long</span> <span class="n">b</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="n">send</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// b is not converted to network byte order</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">long</span> <span class="n">b</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">htonl</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="n">send</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> 
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.3.16 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0007">Bad Alloc Arithmetic</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#memory-corruption">memory corruption</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Sometimes the user write codes like <code>malloc(a)+b</code> or <code>malloc(a)-b</code>, where it appears that the user intended to call <code>malloc(a+b)</code> or <code>malloc(a-b)</code>. These errors cause under- or over-allocation and unintended pointer arithmetic, resulting in memory corruption or a potential security vulnerability when attempting to copy data into the resultant buffer.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="memory-corruption">memory corruption</h4>
<p>These errors cause under- or over-allocation and unintended pointer arithmetic, resulting in memory corruption or a potential security vulnerability when attempting to copy data into the resultant buffer.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Using malloc allocation routine in a correct way.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>  
  <span class="kt">char</span> <span class="o">*</span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, char *p1 and char *p2 both contain allocation errors.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">);</span> 
  <span class="kt">char</span> <span class="o">*</span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, using correct way to alloc memory.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0059">Bad Use Chroot</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#privilege-escalation">Privilege escalation</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The program created a jail by calling the chroot() function, but did not change the working path. This behavior doesn't ensure the files accessed by the program do not exceed this limit.
Improper use of chroot() will allow an attacker to jump out of the limits set by chroot.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="privilege-escalation">Privilege escalation</h4>
<p>The attacker can jump out of the restrictions set by the chroot and perform operations on sensitive data, such as deleting files and modifying the home page.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>After calling chroot(), call chdir("/") to change the working path.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// root changed.</span>
  <span class="n">chroot</span><span class="p">(</span><span class="s">"/usr/local"</span><span class="p">);</span> 
  <span class="c1">// expected-warning {{No call of chdir("/") immediately after chroot}} </span>
  <span class="n">foo</span><span class="p">();</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, after calling chroot(), there is no further call to chdir("/") to change the working path.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">chroot</span><span class="p">(</span><span class="s">"/usr/local"</span><span class="p">);</span> <span class="c1">// root changed.</span>
  <span class="n">chdir</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>
  <span class="n">foo</span><span class="p">();</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code，after calling chroot(), call chdir("/") to change the working path.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1007">Illegal whence argument in fseek</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">fseek</span> <span class="p">(</span> <span class="kt">FILE</span> <span class="o">*</span> <span class="n">stream</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">origin</span> <span class="p">);</span>
</pre></div>
</td></tr></table>
<p>The third argument origin: Position used as reference for the offset. It is specified by one of the following constants defined in <code>&lt;cstdio&gt;</code> exclusively to be used as arguments for this function:</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Reference position</th>
</tr>
</thead>
<tbody>
<tr>
<td>SEEK_SET</td>
<td>Beginning of file</td>
</tr>
<tr>
<td>SEEK_CUR</td>
<td>Current position of the file pointer</td>
</tr>
<tr>
<td>SEEK_END</td>
<td>End of file</td>
</tr>
</tbody>
</table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>If the third argument to fseek() not be SEEK_SET, SEEK_END, or SEEK_CUR, the behavior is undefined.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>The whence argument to fseek() should be SEEK_SET, SEEK_END, or SEEK_CUR.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#define N 5</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">student</span><span class="p">{</span>
  <span class="kt">long</span> <span class="n">sno</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
  <span class="kt">float</span> <span class="n">score</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span><span class="n">STU</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">fun</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="n">filename</span><span class="p">,</span><span class="n">STU</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">FILE</span><span class="o">*</span> <span class="n">fp</span><span class="p">;</span>
  <span class="n">fp</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s">"rb+"</span><span class="p">);</span>
  <span class="n">fseek</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="o">-</span><span class="mi">1L</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">STU</span><span class="p">),</span><span class="mi">4</span><span class="p">);</span> <span class="c1">// 4 is not a valid whence argument</span>
  <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">STU</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">fp</span><span class="p">);</span>
  <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed code example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#define N 5</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">student</span><span class="p">{</span>
  <span class="kt">long</span> <span class="n">sno</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
  <span class="kt">float</span> <span class="n">score</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span><span class="n">STU</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">fun</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="n">filename</span><span class="p">,</span><span class="n">STU</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">FILE</span><span class="o">*</span> <span class="n">fp</span><span class="p">;</span>
  <span class="n">fp</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s">"rb+"</span><span class="p">);</span>
  <span class="n">fseek</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="o">-</span><span class="mi">1L</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">STU</span><span class="p">),</span><span class="n">SEEK_END</span><span class="p">);</span>
  <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">STU</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">fp</span><span class="p">);</span>
  <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0057">Malloc Size Overflow</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-results">unexpected results</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The computation of the size of the memory allocation may overflow.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-results">unexpected results</h4>
<p>A length overflow during memory allocation causes the actual allocated memory length to be different than expected., which could results in unexpected results.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Detect the length of the allocation before memory allocation.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="o">*</span><span class="nf">bad</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// expected-warning {{the computation of the size of the memory </span>
  <span class="c1">// allocation  may overflow}} </span>
  <span class="k">return</span> <span class="n">malloc</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span>  
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the value of n is passed from outside the function. The result of <code>n * 4</code> may exceed the maximum value of <code>unsigned int</code>, causing an overflow. The actual allocated memory size does not match the expected value.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="o">*</span><span class="nf">good</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">malloc</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the value of n is detected before n is used, thereby preventing the malloc size overflow during memory allocation.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0119">Use long long type</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Use data types that lack consistency definitions across compilers, such as the "long long" type.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Using data types that lack consistency definitions across compilers can make the code difficult to port.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Instead of assuming that the type provided by the compiler has a reasonable size, you should use the compiler's built-in or defined macros to represent the actual size you want.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">;</span>  <span class="c1">//Use a long long type that lacks a </span>
                  <span class="c1">//consistent definition</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">UINT64_t</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.6 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0112">Floating point comparison</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Two floating point or double floating point values ​​are compared using the "==" or "!=" operator.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The storage and calculation of floating-point numbers in a computer is inaccurate, so comparing a floating-point number with the "==" or "!=" operator may result in the opposite of the expected result.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Whether the floating point numbers are equal or unequal is determined by calculating whether the absolute value of the difference between the two floating point numbers is less than an allowable error value.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span>  <span class="c1">//Equal comparison of floating point numbers</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.000001</span><span class="p">)</span>  <span class="c1">//Equal comparison of floating point numbers</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.25 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0075">Virtual Call In Construction Or Destruction</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-result">unexpected result</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Call a virtual function directly or indirectly from a constructor or destructor. Since the object's construction order starts from the parent class and then the derived class, it is dangerous to try to call the derived class from the parent class during the construction process. This is why calling a virtual function from a constructor does not cause a function in the derived class to be called. In this process, the derived class object has not yet been initialized. Similarly, objects are destroyed in the reverse order of construction, so attempting to call a function in a derived class in the destructor results in accessing an object that has already been destroyed.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-result">unexpected result</h4>
<p>Call a virtual function directly or indirectly from a constructor or destructor. Since the object's construction order starts from the parent class and then the derived class, it is dangerous to try to call the derived class from the parent class during the construction process. This is why calling a virtual function from a constructor does not cause a function in the derived class to be called. In this process, the derived class object has not yet been initialized. Similarly, objects are destroyed in the reverse order of construction, so attempting to call a function in a derived class in the destructor results in accessing an object that has already been destroyed.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not call virtual functions in constructors or destructors.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">A</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="n">A</span><span class="p">(){</span> <span class="n">f</span><span class="p">();</span> <span class="p">};</span>
  <span class="n">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">);</span>

  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{};</span>

  <span class="n">virtual</span> <span class="kt">int</span> <span class="nf">foo</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// from Sema: expected-note {{'foo' declared here}}</span>
  <span class="n">virtual</span> <span class="kt">void</span> <span class="nf">bar</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">f</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Call to pure virtual function during construction has undefined behavior</span>
    <span class="n">foo</span><span class="p">();</span> 
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the above code, the virtual function foo() is called in the constructor of class A.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">A</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="n">A</span><span class="p">(){};</span>
  <span class="n">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">);</span>

  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{};</span>

  <span class="n">virtual</span> <span class="kt">int</span> <span class="nf">foo</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
  <span class="n">virtual</span> <span class="kt">void</span> <span class="nf">bar</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">f</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">foo</span><span class="p">();</span> 
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the above code, remove the call to the virtual function foo() in the constructor of class A.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0050">Bad Pointer Arithmetic</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#out-of-bound-access">Out of bound access</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The type systems in C/C++ do not distinguish between "pointer to one object" and "pointer to array of objects". Consequently, it is easy to accidentally apply pointer arithmetic to a pointer that only points to a singleton object. </p>
<p>Typically, when pointer arithmetic is applied to a singleton pointer, the result is either reading garbage/unintended value from memory, or writing to unintended memory and corrupting it.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="out-of-bound-access">Out of bound access</h4>
<p>Typically, when pointer arithmetic is applied to a singleton pointer, the result is either reading garbage/unintended value from memory, or writing to unintended memory and corrupting it.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Apply pointer arithmetic to a pointer that only points to array of objects. </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
  <span class="n">p</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, <code>p</code> is a pointer that only points to a singleton object. Apply pointer arithmetic at line 4 will result a garbage value.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
  <span class="n">p</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, <code>p</code> is a pointer that only points to array of objects.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0123">Pointer align</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The position pointed by the pointer is not the starting position of the element in the array.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Incorrect pointer align can result in program function errors or buffer overflows.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use pointer align correctly.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">};</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">a</span><span class="p">;</span>
  <span class="c1">//The position pointed by the pointer "p+3" is not the starting </span>
  <span class="c1">//position of the element of the integer array a</span>
  <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">3</span><span class="p">));</span>  
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">};</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">a</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">4</span><span class="p">));</span>  
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.7.2 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0116">Infinite recursion function</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The method calls itself directly or indirectly without any condition checking.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Infinite recursion can cause the program stack overflow.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Remove infinite recursion function.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">this</span><span class="p">.</span><span class="n">example_fun</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="c1">//Infinite recursion function</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.8.2 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1009">Null pointer argument in call to string functions</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Do not use the null value in any instance where an object is required, including the following cases:</p>
<ul>
<li>Calling the instance method of a null object</li>
<li>Accessing or modifying the field of a null object</li>
<li>Taking the length of null as if it were an array</li>
<li>Accessing or modifying the elements of null as if it were an array</li>
<li>Throwing null as if it were a Throwable value</li>
</ul>
<p>Using a null in cases where an object is required results in a NullPointerException being thrown, which interrupts execution of the program or thread.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Using a null in cases where an object is required results in a NullPointerException being thrown, which interrupts execution of the program or thread. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not use the null value in any instance where an object is required.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">strcpy_null_dst</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// expected-warning{{Null pointer argument in call to string copy function}}</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span> 

  <span class="c1">// expected-warning{{Null pointer argument in call to string length function}}</span>
  <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 

  <span class="kt">char</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">y</span> <span class="o">=</span> <span class="s">"123"</span><span class="p">;</span>
  <span class="c1">// expected-warning{{Null pointer argument in call to string comparison</span>
  <span class="c1">// function}}</span>
  <span class="n">strcmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/EXP01-J.+Do+not+use+a+null+in+a+case+where+an+object+is+required.html <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0114">Inappropriate iterator</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The iterator is assigned to one container but the iterator is used in another container.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Using an iterator on an unsuitable container can cause undefined behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Attention should be paid to the scope and effectiveness of the iterator.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="n">b</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">...</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">set</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">b</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
    <span class="p">{</span>
      <span class="n">b</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.15 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0016">Stray Semicolon</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#logic-error">logic error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When an if statement is prematurely terminated with a semicolon, the then portion which was intended to be conditional will execute unconditionally. When a semicolon prematurely terminates a while or for loop, the loop might iterate infinitely or it might iterate pointlessly, followed by the intended body of the loop that executes once, unconditionally.</p>
<p>A number of heuristics distinguish between extraneous and intentional semicolons. For if statements, if the if has no then and no else clause, it is a defect. The only exception to this behavior is if there is a C/C++ macro that expands to nothing in the location that the then clause is expected. In this case, it is assumed that the macro conditionally expands either to a non-empty statement or nothing.</p>
<p>The rule for loops is more complicated, because loops with no bodies are common. Generally speaking, a while or for loop will only be reported if it is followed by a block (a "compound statement") that is not justified for any purpose other than serving as the loop’s intended body.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="logic-error">logic error</h4>
<p>An extraneous semicolon alters the logic of the code. When an if statement is prematurely terminated with a semicolon, the then portion which was intended to be conditional will execute unconditionally. When a semicolon prematurely terminates a while or for loop, the loop might iterate infinitely or it might iterate pointlessly, followed by the intended body of the loop that executes once, unconditionally.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Look over the semicolon followed by if, for, while statements, remove the stray senicolon.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">){};</span>

  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// detect</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, a stray semicolon followed by the while statement at line 4.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">){};</span>

  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, remove the stray senicolon followed by the while statement at line 4.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1005">Attempt to Access Child of a Non-structure Pointer</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Casting a non-structure type to a structure type and accessing a field can lead to memory access errors or data corruption. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Adjacent variables in memory may be corrupted by assignments performed on fields after the cast. </p>
<p>Execution may end due to a memory access error. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Review of type casting operations can identify locations where incompatible types are cast. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">foo</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="o">*</span><span class="n">foo</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">foo</span> <span class="o">*</span><span class="p">)</span><span class="n">main</span><span class="p">;</span>
  <span class="n">foo</span><span class="o">-&gt;</span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">foo</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/588.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                <a href="../../tag/cwe-588.html">CWE-588</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0039">Infinite Loop</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#denial-of-service-attack">denial of service attack</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The program contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="denial-of-service-attack">denial of service attack</h4>
<p>An infinite loop can cause a program to hang up indefinitely or crash, possibly allowing a denial-of-service (DoS) attack due to excessive use of CPU or memory resources.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Change the logic of the loop to avoid an infinite loop.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">global_var</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">global_var</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the exit is based on variable <code>global_var</code>, which has been defined as a global variable outside the function <code>bad</code> and is never changed in the while loop. This will lead to an infinite loop.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">global_var</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">global_var</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="n">global_var</span><span class="o">--</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span> 
</pre></div>
</td></tr></table>
<p>In the fixed code example, change the value of variable <code>global_var</code> in the while loop.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0015">Secure Temp</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#outside-attack">outside attack</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Many programs create temporary files in shared directories such as /tmp. There are C library routines that assist in creating unique temporary files, but many of them are insecure as they make a program vulnerable to race condition attacks.</p>
<p>If the name of a temporary file is easily guessed, or the filename is used unsafely after temp file creation, or the umask is not safely set before calling a safe routine, an attacker can take control of a vulnerable application and system.</p>
<p>Avoid using insecure temporary file creation routines. Instead, use mkstemp() for creating temp files. When using mkstemp(), remember to safely set the umask before to restrict the resulting temporary file permissions to only the owner. Also, do not pass on the filename to another privileged system call. Use the returned file descriptor instead.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="outside-attack">outside attack</h4>
<p>If the name of a temporary file is easily guessed, or the filename is used unsafely after temp file creation, or the umask is not safely set before calling a safe routine, an attacker can take control of a vulnerable application and system.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Avoid using insecure temporary file creation routines. </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">mktemp</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, use mktemp() routine to create temporary file, it is easy to guess the name of the temporary file it creates.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"a.txt"</span><span class="p">;</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">mkstemp</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example  use mkstemp() routine to create temporary file.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0126">Using system literal macro</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>This is the limit that a typical compiler provides for its particular data model and functionality (usually in limits.h). Using these values ​​across platforms is dangerous because different compilers may provide different limits and widths, which can cause stack overflows, numerical overflows or underflows, and exhaustion of operations during operation.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>It may cause stack overflow, numerical overflow or underflow, and exhaustion of operations during operation.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Customize the required limits instead of relying on an abstract number provided by the platform-specific compiler.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">INT_MAX</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#define MY_INT_MAX 65535</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">MY_INT_MAX</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.7 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/concurrency and temporal errors.html">Concurrency and temporal errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0078">Invalid Use of vfork</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/concurrency-and-temporal-errors.html">Concurrency and temporal errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-result">unexpected result</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>If the process created by the vfork() function modifies a variable other than the pid_t type, returns from a function that calls vfork(), or calls another function before successfully calling the _exit() function or exec() function, causes the occurrence of undefined behavior.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-result">unexpected result</h4>
<p>If the process created by the vfork() function modifies a variable other than the pid_t type, returns from a function that calls vfork(), or calls another function before successfully calling the _exit() function or exec() function, causes the occurrence of undefined behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Avoid modifying any program variables before successfully calling the _exit() function or exec() function.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">pid_t</span> <span class="n">pid</span> <span class="o">=</span> <span class="n">vfork</span><span class="p">();</span>
  <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, after the vfork() function is called, the variable x of type <code>int</code> is modified, which causes undefined behavior.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">pid_t</span> <span class="n">pid</span> <span class="o">=</span> <span class="n">vfork</span><span class="p">();</span>
  <span class="n">pid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, after calling the vfork() function, the modified variable pid is of type <code>pid_t</code>, and this behavior does not produce undefined behavior.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0010">Delete Void Pointer</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>In many implementations, deleting a pointer to void is treated like calling free() in that the memory is deallocated but destructors do not run. However, even if that is the intended behavior, it is dangerous to rely on it for the following reasons:</p>
<ul>
<li>The behavior is undefined by the language standard. The implementation can technically do anything, and some compilers have optimizers that aggressively transform code that relies on undefined behavior.</li>
<li>If the allocation site is changed, for example, to allocate an array of objects, the deallocation site will silently do the wrong thing.</li>
</ul>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>According to the C++ standard, deleting a pointer with type void* is an undefined behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not delete void pointer.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span> 
    <span class="n">delete</span> <span class="n">p</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, delete is used on a pointer of type void at line 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span> 
    <span class="n">delete</span> <span class="n">p</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, delete is used on a pointer of type int at line 2. </p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0024">Nesting Indent Mismatch</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#dangling-else-issue">"dangling else" issue</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Braces improve the uniformity and readability of code. More important, when inserting an additional statement into a body containing only a single statement, it is easy to forget to add braces because the indentation gives strong (but misleading) guidance to the structure.</p>
<p>Braces also help ensure that macros with multiple statements are properly expanded. Such a macro should be wrapped in a do-while loop. However, when the do-while loop is not present, braces can still ensure that the macro expands as intended.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="dangling-else-issue">"dangling else" issue</h4>
<p>In the following example, it appears that the developer intended do_something_else() to be the else of the first if statement (that is, when condition1 is false). However, the else is incorrectly written to apply to the second if (that is, when condition1 is true and condition2 is false, with nothing happening when condition1 is false):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">condition1</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">condition2</span><span class="p">)</span>
    <span class="n">do_something</span><span class="p">();</span>
<span class="k">else</span> <span class="c1">// "dangling"</span>
  <span class="n">do_something_else</span><span class="p">();</span>
</pre></div>
</td></tr></table>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Opening and closing braces for if, for, and while statements should always be used even if the statement's body contains only a single statement.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">cond1</span><span class="p">();</span>
<span class="kt">bool</span> <span class="nf">cond2</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something_else</span><span class="p">();</span>

<span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">cond1</span><span class="p">())</span> 
    <span class="k">if</span> <span class="p">(</span><span class="n">cond2</span><span class="p">())</span>
      <span class="n">do_something</span><span class="p">();</span>
  <span class="k">else</span>
    <span class="n">do_something_else</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, missing opening and closing braces for if and else statements.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">cond1</span><span class="p">();</span>
<span class="kt">bool</span> <span class="nf">cond2</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_something_else</span><span class="p">();</span>

<span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">cond1</span><span class="p">()){</span> 
    <span class="k">if</span> <span class="p">(</span><span class="n">cond2</span><span class="p">()){</span>
      <span class="n">do_something</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="n">do_something_else</span><span class="p">();</span>
  <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, add opening and closing braces for if and else statements.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0068">Float loop</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#dos-crash-exit-restart">DoS: crash / exit / restart</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Because floating-point numbers represent real numbers, it is often mistakenly assumed that they can represent any simple fraction exactly. Floating-point numbers are subject to representational limitations just as integers are, and binary floating-point numbers cannot represent all real numbers exactly, even if they can be represented in a small number of decimal digits.<br/>
In addition, because floating-point numbers can represent large values, it is often mistakenly assumed that they can represent all significant digits of those values. To gain a large dynamic range, floating-point numbers maintain a fixed number of precision bits (also called the significand) and an exponent, which limit the number of significant digits they can represent.<br/>
Different implementations have different precision limitations, and to keep code portable, floating-point variables must not be used as the loop induction variable.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="dos-crash-exit-restart">DoS: crash / exit / restart</h4>
<p>If floating-point variables are used as the loop induction variable. which may cause dead loop.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use integer as loop induction variable.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">float</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(;</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span><span class="n">a</span><span class="o">++</span><span class="p">){</span>
    <span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In this example, use float variable a as loop induction variable, which may cause infinite loop.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(;</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span><span class="n">a</span><span class="o">++</span><span class="p">){</span>
    <span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>Change a as integer type, the loop induction is controlable.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0107">Bad condition operation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Use the bitwise operator '&amp;' or '|' in conditional expressions used to control program flow.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When the conditional expression used to control the program flow uses the bitwise operator '&amp;' or '|', the intention of the program may be to use the operator "&amp;&amp;" or "||", which may change the original judgment logic, causing the program Perform different branch paths.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use the operator '&amp;&amp;' or '||'.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="c1">//Use the bitwise operator "&amp;" in conditional expressions </span>
  <span class="c1">//used to control program flow</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span><span class="mi">0</span>  <span class="o">&amp;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> 
  <span class="p">{</span>  
    <span class="p">...</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span><span class="mi">0</span>  <span class="o">&amp;&amp;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> 
  <span class="p">{</span>  
    <span class="p">...</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.26 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0129">Invariant condition</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The result of the conditional expression used to control the program flow is always true or false.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When a conditional expression used to control a program flow is a constant, part of the branch path of the code is never executed, and the conditional expression becomes meaningless. When the result of the conditional expression used to control the loop is always true, it may cause the program to do an infinite loop.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Eliminate the case where the conditional expression result is always true or false.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span> <span class="p">()</span> 
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1">//The conditional expression "a &gt; 0" used to control </span>
               <span class="c1">//the program flow is always true</span>
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>  
    <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.5.13 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0054">Assignment of a Fixed Address to a Pointer</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#portability-error">portability error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software sets a pointer to a specific address other than NULL or 0. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="portability-error">portability error</h4>
<p>Using a fixed address is not portable because that address will probably not be valid in all environments or platforms.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Never set a pointer to a fixed address.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
  <span class="c1">// expected-warning{{Using a fixed address is not portable because that address </span>
  <span class="c1">// will probably not be valid in all environments or platforms}}  </span>
  <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="mh">0x10000</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, using a fixed address is not portable because that address will probably not be valid in all environments or platforms at line 3.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, assign <code>&amp;a</code> to pointer <code>p</code>.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0018">Com Addrof Leak</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#memory-leak">memory leak</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>A CComBSTR or CComPtr instance that might cause memory leaks because the value of the pointer that is internal to the instance can be modified through the pointer address.</p>
<p>Local non-static CComBSTR and CComPtr variables that have been determined as managing a non-null pointer. When the address of the pointer (obtained through the overloaded operator address-of (&amp;)) is passed as an argument to a function call, the pointer value can potentially be overwritten, causing a memory leak.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="memory-leak">memory leak</h4>
<p>Local non-static CComBSTR and CComPtr variables that have been determined as managing a non-null pointer. When the address of the pointer (obtained through the overloaded operator address-of (&amp;)) is passed as an argument to a function call, the pointer value can potentially be overwritten, causing a memory leak.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>High</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not pass the address of the CComBSTR or CComPtr pointer to a function call as an argument.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">Base</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="c1">// \pName is a pointer</span>
  <span class="kt">void</span> <span class="n">getName</span><span class="p">(</span><span class="n">BSTR</span> <span class="o">*</span><span class="n">pName</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> 
    <span class="o">*</span><span class="n">pName</span> <span class="o">=</span> <span class="o">::</span><span class="n">SysAllocString</span><span class="p">(</span><span class="n">name_</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">LPCOLESTR</span> <span class="n">name_</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">Release</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">};</span>

<span class="n">CComBSTR</span> <span class="nf">getBaseName</span><span class="p">(</span><span class="k">const</span> <span class="n">Base</span> <span class="o">&amp;</span><span class="n">base</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">CComBSTR</span> <span class="n">name</span><span class="p">;</span>
  <span class="n">name</span> <span class="o">=</span> <span class="sa">L</span><span class="s">"Lucky"</span><span class="p">;</span>
  <span class="n">base</span><span class="p">.</span><span class="n">getName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">name</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, The overloaded operator address-of (CComBSTR::operator &amp;) returns the address of the internal pointer and the value of the pointer is overwritten during the call to Base::getName(). The memory allocated during the construction of the object will never be deallocated and is therefore leaked.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">Base</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="c1">// \pName is a value</span>
  <span class="kt">void</span> <span class="n">getName</span><span class="p">(</span><span class="n">BSTR</span> <span class="n">pName</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
      <span class="n">pName</span> <span class="o">=</span> <span class="o">::</span><span class="n">SysAllocString</span><span class="p">(</span><span class="n">name_</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">LPCOLESTR</span> <span class="n">name_</span><span class="p">;</span>
  <span class="kt">void</span> <span class="nf">Release</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">};</span>

<span class="n">CComBSTR</span> <span class="nf">getBaseName</span><span class="p">(</span><span class="k">const</span> <span class="n">Base</span> <span class="o">&amp;</span><span class="n">base</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">CComBSTR</span> <span class="n">name</span><span class="p">;</span>
  <span class="n">name</span> <span class="o">=</span> <span class="sa">L</span><span class="s">"Lucky"</span><span class="p">;</span>
  <span class="n">base</span><span class="p">.</span><span class="n">getName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, pass the CComBSTR or CComPtr pointer to a function call as an argument at line 14.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0095">Free a null pointer</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>void free (void* ptr); // Deallocate memory block
</pre></div>
</td></tr></table>
<p>A block of memory previously allocated by a call to malloc, calloc or realloc is deallocated, making it available again for further allocations. <br/>
If ptr does not point to a block of memory allocated with the above functions, it causes undefined behavior.<br/>
If ptr is a null pointer, the function does nothing.  </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Freeing a null pointer will have no effect in the execution.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not free a null pointer.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">test</span><span class="p">(){</span>
  <span class="n">free</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, freeing a null pointer will have no effect in the execution.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0008">Function Address Comparison</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#logical-error">logical error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Many cases in which a comparison operator or function is misused. Typically, the behavior of the program is not what the programmer intended because the comparison often produces a fixed result. For example, many cases where a function is implicitly converted to its address and then compared with 0. Because function addresses are never 0, such comparisons always have a fixed result.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="logical-error">logical error</h4>
<p>Compare function's address with 0 always lead to a fixed result, which is not what the programmer intended.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Compare function's return value with 0.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">malloc</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* bad */</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, A comparison of a function's address to 0 occurred at line 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">malloc</span><span class="p">(</span><span class="n">len</span><span class="p">))</span> <span class="p">{</span> <span class="cm">/* good */</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, compare a function's return value to 0 at line 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0072">Iterator Past End</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When dereferencing a container's iterator, the iterator points to the container's end() or rend() will produce undefined behavior.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>When dereferencing a container's iterator, the iterator points to the container's end() or rend() will produce undefined behavior.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When the dereferenced iterator is guaranteed, the iterator points to the legal interval.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">auto</span> <span class="n">i</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
  <span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="c1">// expected-warning{{Iterator accessed past its end}}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the reference to the iterator i point to the container end() is dereferenced.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">auto</span> <span class="n">i</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
    <span class="o">*</span><span class="n">i</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, when it is guaranteed to dereference the iterator, the iterator points to the legal interval.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1000">String copy functions with memory overlapping</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>In general, memcpy is implemented in a simple (but fast) manner. Simplistically, it just loops over the data(in order), copying from one location to the other. This can result in the source being overwritten while it's being read.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The copying is done directly on the memory so that when there is memory overlap, we get unexpected results.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Using memmove() instead of memcpy() to copy memory.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(){</span>
  <span class="kt">char</span> <span class="n">a</span><span class="p">[]</span><span class="o">=</span><span class="s">"hare rama hare rama"</span><span class="p">;</span>
  <span class="n">memcpy</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="c1">// "hare hare hare hare hare hare rama hare rama"</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed code example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(){</span>
  <span class="kt">char</span> <span class="n">a</span><span class="p">[]</span><span class="o">=</span><span class="s">"hare rama hare rama"</span><span class="p">;</span>
  <span class="n">memmove</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="c1">// "hare hare rama hare rama"</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0029">Error Stack Use</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#software-or-system-crash">software or system crash</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The maximum number of bytes allowed for a single stack allocation. For example, one local declaration. Any specified value is promoted to a multiple of the alignment boundary. Default is 1024.</p>
<p>Specialized application domains with strict stack limitations, such as kernels and device drivers. In these domains, exceeding the stack's maximum can cause serious issues, from errant results to software or system crashes.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="software-or-system-crash">software or system crash</h4>
<p>Specialized application domains with strict stack limitations, such as kernels and device drivers. In these domains, exceeding the stack's maximum can cause serious issues, from errant results to software or system crashes.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Alloc a single stack memory within 1024 bytes.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">16384</span><span class="p">];</span> <span class="c1">// Exceeds max single base use of 1024 bytes</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, 16384 bytes of stack usage, exceeds max single base use of 1024 bytes at line 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, 128 bytes of stack usage at line 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0017">Bad Override</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#logic-error">logic error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Overriding virtual functions due to missing const modifiers, which result in type signature mismatches.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="logic-error">logic error</h4>
<p>Overriding virtual functions due to missing const modifiers, which result in type signature mismatches.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Overriding virtual functions in a correct way.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">A</span> <span class="p">{</span>
  <span class="n">virtual</span> <span class="kt">void</span> <span class="n">setName</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="cm">/*...*/</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="n">class</span> <span class="nl">B</span> <span class="p">:</span> <span class="n">public</span> <span class="n">A</span> <span class="p">{</span>
  <span class="kt">void</span> <span class="n">setName</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span>  <span class="p">{</span> <span class="cm">/* ... */</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, B::setName is probably meant to override A::setName but type signatures don't match perfectly.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">A</span> <span class="p">{</span>
  <span class="n">virtual</span> <span class="kt">void</span> <span class="n">setName</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span>  <span class="k">const</span> <span class="p">{</span> <span class="cm">/*...*/</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="n">class</span> <span class="nl">B</span> <span class="p">:</span> <span class="n">public</span> <span class="n">A</span> <span class="p">{</span>
  <span class="kt">void</span> <span class="n">setName</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span>  <span class="k">const</span> <span class="p">{</span> <span class="cm">/* ... */</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, add const type signature for B::setName method.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/concurrency and temporal errors.html">Concurrency and temporal errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0076">Invalid Use of MPI</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/concurrency-and-temporal-errors.html">Concurrency and temporal errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#deadlocks">deadlocks</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>MPI provides six basic API calls:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">MPI_init</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">***</span><span class="n">argv</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">MPI_Finalize</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="n">MPI_Comm</span> <span class="n">comm</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">rank</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">MPI_Comm_size</span><span class="p">(</span><span class="n">MPI_Comm</span> <span class="n">comm</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">size</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">MPI_Send</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">,</span> <span class="n">MPI_Datatype</span> <span class="n">datatype</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dest</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tag</span><span class="p">,</span> <span class="n">MPI_Comm</span> <span class="n">comm</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">MPI_Recv</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">,</span> <span class="n">MPI_Datatype</span> <span class="n">datatype</span><span class="p">,</span> <span class="kt">int</span> <span class="n">source</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tag</span><span class="p">,</span> <span class="n">MPI_Comm</span> <span class="n">comm</span><span class="p">,</span> <span class="n">MPI_Status</span> <span class="o">*</span> <span class="n">status</span><span class="p">)</span>
</pre></div>
</td></tr></table>
<p>Improper use of these APIs can cause problems such as deadlocks.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="deadlocks">deadlocks</h4>
<p>Improper use of these APIs can cause problems such as deadlocks.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Correctly use of MPI</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad1</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// Check missing wait for dead region.</span>
  <span class="kt">double</span> <span class="n">buf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">MPI_Request</span> <span class="n">sendReq1</span><span class="p">;</span>
  <span class="n">MPI_Ireduce</span><span class="p">(</span><span class="n">MPI_IN_PLACE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE</span><span class="p">,</span> <span class="n">MPI_SUM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> \
  <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sendReq1</span><span class="p">);</span>
<span class="p">}</span> <span class="c1">// expected-warning{{Request 'sendReq1' has no matching wait.}}</span>


<span class="kt">void</span> <span class="nf">bad2</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">buf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">MPI_Request</span> <span class="n">sendReq</span><span class="p">;</span>
  <span class="n">MPI_Isend</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sendReq</span><span class="p">);</span>
  <span class="c1">// expected-warning{{Double nonblocking on request 'sendReq'.}}</span>
  <span class="n">MPI_Irecv</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sendReq</span><span class="p">);</span> 
  <span class="c1">// expected-warning{{Double nonblocking on request 'sendReq'.}}</span>
  <span class="n">MPI_Isend</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sendReq</span><span class="p">);</span> 
  <span class="n">MPI_Wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sendReq</span><span class="p">,</span> <span class="n">MPI_STATUS_IGNORE</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The above code uses the MPI library function incorrectly.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good1</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// Check missing wait for dead region.</span>
  <span class="kt">double</span> <span class="n">buf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">MPI_Request</span> <span class="n">sendReq1</span><span class="p">;</span>
  <span class="n">MPI_Ireduce</span><span class="p">(</span><span class="n">MPI_IN_PLACE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE</span><span class="p">,</span> <span class="n">MPI_SUM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> \
  <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sendReq1</span><span class="p">);</span>
    <span class="n">MPI_Wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sendReq1</span><span class="p">,</span> <span class="n">MPI_STATUS_IGNORE</span><span class="p">);</span>
<span class="p">}</span> 


<span class="kt">void</span> <span class="nf">good2</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">buf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">MPI_Request</span> <span class="n">sendReq</span><span class="p">;</span>
  <span class="n">MPI_Isend</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_DOUBLE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sendReq</span><span class="p">);</span>
  <span class="n">MPI_Wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sendReq</span><span class="p">,</span> <span class="n">MPI_STATUS_IGNORE</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The above code uses the MPI library function correctly.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1006">Call functions with the wrong number of arguments</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Functions that are appropriately declared  will typically generate a compiler diagnostic message if they are supplied with the wrong number of arguments. However, there are cases in which supplying the incorrect arguments to a function will, at best, generate compiler warnings. Although such warnings should be resolved, they do not prevent program compilation.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Calling a function with incorrect arguments can result in unexpected or unintended program behavior.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Call functions with the correct number of arguments</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">func</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
  <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed code example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">func</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
  <span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CERT">
<p>https://wiki.sei.cmu.edu/confluence/display/c/EXP37-C.+Call+functions+with+the+correct+number+and+type+of+arguments.html <a class="footnote-backref" href="#fnref-CERT" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/c.html">C++</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0020">Bad Evaluation Order</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#side-effect">Side Effect</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>If a single memory location is written more than once, or both read and written, without an intervening sequence point, then the program behavior is undefined. In practice, implementations may behave differently depending on compiler, compiler version, and optimization settings. This occurs even though the rules of precedence and associativity unambiguously define the syntactic expression structure.</p>
<p>In the following example, the value of b after the assignment is 3 if the left side of the operator is evaluated first, or 4 if the right side of the operator is evaluated first:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</td></tr></table>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="side-effect">Side Effect</h4>
<p>Expression evaluation do not determine the order in which side effects happen.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Ensure that the expression has no side effects.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">++</span><span class="p">;</span> 
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example,  The right hand side of the assignment at line 3 is evaluated before the assignment itself takes place. However, the side effect order is unspecified because the side effect associated with ++ could happen before or after the side effect associated with the assignment.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">x</span><span class="o">++</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example,  the return value x is 1 at line 4.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0030">Stream Format State Error</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-behaviour">unexpected behaviour</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The standard C++ iostream library provides input and output functionality using streams. It includes a formatted output capability, so that data of various types can be converted to a string for output purposes.</p>
<p>For example:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">;</span>
</pre></div>
</td></tr></table>
<p>by default, converts the i integer to a string of decimal digits and writes those digits to cout.</p>
<p>A common mistake when using the iostream library is to alter the formatting state but forget to restore it. When altering the formatting state of a global stream, such as cout, or a stream passed as a parameter, later users of that stream unexpectedly have their formatting operations affected by the latent state changes. This is a violation of the expected modularity of stream users.</p>
<p>You can change the formatting state of an ostream object by using methods or manipulators. STREAM_FORMAT_STATE handles the flags, setf, unsetf, precision, and fill methods, as well as all of the standard manipulators, such as std::hex.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-behaviour">unexpected behaviour</h4>
<p>Using the iostream library to alter the formatting state but forget to restore it, will lead to an unexpected behaviour.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Using the iostream library to alter the formatting state and remember to restore it.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">hex</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, use std::hex to alter the formatting state but do not restore it at line 3.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">hex</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="n">dec</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, use std::hex to alter the formatting state and std::use dec to restore it at line 3.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0019">Bad Shfit</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Bit shift operations where the value or the range of possible values for the shift amount (the right operand) is such that the operation might invoke undefined behavior or might not produce the expected result.</p>
<p>Specifically, the checker finds cases where:  </p>
<ol>
<li>For a left bit shift (&lt;&lt;), the shift amount is greater than or equal to the size, in bits, of the type to which the left operand is promoted.</li>
<li>For a right bit shift (&gt;&gt; and also &gt;&gt;&gt; for Java), the shift amount is greater than or equal to the size, in bits, of the (unpromoted) left operand.</li>
<li>The shift amount is negative.</li>
</ol>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>Bit shift operations where the value or the range of possible values for the shift amount (the right operand) is negative or greater than or equal to the size, in bits, of the type to which the left operand is promoted might invoke undefined behavior or might not produce the expected result.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Ensure that the shift amount (the right operand) is positive and less than the size, in bits, of the type to which the left operand is promoted.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">long</span> <span class="kt">long</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">value</span><span class="p">,</span> <span class="kt">int</span> <span class="n">shift_size</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">shift_size</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">)</span> 
      <span class="k">return</span> <span class="n">value</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">shift_size</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, a left shift by a number greater than or equal to the size, in bits, of the type to which the left operand is promoted has undefined behavior at line 6.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">val</span><span class="p">,</span> <span class="kt">int</span> <span class="n">shift_amount</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">shift_amount</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">)</span> 
      <span class="k">return</span> <span class="n">val</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="mi">31</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, a left shift by a number less than the size, in bits, of the type to which the left operand is promoted  at line 6.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0047">Bad Alloc Strlen</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#buffer-overflow">buffer overflow</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Assuming that you intended <code>strlen(p)+1</code> to indicate the length of p plus an extra byte for a null terminator, <code>strlen(p+1)</code> is undefined when p is zero length and <code>strlen(p)-1</code> otherwise. The result is a potential buffer overrun on the result of allocation, undefined behavior when p is zero length, or both.</p>
<p>This defect almost always results in a buffer overflow when data is copied to the new buffer.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="buffer-overflow">buffer overflow</h4>
<p>This defect almost always results in a buffer overflow when data is copied to the new buffer.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Calculate string length in a correct way.   </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="o">*</span><span class="nf">bad</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">new_name</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">new_name</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="c1">//bad_alloc_strlen</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">new_name</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, use <code>strlen(name+1)</code> to indicate the length of p plus an extra byte for a null terminator.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="o">*</span><span class="nf">good</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">new_name</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">new_name</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
    <span class="n">strcpy</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">new_name</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, use <code>strlen(name)+1</code> to indicate the length of p plus an extra byte for a null terminator.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0069">Invalid Use of UNIX/Posix Function</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpecpted-result">unexpecpted result</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When using the following UNIX/Posix library functions, you need to follow the specified rules:
<code>open, openat, pthread_once, calloc, malloc, realloc, reallocf, alloca, __builtin_alloca, __builtin_alloca_with_align, valloc</code>。</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpecpted-result">unexpecpted result</h4>
<p>Incorrectly use of UNIX/Posix function may cause unexpected result.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Correctly use UNIX/Posix Function.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">mode</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">;</span>
  <span class="c1">// expected-warning{{Call to 'open' with more than 3 arguments}}</span>
  <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span> 
  <span class="k">if</span> <span class="p">(</span><span class="n">fd</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The above code incorrectly used open() function. When open function() is called, 4 parameters are passed, which exceeds the limit of the number of parameters of open() function.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>
  <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">);</span> <span class="c1">// no-warning</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">fd</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The above code correctly used open() function.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0070">Malloc Sizeof</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#buffer-overflow">buffer overflow</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Using malloc, calloc, or realloc functions to allocate memory will not match the size you expect to get. The intent is to use sizeof to calculate the size of the actual type, but the result is the size of the pointer.
This situation causes the allocated memory to be less than the expected allocation size, and finally results in undefined behavior, such as buffer overflow.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="buffer-overflow">buffer overflow</h4>
<p>The sizeof operation of the pointer during memory allocation causes the allocated memory to be less than the expected allocation size, and finally causes undefined behavior, such as buffer overflow.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Calculate the size of the memory correctly when applying for memory.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">A</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(){</span>
  <span class="k">struct</span> <span class="n">A</span> <span class="o">*</span><span class="n">ap1</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">A</span><span class="p">));</span>
  <span class="c1">// expected-warning {{Result of 'calloc' is converted to a pointer of //type 'struct A', which is incompatible with sizeof operand type </span>
  <span class="c1">// 'struct A *'}} </span>
  <span class="k">struct</span> <span class="n">A</span> <span class="o">*</span><span class="n">ap2</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ap1</span><span class="p">));</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the sizeof operation is performed on the pointer during memory allocation, resulting in less memory allocation than expected.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">A</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(){</span>
  <span class="k">struct</span> <span class="n">A</span> <span class="o">*</span><span class="n">ap1</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">A</span><span class="p">));</span>
  <span class="k">struct</span> <span class="n">A</span> <span class="o">*</span><span class="n">ap2</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">ap1</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the memory size is correctly calculated when applying for memory.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0110">Condition body is null</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the conditional discrimination is established, the corresponding branch has no execution statement.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>This is usually not the intention of the program. It may be due to negligence and the statement is omitted. It may cause a program error or incorrect program function.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>The corresponding branch cannot be empty when the conditional discrimination is established.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">//When the conditional discrimination is established, the </span>
    <span class="c1">//corresponding branch has no execution statement.</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">a</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.10 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0022">MISRA Cast</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#undefined-behavior">undefined behavior</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>MISRA-C 10.1. The value of an expression of integer type shall not be implicitly converted to a different type if:</p>
<ol>
<li>it is not a conversion to a wider type of the same signedness, or</li>
<li>the expression is complex, or</li>
<li>the expression is not constant and is a function argument, or</li>
<li>the expression is not constant and is a return expression</li>
</ol>
<p>MISRA-C 10.2. The value of an expression of floating type shall not be implicitly converted to a different type if any of the following are true:</p>
<ol>
<li>It is not a conversion to a wider floating type.</li>
<li>The expression is complex.</li>
<li>The expression is a function argument.</li>
<li>The expression is a return expression.</li>
</ol>
<p>MISRA-C 10.3. The value of a complex expression of integer type can only be cast to a type that is
narrower and of the same signedness as the underlying type of the expression.</p>
<p>MISRA-C 10.4. The value of a complex expression of floating type can only be cast to a narrower floating type.</p>
<p>MISRA-C 10.5. If the bitwise operators ~ and &lt;&lt; are applied to an operand of underlying type
unsigned char or unsigned short, the result shall be immediately cast to the underlying type of the operand</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="undefined-behavior">undefined behavior</h4>
<p>Explicit casts and implicit conversions that can, under some circumstances, lead to unexpected changes to integer or floating values in the course of evaluating expressions.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Check the type before cast.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">double</span> <span class="n">float64_t</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int32_t</span> <span class="n">xs32a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">xs32b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* Defect: Casting complex expression with</span>
<span class="cm">  integer type to a non-integer</span>
<span class="cm">  type float64_t */</span>
  <span class="p">(</span><span class="kt">void</span><span class="p">)(</span><span class="n">float64_t</span><span class="p">)(</span><span class="n">xs32a</span> <span class="o">/</span> <span class="n">xs32b</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, the complex expression xs32a/xs32b with an integer type is cast to noninteger type, and is thus a violation of Rule 10.3.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">double</span> <span class="n">float64_t</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int32_t</span> <span class="n">xs32a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">xs32b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">(</span><span class="kt">void</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)(</span><span class="n">xs32a</span> <span class="o">/</span> <span class="n">xs32b</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, the complex expression xs32a/xs32b with an integer type is cast to integer type.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0109">Bad operation for BSTR</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Perform address operations on variables of type BSTR.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Address operations on variables of type BSTR may result in erroneous memory access.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Perform address operations on variables of type BSTR.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">BSTR</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="n">a</span><span class="o">++</span><span class="p">;</span>  <span class="c1">//Perform address operations on variables of type BSTR.</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.3.6 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0108">Char less sign</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When defining a variable of the char data type, no symbol is specified.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>There is no explicit definition of whether the char data type is symbolic in the C language standard. Some compilers allow the use of compiler switches to switch whether the char type is signed or not, which may make the code difficult to port.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Indicate whether the char data type has a symbol, or define a data type by typedef or #define.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="s">"Hello, welcome!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>  <span class="c1">//char data type does not specify</span>
                                       <span class="c1">//whether there is a symbol</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">UCHAR</span><span class="p">;</span>
<span class="k">static</span> <span class="n">UCHAR</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="s">"Hello, welcome!</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.8 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0115">Inconsistent enumerator as case</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Multiple enumerator type are used in the same "switch" statement or in the "switch" tag statement, causing case tags to be inconsistent.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Inconsistent enumerator as case are usually caused by typing errors and may result in incorrect program functionality.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>低</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>If the variable type in the switch condition is an enumerated type, the case label should be an enumeration member of the enumerated type.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">enum</span> <span class="n">A</span><span class="p">{</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">}</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">B</span><span class="p">{</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">}</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="k">case</span> <span class="nl">b1</span><span class="p">:</span> <span class="p">...;</span> <span class="k">break</span><span class="p">;</span>  <span class="c1">//Inconsistent case label</span>
    <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">enum</span> <span class="n">A</span><span class="p">{</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">}</span> <span class="n">A</span><span class="p">;</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">B</span><span class="p">{</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">}</span> <span class="n">B</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">example_fun</span><span class="p">(</span><span class="n">A</span> <span class="n">a</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="k">case</span> <span class="nl">a1</span><span class="p">:</span> <span class="p">...;</span> <span class="k">break</span><span class="p">;</span> 
    <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.13 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0124">Self comparison or division</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Self comparison or division.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Dividing or comparing itself is usually not the intention of the program. There may be typing errors in the program. Dividing itself may cause program errors or incorrect program functions. Self-comparison may cause some code never be executed.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Fix typing error.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">)</span>   <span class="c1">//a&lt;a is always false</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">example_fun</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> 
  <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.11 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                <a href="../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/concurrency and temporal errors.html">Concurrency and temporal errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0060">PThread Lock Error</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/concurrency-and-temporal-errors.html">Concurrency and temporal errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#dead-lock">dead lock</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example1-double-locking">Vulnerable Code Example1: Double locking</a></li>
<li><a href="#fixed-code-example1">Fixed Code Example1</a></li>
<li><a href="#vulnerable-code-example2-locking-order-reversal">Vulnerable Code Example2: Locking order reversal</a></li>
<li><a href="#fixed-code-example2">Fixed Code Example2</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>All lock/unlock operations for mutexes must be for the same module and at the same level of abstraction. Otherwise, it may cause some lock/unlock operations not to be performed according to the multi-threaded design, which eventually leads to the outbreak of other vulnerabilities such as deadlocks and resource competition. In the process of unlocking the locked object, the wrong unlocking order is likely to cause a deadlock.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="dead-lock">dead lock</h4>
<p>Improper lock/unlock operations result in deadlocks, resource competition, and so on.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Perform the lock/unlock operation correctly. To solve deadlock problem, we could adjust the resource request order, or add the sleep operation.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example1-double-locking">Vulnerable Code Example1: Double locking</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">pthread_mutex_t</span> <span class="n">mtx1</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// no-warning</span>
  <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span>    
  <span class="c1">// expected-warning{{This lock has already been acquired}}</span>
  <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span>    
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the same object mtx1 is repeatedly locked.</p>
<h3 id="fixed-code-example1">Fixed Code Example1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">pthread_mutex_t</span> <span class="n">mtx1</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span>    <span class="c1">// no-warning</span>
  <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span>  <span class="c1">// no-warning</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, mtx1 is first locked and then unlocked.</p>
<h3 id="vulnerable-code-example2-locking-order-reversal">Vulnerable Code Example2: Locking order reversal</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Mutex</span> <span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">;</span>

<span class="cm">/* Thread 1 */</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">NonCriticalSection</span><span class="p">()</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
   <span class="n">CriticalSection</span><span class="p">();</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Thread 2 */</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">NonCriticalSection</span><span class="p">()</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
   <span class="n">CriticalSection</span><span class="p">();</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, thread 1 and thread 2 preempt M1, M2 resources and wait for the other release resources, which will lead to deadlock problem.</p>
<h3 id="fixed-code-example2">Fixed Code Example2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Mutex</span> <span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">;</span>

<span class="cm">/* Thread 1 */</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">NonCriticalSection</span><span class="p">()</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
   <span class="n">CriticalSection</span><span class="p">();</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Thread 2 */</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">NonCriticalSection</span><span class="p">()</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
   <span class="n">Mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
   <span class="n">CriticalSection</span><span class="p">();</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M2</span><span class="p">);</span>
   <span class="n">Mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, the order of the process 1 and the process 2 requesting the resources M1 and M2 is modified, which prevent the occurrence of a deadlock.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1010">Free stack memory allocated by alloca()</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>alloca() allocates size bytes from the program stack. The allocated space is automatically freed when the calling function exits (not when the allocation merely passes out of scope). Therefore, do not pass the pointer value returned by <code>_alloca</code> as an argument to free.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Free stack memory allocated by alloca() will cause the program to crash.</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Do not free stack memory allocated by alloca().</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>High</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">alloca</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>  <span class="c1">//error</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed code example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">alloca</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0053">Cast Size Error</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#buffer-overruns">buffer overruns</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The size of allocated buffer is not a multiple of the size of the containing data type. It could lead to buffer overruns.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="buffer-overruns">buffer overruns</h4>
<p>The size of allocated buffer is not a multiple of the size of the containing data type. It could lead to buffer overruns.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Allocate buffer with size that is a multiple of the size of its containing data type.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// expected-warning{{Cast a region whose size is not a multiple of the </span>
  <span class="c1">// destination type size}} </span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> 
  <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>The size of allocated buffer is not a multiple of the size of the containing data type.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span> 
  <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p><code>malloc</code> allocates buffer with size that is a multiple of the size of <code>int</code>.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0074">Invalid Use of va_list</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-results">Unexpected results</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example-1">Vulnerable code Example 1</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Steps to use VA_LIST</p>
<ol>
<li>declare a variable with VA_LIST data type, it will point to vary arguments.</li>
<li>use VA_START macro to initialize the VA_LIST variable we just defined.</li>
<li>use VA_ARG macro to obtain each argument, the second parameter of VA_ARG indicates data type of the argument you are obtaining. Call VA_ARG repeatedly to obtain more vary arguments.</li>
<li>use VA_END to end the process of getting vary arguments.</li>
</ol>
<p>Using VA_LIST incorrectly could produce unexpected results.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-results">Unexpected results</h4>
<p>Using VA_LIST incorrectly could produce unexpected results.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use VA_LIST correctly.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example-1">Vulnerable code Example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad1</span><span class="p">(</span><span class="kt">int</span> <span class="n">fst</span><span class="p">,</span> <span class="p">...)</span> <span class="p">{</span>
  <span class="kt">va_list</span> <span class="n">va</span><span class="p">;</span>
  <span class="c1">// expected-warning{{va_arg() is called on an uninitialized va_list}} </span>
  <span class="c1">// expected-note{{va_arg() is called on an uninitialized va_list}} </span>
  <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">va_arg</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>Use of uninitilized <code>va_list</code> variable <code>va</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad2</span><span class="p">(</span><span class="kt">int</span> <span class="n">fst</span><span class="p">,</span> <span class="p">...)</span> <span class="p">{</span>
  <span class="kt">va_list</span> <span class="n">va</span><span class="p">;</span>
  <span class="c1">// expected-warning{{va_list 'va' is copied onto itself}} </span>
  <span class="c1">// expected-note{{va_list 'va' is copied onto itself}} </span>
  <span class="n">va_copy</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">va</span><span class="p">);</span>
<span class="p">}</span> 

<span class="err">```</span><span class="n">c</span>
<span class="n">There</span> <span class="n">is</span> <span class="n">no</span> <span class="n">meaning</span> <span class="n">on</span> <span class="n">copying</span> <span class="err">`</span><span class="n">va</span><span class="err">`</span> <span class="n">itself</span><span class="p">.</span>

<span class="cp">### Fixed Code Example 1</span>

<span class="err">```</span><span class="n">c</span>
<span class="kt">void</span> <span class="n">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">fst</span><span class="p">,</span> <span class="p">...)</span> <span class="p">{</span>
  <span class="kt">va_list</span> <span class="n">va</span><span class="p">;</span>
  <span class="n">va_start</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="n">fst</span><span class="p">);</span> <span class="c1">// Initialized va_list</span>
  <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">va_arg</span><span class="p">(</span><span class="n">va</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>Initialize <code>va_list</code> variable <code>va</code> before use.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0117">Error initialization order</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When you initialize a member of a class, it does not match the order of the members in the list.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Incorrect initialization list member order may cause some members to be incorrectly initialized.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Members should be initialized in the order of the members of the list.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span>
<span class="p">{</span>
    <span class="n">MyClass1</span> <span class="n">mc1</span><span class="p">;</span>
    <span class="n">MyClass2</span> <span class="n">mc2</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
    <span class="c1">//The order in which members are initialized is inconsistent with the //order of members in the list</span>
    <span class="n">MyClass</span><span class="p">()</span> <span class="o">:</span> <span class="n">MyClass2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">MyClass1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">{}</span>  
<span class="p">};</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.6.5 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/memory and resource misuse.html">Memory and resource misuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0006">Incorrect operation with BSTR values</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/memory-and-resource-misuse.html">Memory and resource misuse</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#incorrect-memory-usage">incorrect memory usage</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Comparison operations cannot be used for BSTR values because they are meaningless in the BSTR context, and if they are not corrected, they can result in incorrect memory usage.
Because of the two different styles of construction, the COM style BSTR strings and C style strings need to be pampered. In some cases, the conversion between the two is well-compiled, but it still produces unexpected results.</p>
<p>Comparisons of BSTR expressions using relational operators &gt;, &lt;, &gt;=, and &lt;= are reported as defects.
The reason for considering this comparison as a defect is that although the BSTR variable is technically a pointer, it should normally be considered as an opaque type. Only valid comparisons are == and! =.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="incorrect-memory-usage">incorrect memory usage</h4>
<p>Comparison operations cannot be used for BSTR values because they are meaningless in the BSTR context, and if they are not corrected, they can result in incorrect memory usage.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>It is best not to use BSTRs in new designs.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(</span><span class="n">BSTR</span> <span class="n">b1</span><span class="p">,</span> <span class="n">BSTR</span> <span class="n">b2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">b1</span> <span class="o">&gt;</span> <span class="n">b2</span><span class="p">)</span> <span class="p">{</span> 
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, using '&gt;' to compare two BSTR values at line 2.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(</span><span class="n">BSTR</span> <span class="n">b1</span><span class="p">,</span> <span class="n">BSTR</span> <span class="n">b2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">b1</span> <span class="o">==</span> <span class="n">b2</span><span class="p">)</span> <span class="p">{</span> 
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, using '==' to compare two BSTR values at line 2.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/type and encapsulation.html">Type and encapsulation</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0122">Excessive padding</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/type-and-encapsulation.html">Type and encapsulation</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The byte position of a member in a struct depends on the compiler's <code>#pragma align</code> and <code>#pragma pack</code> preprocessor directives.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The byte position of a member in a struct depends on the compiler's <code>#pragma align</code> and <code>#pragma pack</code> preprocessor directives, which can cause problems when the code is ported.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Reorder the members of the struct so that the member's starting position and size are not affected by the compiler's <code>#pragma align</code> and <code>#pragma pack</code> preprocessing directives.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">ST</span> 
<span class="p">{</span>
    <span class="n">UINT16_t</span> <span class="n">a</span><span class="p">;</span>
    <span class="n">UINT32_t</span> <span class="n">b</span><span class="p">;</span>  <span class="c1">//b member may start from the 3rd byte of the struct, </span>
                 <span class="c1">//or may start from the 5th byte</span>
    <span class="n">UINT16_t</span> <span class="n">c</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">ST</span> 
<span class="p">{</span>
     <span class="n">UINT16_t</span> <span class="n">a</span><span class="p">;</span>
     <span class="n">UINT16_t</span> <span class="n">b</span><span class="p">;</span>
     <span class="n">UINT32_t</span> <span class="n">c</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.3.20 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0105">Assignment in argument</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Assignment in argument.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The order of evaluation in the C standard is not defined, so using syntax shortcuts when porting on different compilers may have operational implications. This assignment does not always occur before the function call, and will produce different results on different platforms.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assignment in argument.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun1</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">example_fun2</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">example_fun1</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>  <span class="c1">//Assignment in argument</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">example_fun1</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">example_fun2</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">example_fun1</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> 
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.2.4  <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0127">swapped arguments</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the function is called, the order of the actual participating parameters is inconsistent.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>When the function is called, the inconsistent order of the actual participating parameters will cause the program function to be implemented incorrectly.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>When the function is called, the order of the actual participating parameters is the same.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">authenticate</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">username</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span> 
<span class="p">{</span> 
  <span class="c1">// Verify the correctness of the username and password</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">exampleFun</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">bool</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">username</span><span class="p">);</span>  <span class="c1">//The order of the actual                       //participation parameters passed is inconsistent. </span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">authenticate</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">username</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">)</span> 
<span class="p">{</span> 
  <span class="c1">// Verify the correctness of the username and password</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">exampleFun</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">bool</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-hangbiao">
<p>SJ/T 11682-2017 6.4.5 <a class="footnote-backref" href="#fnref-hangbiao" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0026">Overflow Before Widen</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#overflow">Overflow</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The value of an arithmetic expression is subject to overflow due to a failure to cast operands to a larger data type before performing arithmetic. The failure to cast can yield an unexpected value.</p>
<p>For example, an operation that multiplies two integers might yield a value other than a product that results from using arbitrary precision integers (for example, a value other than what a calculator produces when you multiply the two numbers). The checker reports a defect only if it finds some indication that the extra precision is desired.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="overflow">Overflow</h4>
<p>The failure to cast can yield an unexpected value.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>To obtain the result overflow, a cast on one of the operands is required.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">2147483648</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">z</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">z</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// detect</span>
    <span class="c1">// Do something.</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example,  x * y exceeds the maximum value allowed by the unsigned type for the target platform (2^32 − 1, that is, 4,294,967,295).</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">2147483648</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">z</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(((</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">z</span><span class="p">)</span> <span class="p">{</span> 
    <span class="c1">// Do something.</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, cast x to unsigned long long before multiplication arithmetic expression.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0046">Negative Returns</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#program-crashes">program crashes</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Negative integers and function return values that can potentially be negative must be checked before being used (for example, as array indexes, loop bounds, algebraic expression variables or size/length arguments to a system call). Negative integer misuses can cause memory corruption, process crashes, infinite loops, integer overflows, and security defects (if a user is able to control improperly checked input).
Common negative integer misuses include:</p>
<ul>
<li>Assigning a negative value to a signed integer variable before using it as a static array index.</li>
<li>Using a negative function return value either directly or by casting it to an unsigned integer.</li>
</ul>
<p>A signed, negative integer implicitly cast to an unsigned integer will yield a very large value. If that value is incorrectly bounds-checked before being used, a process can, for example, allocate too much memory, allow a loop to process too long, overrun and corrupt memory, or yield an integer overflow. These defects are inherently hard to detect because their repercussions may not immediately appear during process execution.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="program-crashes">program crashes</h4>
<p>Negative integer misuses can cause memory corruption, process crashes, infinite loops, integer overflows, and security defects (if a user is able to control improperly checked input).</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Low</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Negative integers and function return values that can potentially be negative must be checked before being used.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">some_function</span><span class="p">();</span>

<span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">buff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">some_function</span><span class="p">();</span> <span class="c1">// some_function() might return -1</span>
  <span class="n">buff</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Defect: buffer underrun at buff[-1]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, some_function() might return negative integer when it is used as array index.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">some_function</span><span class="p">();</span>

<span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">buff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">some_function</span><span class="p">();</span> <span class="c1">// some_function() might return -1</span>
  <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">buff</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the invulnerable code example, the return value of function some_function() is checked before being used.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0013">Missing Copy Or Assign</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#wild-pointer">wild pointer</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Own resources such as dynamically allocated memory or operating system handles but lack either a user-written copy constructor or a user-written assignment operator.</p>
<p>A class is considered to own resources if at least one constructor allocates resources and retains them in fields of this and the destructor releases resources from fields of this. Not only must such a class have a copy constructor and an assignment operator but those functions must manage the resources.</p>
<p>In order to be considered as an assignment operator for the purposes of this rule  an assignment operator must be usable to assign entire objects. Private copy constructors or assignment operators are assumed not to be meant for use and are not required to manage resources.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="wild-pointer">wild pointer</h4>
<p>Own resources such as dynamically allocated memory or operating system handles but lack either a user-written copy constructor or a user-written assignment operator will lead to wild pointer.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Provide a user-written copy constructor or a user-written assignment operator if the class own resources such as dynamically allocated memory or operating system handles.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">bad</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>
  <span class="n">bad</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="o">:</span> <span class="n">p</span><span class="p">(</span><span class="n">_strdup</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="p">{}</span>
  <span class="o">~</span><span class="n">bad</span><span class="p">()</span> <span class="p">{</span> <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="p">}</span>

  <span class="c1">// no copy constructor at all</span>
  <span class="c1">// no assignment operator at all</span>
  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">p</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">operator</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">str</span><span class="p">();</span> <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example  Class bad owns resources has no user-written copy constructor or user-written assignment operator. The compiler-generated copy constructor or assignment operator does not properly manage owned resources.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">good</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>
  <span class="c1">// copy constructor</span>
  <span class="n">good</span><span class="p">(</span><span class="k">const</span> <span class="n">good</span> <span class="o">&amp;</span><span class="n">init</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">){</span>
      <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">init</span><span class="p">.</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">init</span><span class="p">.</span><span class="n">p</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// assignment operator</span>
  <span class="n">good</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">good</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">!=</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">){</span>
        <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">rhs</span><span class="p">.</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
      <span class="n">strcpy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">rhs</span><span class="p">.</span><span class="n">p</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="o">~</span><span class="n">good</span><span class="p">()</span> <span class="p">{</span> <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">p</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">operator</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">str</span><span class="p">();</span> <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example  provide a user-written copy constructor or a user-written assignment operator.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/logic errors.html">Logic errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0009">Char I/O Return Error</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/logic-errors.html">Logic errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#truncate-value-error">truncate value error</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Functions fgetc(), getc(), getchar(), and istream::get(), which return int values, not char values. Assigning an int value to a char variable truncates the value. If the char variable is unsigned, the loworder 8 bits of the int value are not put into the char variable, which is a modulo operation if the int value is non-negative. If the int value is -1, the low-order 8 bits of the representation of -1 are put into the char variable, which results in a value of 255. If the char variable is signed, an int value of -1 remains -1 in the char variable, but any int value greater than 127 becomes a negative value in the char variable. Using a signed char variable is also unsafe. A stray ӱ character (0xFF) will cause the program to erroneously think that EOF is reached. The C standard requires that such functions be passed an integer in the range of -1 to 255. A signed char variable can potentially have values as low as -128.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="truncate-value-error">truncate value error</h4>
<p>Assigning an int value to a char variable truncates the value.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Assigning the return value of functions fgetc(), getc(), getchar(), and istream::get() to a int value.  </p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">getc</span><span class="p">(</span><span class="n">stdin</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, returns an int value to variable c, which is a char value at line 3.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="n">i</span> <span class="o">=</span> <span class="n">getc</span><span class="p">(</span><span class="n">stdin</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, returns an int value to variable i, which is a int value at line 3.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../standard/objective-c.html">objective-c</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../subcategory/objective-c/quality issues/api abuse.html">API abuse</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0025">Less Open Function Mode</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../category/api-abuse.html">API abuse</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#insecure-file-permissions">Insecure File Permissions</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The open() system call converts a pathname into a file descriptor. You can pass flags to open() specifying various options including the file's access permissions (read/write, read only, or write only), whether to create the file if it does not exist (O_CREAT), and whether the file can be appended to.</p>
<p>If you call open() with the O_CREAT option, you should also, for safety, pass an argument (mode argument) that explicitly sets the file's permissions.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="insecure-file-permissions">Insecure File Permissions</h4>
<p>Creating a file with insufficiently restrictive access permissions may allow an unprivileged user to access that file. Although access permissions are heavily dependent on the file system, many file-creation functions provide mechanisms to set (or at least influence) access permissions. When these functions are used to create files, appropriate access permissions should be specified to prevent unintended access.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>when call open() with the O_CREAT option, add mode argument.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">file_name</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>

    <span class="cm">/* Initialize file_name */</span>

    <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">O_WRONLY</span><span class="p">);</span>
    <span class="cm">/* Access permissions were missing */</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">fd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
        <span class="cm">/* Handle error */</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the vulnerable code example, Using the POSIX open() function to create a file but failing to provide access permissions for that file may cause the file to be created with overly permissive access permissions. This omission has been known to lead to vulnerabilities—for example, CVE-2006-1174.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">file_name</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">file_access_permissions</span><span class="p">;</span>

    <span class="cm">/* Initialize file_name and file_access_permissions */</span>
    <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span>
        <span class="n">file_name</span><span class="p">,</span>
        <span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">O_WRONLY</span><span class="p">,</span>
        <span class="n">file_access_permissions</span>
    <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
        <span class="cm">/* Handle error */</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the fixed code example, Access permissions for the newly created file should be specified in the third argument to open(). Again, the permissions are modified by the value of umask().</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../tag/c.html">C</a>
                <a href="../../tag/cpp.html">CPP</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Rights reserve
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>