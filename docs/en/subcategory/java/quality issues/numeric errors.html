
<!DOCTYPE html>
<html lang="en">

<head>
    <link href='../../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../../theme/stylesheet/normalize.min.css">
    <script src="../../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../../..">
                <img src="../../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="Input to search">
            </form>
        </div>


        <ul class="global_lang">
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../../standard/language-independent.html">Language Independent documents</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../../standard/c.html">c/c++ documents</a>
                        (317)
                    </li>
                    <li>
                        <a href="../../../standard/csharp.html">csharp documents</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../../standard/golang.html">golang documents</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../../standard/java.html">java documents</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../../standard/javascript.html">javascript documents</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../../standard/objective-c.html">objective-c documents</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../../standard/python.html">python documents</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../../standard/shell.html">shell documents</a>
                        (334)
                    </li>
                    <li>
                        <a href="../../../standard/swift.html">swift documents</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            Numeric errors (23)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7415">Overwritten increment</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Overwritten increment</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The code performs an increment operation (e.g., <code>i++</code>) and then
immediately overwrites it. For example, <code>i = i++</code> immediately
overwrites the incremented value with the original value.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7094">Bad attempt to compute absolute value of signed 32-bit hashcode</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Bad attempt to compute absolute value of signed 32-bit hashcode</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code generates a hashcode and then computes
the absolute value of that hashcode.  If the hashcode
is <code>Integer.MIN_VALUE</code>, then the result will be negative as well (since
<code>Math.abs(Integer.MIN_VALUE) == Integer.MIN_VALUE</code>).
</p>
<p>One out of 2^32 strings have a hashCode of Integer.MIN_VALUE,
including "polygenelubricants" "GydZG_" and ""DESIGNING WORKHOUSES".
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7326">Check for sign of bitwise operation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Check for sign of bitwise operation</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This method compares an expression such as
<code>((event.detail &amp; SWT.SELECTED) &gt; 0)</code>.
Using bit arithmetic and then comparing with the greater than operator can
lead to unexpected results (of course depending on the value of
SWT.SELECTED). If SWT.SELECTED is a negative number, this is a candidate
for a bug. Even when SWT.SELECTED is not negative, it seems good practice
to use '!= 0' instead of '&gt; 0'.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7098">Incorrect combination of Math.max and Math.min</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Incorrect combination of Math.max and Math.min</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>This code tries to limit the value bounds using the construct like Math.min(0, Math.max(100, value)). However the order of
  the constants is incorrect: it should be Math.min(100, Math.max(0, value)). As the result this code always produces the same result
  (or NaN if the value is NaN).</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7093">Bad attempt to compute absolute value of signed random integer</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Bad attempt to compute absolute value of signed random integer</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code generates a random signed integer and then computes
the absolute value of that random integer.  If the number returned by the random number
generator is <code>Integer.MIN_VALUE</code>, then the result will be negative as well (since
<code>Math.abs(Integer.MIN_VALUE) == Integer.MIN_VALUE</code>). (Same problem arises for long values as well).
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7394">Integral division result cast to double or float</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Integral division result cast to double or float</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
This code casts the result of an integral division (e.g., int or long division)
operation to double or
float.
Doing division on integers truncates the result
to the integer value closest to zero.  The fact that the result
was cast to double suggests that this precision should have been retained.
What was probably meant was to cast one or both of the operands to
double <em>before</em> performing the division.  Here is an example:
</p>
<pre><code>int x = 2;
int y = 5;
// Wrong: yields result 0.0
double value1 = x / y;</code></pre></p>
<p>// Right: yields result 0.4
double value2 = x / (double) y;
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7395">Integral value cast to double and then passed to Math.ceil</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Integral value cast to double and then passed to Math.ceil</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
This code converts an integral value (e.g., int or long)
to a double precision
floating point number and then
passing the result to the Math.ceil() function, which rounds a double to
the next higher integer value. This operation should always be a no-op,
since the converting an integer to a double should give a number with no fractional part.
It is likely that the operation that generated the value to be passed
to Math.ceil was intended to be performed using double precision
floating point arithmetic.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7096">Remainder of hashCode could be negative</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Remainder of hashCode could be negative</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code computes a hashCode, and then computes
the remainder of that value modulo another value. Since the hashCode
can be negative, the result of the remainder operation
can also be negative. </p>
<p> Assuming you want to ensure that the result of your computation is nonnegative,
you may need to change your code.
If you know the divisor is a power of 2,
you can use a bitwise and operator instead (i.e., instead of
using <code>x.hashCode()%n</code>, use <code>x.hashCode()&amp;(n-1)</code>).
This is probably faster than computing the remainder as well.
If you don't know that the divisor is a power of 2, take the absolute
value of the result of the remainder operation (i.e., use
<code>Math.abs(x.hashCode()%n)</code>).
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7393">Result of integer multiplication cast to long</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Result of integer multiplication cast to long</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
This code performs integer multiply and then converts the result to a long,
as in:</p>
<pre><code>long convertDaysToMilliseconds(int days) { return 1000<em>3600</em>24<em>days; }
</em></code></pre>
<p>
If the multiplication is done using long arithmetic, you can avoid
the possibility that the result will overflow. For example, you
could fix the above code to:</p>
<pre><code>long convertDaysToMilliseconds(int days) { return 1000L</code></pre></p>3600<em>24</em>days; }

<p>
or
</p>
<pre><code>static final long MILLISECONDS_PER_DAY = 24L<em>3600</em>1000;
long convertDaysToMilliseconds(int days) { return days * MILLISECONDS_PER_DAY; }
</code></pre>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7418">Integer multiply of result of integer remainder</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Integer multiply of result of integer remainder</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The code multiplies the result of an integer remaining by an integer constant.
Be sure you don't have your operator precedence confused. For example
i % 60 * 1000 is (i % 60) * 1000, not i % (60 * 1000).
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7097">Random value from 0 to 1 is coerced to the integer 0</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Random value from 0 to 1 is coerced to the integer 0</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>A random value from 0 to 1 is being coerced to the integer value 0. You probably
want to multiply the random value by something else before coercing it to an integer, or use the <code>Random.nextInt(n)</code> method.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0062">Divide By Zero</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#code-example-1">Code example 1</a></li>
<li><a href="#fixed-code-example-1">Fixed code example 1</a></li>
<li><a href="#code-example-2">Code example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed code example 2</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Division and remainder operations performed on integers are susceptible to divide-by-zero errors. Consequently, the divisor in a division or remainder operation on integer types must be checked for zero prior to the operation. Division and remainder operations performed on floating-point numbers are not subject to this rule.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>If the divisor is zero, the program will crash during execution.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Check whether the divisor is zero or not before running any division, especially it is divided by other uncerntain value, i.e., some calculation result.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="code-example-1">Code example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">bad</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">){</span>
  <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above program, b is zero, when it executes "a/b", the divisor is zero, program crashes.</p>
<h3 id="fixed-code-example-1">Fixed code example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">good</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">){</span>
  <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above program, b is checked before running "a/b", which guarantees no divisor is zero.</p>
<h3 id="code-example-2">Code example 2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">test_bad</span><span class="o">{</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">ret</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">){</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">ret</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="o">);</span>  <span class="c1">// @@bad@@</span>
<span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>In the above program, b is zero, when it executes "a/b", the divisor is zero, program crashes.</p>
<h3 id="fixed-code-example-2">Fixed code example 2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">test_good</span><span class="o">{</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">ret</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">){</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">ret</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="o">);</span>  <span class="c1">// @@good@@</span>
<span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>In the above program, b is checked before running "a/b", which guarantees no divisor is zero.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CERT-INT33-C">
<p>https://wiki.sei.cmu.edu/confluence/display/c/INT33-C.+Ensure+that+division+and+remainder+operations+do+not+result+in+divide-by-zero+errors <a class="footnote-backref" href="#fnref-CERT-INT33-C" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT-NUM02-J">
<p>https://wiki.sei.cmu.edu/confluence/display/java/NUM02-J.+Ensure+that+division+and+remainder+operations+do+not+result+in+divide-by-zero+errors <a class="footnote-backref" href="#fnref-CERT-NUM02-J" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn-CWE369">
<p>cwe.mitre.org/data/definitions/369.html <a class="footnote-backref" href="#fnref-CWE369" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/java.html">Java</a>
                <a href="../../../tag/csharp.html">CSHARP</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7424">Unsigned right shift cast to short/byte</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Unsigned right shift cast to short/byte</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The code performs an unsigned right shift, whose result is then
cast to a short or byte, which discards the upper bits of the result.
Since the upper bits are discarded, there may be no difference between
a signed and unsigned right shift (depending upon the size of the shift).
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7396">int value cast to float and then passed to Math.round</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>int value cast to float and then passed to Math.round</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
This code converts an int value to a float precision
floating point number and then
passing the result to the Math.round() function, which returns the int/long closest
to the argument. This operation should always be a no-op,
since the converting an integer to a float should give a number with no fractional part.
It is likely that the operation that generated the value to be passed
to Math.round was intended to be performed using
floating point arithmetic.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7536">Bad hexadecimal concatenation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Bad hexadecimal concatenation</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>When converting a byte array containing a hash signature to a human readable string, a conversion mistake can be made if 
the array is read byte by byte. The following sample illustrates the use of Integer.toHexString() which will trim any leading zeroes
from each byte of the computed hash value.
<pre><code>MessageDigest md = MessageDigest.getInstance("SHA-256");
byte[] resultBytes = md.digest(password.getBytes("UTF-8"));
StringBuilder stringBuilder = new StringBuilder();
for(byte b :resultBytes) {
    stringBuilder.append( Integer.toHexString( b &amp; 0xFF ) );
}
return stringBuilder.toString();</code></pre>
</p>
<p>
This mistake weakens the hash value computed since it introduces more collisions. 
For example, the hash values "0x0679" and "0x6709" would both output as "679" for the above function.
</p></p>
<p>
In this situation, the use of toHexString() should be replaced with String.format() as follows:
<pre>stringBuilder.append( String.format( "%02X", b ) );</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://cwe.mitre.org/data/definitions/704.html">CWE-704: Incorrect Type Conversion or Cast</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7095">Remainder of 32-bit signed random integer</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Remainder of 32-bit signed random integer</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code generates a random signed integer and then computes
the remainder of that value modulo another value. Since the random
number can be negative, the result of the remainder operation
can also be negative. Be sure this is intended, and strongly
consider using the Random.nextInt(int) method instead.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7324">Bitwise add of signed byte value</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Bitwise add of signed byte value</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> Adds a byte value and a value which is known to have the 8 lower bits clear.
Values loaded from a byte array are sign extended to 32 bits
before any bitwise operations are performed on the value.
Thus, if <code>b[0]</code> contains the value <code>0xff</code>, and
<code>x</code> is initially 0, then the code
<code>((x &lt;&lt; 8) + b[0])</code>  will sign extend <code>0xff</code>
to get <code>0xffffffff</code>, and thus give the value
<code>0xffffffff</code> as the result.
</p></p>
<p>In particular, the following code for packing a byte array into an int is badly wrong: </p>
<pre><code>int result = 0;
for(int i = 0; i &lt; 4; i++)
    result = ((result &lt;&lt; 8) + b[i]);
</code></pre>
<p>The following idiom will work instead: </p>
<pre><code>int result = 0;
for(int i = 0; i &lt; 4; i++)
    result = ((result &lt;&lt; 8) + (b[i] &amp; 0xff));
</code></pre>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7419">Check for oddness that won't work for negative numbers</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Check for oddness that won't work for negative numbers</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The code uses x % 2 == 1 to check to see if a value is odd, but this won't work
for negative numbers (e.g., (-5) % 2 == -1). If this code is intending to check
for oddness, consider using x &amp; 1 == 1, or x % 2 != 0.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7392">int value converted to long and used as absolute time</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>int value converted to long and used as absolute time</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
This code converts a 32-bit int value to a 64-bit long value, and then
passes that value for a method parameter that requires an absolute time value.
An absolute time value is the number
of milliseconds since the standard base time known as "the epoch", namely January 1, 1970, 00:00:00 GMT.
For example, the following method, intended to convert seconds since the epoch into a Date, is badly
broken:</p>
<pre><code>Date getDate(int seconds) { return new Date(seconds * 1000); }
</code></pre>
<p>The multiplication is done using 32-bit arithmetic, and then converted to a 64-bit value.
When a 32-bit value is converted to 64-bits and used to express an absolute time
value, only dates in December 1969 and January 1970 can be represented.</p></p>
<p>Correct implementations for the above method are:</p>
<pre><code>// Fails for dates after 2037
Date getDate(int seconds) { return new Date(seconds * 1000L); }

// better, works for all dates
Date getDate(long seconds) { return new Date(seconds * 1000); }
</code></pre>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7325">Bitwise OR of signed byte value</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Bitwise OR of signed byte value</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> Loads a byte value (e.g., a value loaded from a byte array or returned by a method
with return type byte)  and performs a bitwise OR with
that value. Byte values are sign extended to 32 bits
before any bitwise operations are performed on the value.
Thus, if <code>b[0]</code> contains the value <code>0xff</code>, and
<code>x</code> is initially 0, then the code
<code>((x &lt;&lt; 8) | b[0])</code>  will sign extend <code>0xff</code>
to get <code>0xffffffff</code>, and thus give the value
<code>0xffffffff</code> as the result.
</p></p>
<p>In particular, the following code for packing a byte array into an int is badly wrong: </p>
<pre><code>int result = 0;
for(int i = 0; i &lt; 4; i++) {
    result = ((result &lt;&lt; 8) | b[i]);
}
</code></pre>
<p>The following idiom will work instead: </p>
<pre><code>int result = 0;
for(int i = 0; i &lt; 4; i++) {
    result = ((result &lt;&lt; 8) | (b[i] &amp; 0xff));
}
</code></pre>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7385">Doomed test for equality to NaN</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Doomed test for equality to NaN</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    This code checks to see if a floating point value is equal to the special
    Not A Number value (e.g., <code>if (x == Double.NaN)</code>). However,
    because of the special semantics of <code>NaN</code>, no value
    is equal to <code>Nan</code>, including <code>NaN</code>. Thus,
    <code>x == Double.NaN</code> always evaluates to false.</p>
<p>To check to see if a value contained in <code>x</code>
    is the special Not A Number value, use
    <code>Double.isNaN(x)</code> (or <code>Float.isNaN(x)</code> if
    <code>x</code> is floating point precision).
    </p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0021">Integer Overflow</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a><ul>
<li><a href="#unexpected-execution-result">Unexpected execution result</a></li>
</ul>
</li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example-1">Fixed Code Example 1</a></li>
<li><a href="#fixed-code-example-2">Fixed Code Example 2</a></li>
</ul>
</li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the result of an expression exceeds the range of the data type, the result shall be different from the arithmetic result, which might lead to unexpected results if arithmetic sementic is assumed, for example, the addition of two positive numbers might be smaller than either of the two numbers, or the sum of two non-zero unsigned numbers can be zero.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<h4 id="unexpected-execution-result">Unexpected execution result</h4>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical (If arithmetic result is expected, such as computing resource consumption or financial statistics)
Safe (If logical result is expected, such as computing hash or encryption)</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Verify the value range before use it.
Use a data type with larger range.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">4000000000</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">4000000000</span><span class="p">;</span>
<span class="kt">bool</span> <span class="nf">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">);</span> <span class="c1">// Return false</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, x+y exceeds the upper bound of unsigned int which is 4294967295 and thus, the higher bits are lost and the result is unexpectedly smaller than either x or y.</p>
<h3 id="fixed-code-example-1">Fixed Code Example 1</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">4000000000</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">4000000000</span><span class="p">;</span>
<span class="kt">bool</span> <span class="nf">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">);</span> <span class="c1">// Return true</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, use 64 bit long long instead of int can resolver the integer overflow issue.</p>
<h3 id="fixed-code-example-2">Fixed Code Example 2</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">4000000000</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">4000000000</span><span class="p">;</span>
<span class="kt">bool</span> <span class="nf">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">2000000000</span> <span class="o">||</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">2000000000</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Error handling</span>
        <span class="p">...</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">);</span> <span class="c1">// Return true</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
<p>In the above code, apply range check can also resolve the integer overflow issue.</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">C</a>
                <a href="../../../tag/cpp.html">CPP</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues.html">Quality issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/quality issues/numeric errors.html">Numeric errors</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7327">Check for sign of bitwise operation involving negative number</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/numeric-errors.html">Numeric errors</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Check for sign of bitwise operation involving negative number</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This method compares a bitwise expression such as
<code>((val &amp; CONSTANT) &gt; 0)</code> where CONSTANT is the negative number.
Using bit arithmetic and then comparing with the greater than operator can
lead to unexpected results. This comparison is unlikely to work as expected. The good practice is
to use '!= 0' instead of '&gt; 0'.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Rights reserve
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>