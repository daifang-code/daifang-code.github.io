
<!DOCTYPE html>
<html lang="en">

<head>
    <link href='../../../theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="../../../theme/stylesheet/normalize.min.css">
    <script src="../../../theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="../../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../../theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="../../../theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="../../../theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="../../../theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="../../../theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">      <meta name="author" content="Pinpoint Team"/>
    <meta name="description" content="Manual and documents for Sourcebrella Pinpoint"/> <meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="Pinpoint Document"/>
<meta property="og:description" content="Manual and documents for Sourcebrella Pinpoint"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="../../.."/>
 
    <title>Pinpoint Document &ndash; Category</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href="../../..">
                <img src="../../../theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href="../../..">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="../../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="Input to search">
            </form>
        </div>


        <ul class="global_lang">
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="../../../standard/language-independent.html">Language Independent documents</a>
                        (3)
                    </li>
                    <li>
                        <a href="../../../standard/c.html">c/c++ documents</a>
                        (317)
                    </li>
                    <li>
                        <a href="../../../standard/csharp.html">csharp documents</a>
                        (39)
                    </li>
                    <li>
                        <a href="../../../standard/golang.html">golang documents</a>
                        (34)
                    </li>
                    <li>
                        <a href="../../../standard/java.html">java documents</a>
                        (555)
                    </li>
                    <li>
                        <a href="../../../standard/javascript.html">javascript documents</a>
                        (295)
                    </li>
                    <li>
                        <a href="../../../standard/objective-c.html">objective-c documents</a>
                        (124)
                    </li>
                    <li>
                        <a href="../../../standard/python.html">python documents</a>
                        (618)
                    </li>
                    <li>
                        <a href="../../../standard/shell.html">shell documents</a>
                        (334)
                    </li>
                    <li>
                        <a href="../../../standard/swift.html">swift documents</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
          <article>
            <h1>
            Security policy management (69)
            </h1>
        </article>
        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0145">Ant Rule9: Transaction Less Call Rollback</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Transaction Less Call Rollback</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0146">Transaction Less Rollback Type</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Transaction Less Rollback Type</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0147">Dangerous Type Amount Variable</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Dangerous Type Amount Variable</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0148">Amount Variable Cast To Dangerous Type</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Amount Variable Cast To Dangerous Type</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0149">Big Decimal Argument</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Big Decimal Argument</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0139">Weak hash</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Weak hash</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0140">Benchmark Secure Cookie</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Benchmark Secure Cookie</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0141">Error Code No Throw</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Error Code No Throw</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0142">Error Code Return Bool</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Error Code Return Bool</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0143">Error Code Return Object</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Error Code Return Object</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0144">Transaction Call Interface</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Transaction Call Interface</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0138">Benchmark Crypto</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Benchmark Crypto</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0109">Fixed Key</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Fixed Key</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>High</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/c.html">c</a>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0127">Sensitive data to database</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Sensitive data to database</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="BE0128">Sensitive data to cache</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Sensitive data to cache</p>
<h1 id="likelihood-of-exploit">Likelihood of exploit</h1>
<p>Medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">java</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1074">Access Control</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Application code that calls security-sensitive methods must validate the arguments being passed to the methods.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>In particular, null values may be interpreted as benign by certain security-sensitive methods but may override default settings. Although security-sensitive methods should be coded defensively, the client code must validate arguments that the method might otherwise accept as valid. Failure to do so can result in privilege escalation and execution of arbitrary code.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Thoroughly understand security-sensitive methods and validate their parameters to prevent corner cases with unexpected argument values.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example shows the two-argument doPrivileged() method that takes an access control context as the second argument. This code restores privileges from a previously saved context.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>When passed a null access control context, the two-argument doPrivileged() method fails to reduce the current privileges to those of the previously saved context. Consequently, this code can grant excess privileges when the accessControlContext argument is null.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution prevents granting of excess privileges by ensuring that accessControlContext is non-null:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">(</span><span class="n">accessControlContext</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="n">SecurityException</span><span class="o">(</span><span class="s">"Missing AccessControlContext"</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">AccessController</span><span class="o">.</span><span class="na">doPrivileged</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="c1">// ...</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">accessControlContext</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC55-J.+Ensure+that+security-sensitive+methods+are+called+with+validated+arguments <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7577">World writable file (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>World writable file (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The file written in this context is using the creation mode <code>MODE_WORLD_READABLE</code>. It might not be the
    expected behavior to exposed the content being written.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
fos = openFileOutput(filename, MODE_WORLD_READABLE);
fos.write(userInfo.getBytes());
</pre>
</p>
<br/>
<p>
<b>Solution (using MODE_PRIVATE):</b><br/>
<pre>
fos = openFileOutput(filename, MODE_PRIVATE);
</pre>
</p>
<p>
<b>Solution (using local SQLite Database):</b><br/></p>
<p>Using a local SQLite database is probably the best solution to store structured data. Make sure the database file is not
create on external storage. See references below for implementation guidelines.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD11-J.+Ensure+that+sensitive+data+is+kept+secure">CERT: DRD11-J. Ensure that sensitive data is kept secure</a><br/>
<a href="http://developer.android.com/training/articles/security-tips.html#InternalStorage">Android Official Doc: Security Tips</a><br/>
<a href="http://developer.android.com/reference/android/content/Context.html#MODE_PRIVATE">Android Official Doc: Context.MODE_PRIVATE</a><br/>
<a href="http://www.vogella.com/tutorials/AndroidSQLite/article.html#databasetutorial_database">vogella.com: Android SQLite database and content provider - Tutorial</a><br/>
<a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
<a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7575">External file access (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>External file access (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The application write data to external storage (potentially SD card). There are multiple security implication to this
    action. First, file store on SD card will be accessible to the application having the
    <a href="http://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE"><code>READ_EXTERNAL_STORAGE</code></a> permission.
    Also, if the data persisted contains confidential information about the user, encryption would be needed.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
file file = new File(getExternalFilesDir(TARGET_TYPE), filename);
fos = new FileOutputStream(file);
fos.write(confidentialData.getBytes());
fos.flush();
</pre>
</p>
<p>
<b>Better alternative:</b><br/>
<pre>
fos = openFileOutput(filename, Context.MODE_PRIVATE);
fos.write(string.getBytes());
</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://developer.android.com/training/articles/security-tips.html#ExternalStorage">Android Official Doc: Security Tips</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/DRD00-J.+Do+not+store+sensitive+information+on+external+storage+%28SD+card%29+unless+encrypted+first">CERT: DRD00-J: Do not store sensitive information on external storage [...]</a><br/>
<a href="http://developer.android.com/guide/topics/data/data-storage.html#filesExternal">Android Official Doc: Using the External Storage</a><br/>
<a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M2">OWASP Mobile Top 10 2014-M2: Insecure Data Storage</a><br/>
<a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7504">SHA-1 is a weak hash function</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>SHA-1 is a weak hash function</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The algorithms SHA-1 is not a recommended algorithm for hash password, for signature verification and other
uses. <b>PBKDF2</b> should be used to hash password for example.</p></p>
<blockquote>
    "<b>SHA-1 for digital signature generation:</b><br/>
    SHA-1 may only be used for digital signature generation where specifically allowed by NIST protocol-specific guidance.
    For all other applications, <u>SHA-1 shall not be used for digital signature generation</u>.<br/>
<b>SHA-1 for digital signature verification:</b><br/>
    For digital signature verification, <u>SHA-1 is allowed for legacy-use</u>.<br/>
    [...]<br/>
<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, and SHA-512/256</b>:<br/>
    The use of these hash functions is acceptable for all hash function applications."<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<blockquote>
    "The main idea of a PBKDF is to slow dictionary or brute force attacks on the passwords by increasing the time
    needed to test each password. An attacker with a list of likely passwords can evaluate the PBKDF using the known
    iteration counter and the salt. Since an attacker has to spend a significant amount of computing time for each try,
    it becomes harder to apply the dictionary or brute force attacks."<br/>
- <a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation  p.12</a>
</blockquote>
<p><br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>MessageDigest sha1Digest = MessageDigest.getInstance("SHA1");
    sha1Digest.update(password.getBytes());
    byte[] hashValue = sha1Digest.digest();</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;pre&gt;</span>byte[] hashValue = DigestUtils.getSha1Digest().digest(password.getBytes());<span class="nt">&lt;/pre&gt;</span>
</pre></div>
</td></tr></table>
</p>
<p>
<b>Solution (Using bouncy castle):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    PKCS5S2ParametersGenerator gen = new PKCS5S2ParametersGenerator(new SHA256Digest());
    gen.init(password.getBytes("UTF-8"), salt.getBytes(), 4096);
    return ((KeyParameter) gen.generateDerivedParameters(256)).getKey();
}</pre>
<b>Solution (Java 8 and later):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    KeySpec spec = new PBEKeySpec(password.toCharArray(), salt, 4096, 256 * 8);
    SecretKeyFactory f = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
    return f.generateSecret(spec).getEncoded();
}</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://community.qualys.com/blogs/securitylabs/2014/09/09/sha1-deprecation-what-you-need-to-know">Qualys blog: SHA1 Deprecation: What You Need to Know</a><br/>
<a href="https://googleonlinesecurity.blogspot.ca/2014/09/gradually-sunsetting-sha-1.html">Google Online Security Blog: Gradually sunsetting SHA-1</a><br/>
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</a><br/>
<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation</a><br/>
<a href="https://stackoverflow.com/q/22580853/89769">Stackoverflow: Reliable implementation of PBKDF2-HMAC-SHA256 for Java</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7150">May expose internal representation by returning reference to mutable object</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>May expose internal representation by returning reference to mutable object</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> Returning a reference to a mutable object value stored in one of the object's fields
  exposes the internal representation of the object. 
   If instances
   are accessed by untrusted code, and unchecked changes to
   the mutable object would compromise security or other
   important properties, you will need to do something different.
  Returning a new copy of the object is better approach in many situations.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7578">WebView with geolocation activated (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>WebView with geolocation activated (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    It is suggested to ask the user for a confirmation about obtaining its geolocation.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);
    }
});
</pre>
</p>
<p>
<b>Suggested code:</b><br/></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>Limit the sampling of geolocation and ask the user for confirmation.
</pre></div>
</td></tr></table>
<p><pre>
webView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermissions.Callback callback) {
        callback.invoke(origin, true, false);</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    //Ask the user for confirmation
}
</pre></div>
</td></tr></table>
<p>});
</p></p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD15-J.+Consider+privacy+concerns+when+using+Geolocation+API">CERT: DRD15-J. Consider privacy concerns when using Geolocation API</a><br/>
<a href="http://en.wikipedia.org/wiki/W3C_Geolocation_API">Wikipedia: W3C Geolocation API</a><br/>
<a href="http://dev.w3.org/geo/api/spec-source.html">W3C: Geolocation Specification</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7151">May expose internal representation by incorporating reference to mutable object</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>May expose internal representation by incorporating reference to mutable object</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code stores a reference to an externally mutable object into the
  internal representation of the object. 
   If instances
   are accessed by untrusted code, and unchecked changes to
   the mutable object would compromise security or other
   important properties, you will need to do something different.
  Storing a copy of the object is better approach in many situations.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7043">Method invoked that should be only be invoked inside a doPrivileged block</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Method invoked that should be only be invoked inside a doPrivileged block</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code invokes a method that requires a security permission check.
  If this code will be granted security permissions, but might be invoked by code that does not
  have security permissions, then the invocation needs to occur inside a doPrivileged block.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7566">Use of ESAPI Encryptor</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#needed">Needed</a></li>
<li><a href="#needed-to-have-a-solid-auth-encryption">Needed to have a solid auth. encryption</a></li>
<li><a href="#cbc-mode-should-be-removed-to-avoid-padding-oracle">CBC mode should be removed to avoid padding oracle</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Use of ESAPI Encryptor</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The ESAPI has a small history of vulnerabilities within the cryptography component. Here is a quick validation list to
    make sure the Authenticated Encryption is working as expected.
</p>
<p><b>1. Library Version</b></p>
<p>
    This issue is corrected in ESAPI version 2.1.0. Versions &lt;= 2.0.1 are vulnerable to a MAC bypass (CVE-2013-5679).<br/>
</p>
<p>
    For Maven users, the plugin <a href="http://mojo.codehaus.org/versions-maven-plugin/">versions</a> can be called using the
    following command. The effective version of ESAPI will be available in the output.<br/>
<pre>$ mvn versions:display-dependency-updates</pre>
<br/>Output:<br/>
<pre>
[...]
[INFO] The following dependencies in Dependencies have newer versions:
[INFO]   org.slf4j:slf4j-api ................................... 1.6.4 -&gt; 1.7.7
[INFO]   org.owasp.esapi:esapi ................................. 2.0.1 -&gt; 2.1.0
[...]
    </pre>
</p>
<p>
    or by looking at the configuration directly.<br/>
<pre>
&lt;dependency&gt;
    &lt;groupId&gt;org.owasp.esapi&lt;/groupId&gt;
    &lt;artifactId&gt;esapi&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;</pre>
</p>
<p>
    For Ant users, the jar used should be <a href="http://repo1.maven.org/maven2/org/owasp/esapi/esapi/2.1.0/esapi-2.1.0.jar">esapi-2.1.0.jar</a>.
</p>
<p><b>2. Configuration:</b></p>
<p>
    The library version 2.1.0 is still vulnerable to key size being changed in the ciphertext definition (CVE-2013-5960). Some precautions need to be taken.<br/>
<br/>
<div><b>The cryptographic configuration of ESAPI can also be vulnerable if any of these elements are present:</b><br/>
<b>Insecure configuration:</b><br/>
<pre>
Encryptor.CipherText.useMAC=false</pre></div></p>
<p>Encryptor.EncryptionAlgorithm=AES
Encryptor.CipherTransformation=AES/CBC/PKCS5Padding</p>
<p>Encryptor.cipher_modes.additional_allowed=CBC</p></p>


<p>
<div>
<b>Secure configuration:</b><br/>
<pre></pre></div></p>
<h1 id="needed">Needed</h1>
<p>Encryptor.CipherText.useMAC=true</p>
<h1 id="needed-to-have-a-solid-auth-encryption">Needed to have a solid auth. encryption</h1>
<p>Encryptor.EncryptionAlgorithm=AES
Encryptor.CipherTransformation=AES/GCM/NoPadding</p>
<h1 id="cbc-mode-should-be-removed-to-avoid-padding-oracle">CBC mode should be removed to avoid padding oracle</h1>
<p>Encryptor.cipher_modes.additional_allowed=</p>


<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://owasp-esapi-java.googlecode.com/svn/trunk/documentation/ESAPI-security-bulletin1.pdf">ESAPI Security bulletin 1 (CVE-2013-5679)</a><br/>
<a href="http://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-5679">Vulnerability Summary for CVE-2013-5679</a><br/>
<a href="http://www.synacktiv.com/ressources/synacktiv_owasp_esapi_hmac_bypass.pdf">Synactiv: Bypassing HMAC validation in OWASP ESAPI symmetric encryption</a><br/>
<a href="http://cwe.mitre.org/data/definitions/310.html">CWE-310: Cryptographic Issues</a><br/>
<a href="http://lists.owasp.org/pipermail/esapi-dev/2015-March/002533.html">ESAPI-dev mailing list: Status of CVE-2013-5960</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7497">TrustManager that accept any certificates</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>TrustManager that accept any certificates</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Empty TrustManager implementations are often used to connect easily to a host that is not signed by a root
<a href="http://en.wikipedia.org/wiki/Certificate_authority">certificate authority</a>. As a consequence, this is vulnerable to
<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attacks</a>
since the client will trust any certificate.
</p>
<p>
A TrustManager allowing specific certificates (based on a truststore for example) should be built.
Detailed information for a proper implementation is available at:
<a href="http://stackoverflow.com/a/6378872/89769">[1]</a>
<a href="http://stackoverflow.com/a/5493452/89769">[2]</a>
</p>
<br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>class TrustAllManager implements X509TrustManager {
    @Override
    public void checkClientTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {
        //Trust any client connecting (no certificate validation)
    }
    @Override
    public void checkServerTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {
        //Trust any remote server (no certificate validation)
    }
    @Override
    public X509Certificate[] getAcceptedIssuers() {
        return null;
    }
}</pre>
</p>
<br/>
<p>
<b>Solution (TrustMangager based on a keystore):</b><br/>
<pre>KeyStore ks = //Load keystore containing the certificates trusted
SSLContext sc = SSLContext.getInstance("TLS");
TrustManagerFactory tmf = TrustManagerFactory.getInstance("SunX509");
tmf.init(ks);
sc.init(kmf.getKeyManagers(), tmf.getTrustManagers(),null);
</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7152">May expose internal static state by storing a mutable object into a static field</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>May expose internal static state by storing a mutable object into a static field</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code stores a reference to an externally mutable object into a static
   field.
   If unchecked changes to
   the mutable object would compromise security or other
   important properties, you will need to do something different.
  Storing a copy of the object is better approach in many situations.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7549">RSA usage with short key</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>RSA usage with short key</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The NIST recommends the use of <u>2048 bits and higher</u> keys for the RSA algorithm.
</p>
<blockquote>
    "Digital Signature Verification | RSA: 1024 ≤ len(n) &lt; 2048 | Legacy-use"<br/>
    "Digital Signature Verification | RSA: len(n) ≥ 2048 | Acceptable"<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.7</a>
</blockquote></p>
<p><b>Vulnerable Code:</b><br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(512);
</pre>
</p>
<p><b>Solution:</b><br/>
The KeyPairGenerator creation should be as follows with at least 2048 bit key size.<br/>
<pre>
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(2048);
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/key_management.html">NIST: Latest publication on key management</a><br/>
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.7</a><br/>
<a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/how-large-a-key-should-be-used.htm">RSA Laboratories: 3.1.5 How large a key should be used in the RSA cryptosystem?</a><br/>
<a href="http://en.wikipedia.org/wiki/Key_size#Asymmetric%5Falgorithm%5Fkey%5Flengths">Wikipedia: Asymmetric algorithm key lengths</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a><br/>
<a href="http://www.keylength.com/en/compare/">Keylength.com (BlueKrypt): Aggregate key length recommendations.</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7065">Empty database password</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Empty database password</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>This code creates a database connect using a blank or empty password. This indicates that the database is not protected by a password.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7565">Cipher with no integrity</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cipher with no integrity</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The ciphertext produced is susceptible to alteration by an adversary. This mean that the cipher provides no way to detect that the 
    data has been tampered with. If the ciphertext can be controlled by an attacker, it could be altered without detection.
</p>
<p>
    The solution is to used a cipher that includes a Hash based Message Authentication Code (HMAC) to sign the data. Combining a HMAC function to the 
    existing cipher is prone to error <sup><a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">[1]</a></sup>. Specifically,
    it is always recommended that you be able to verify the HMAC first, and only if the data is unmodified, do you then perform any cryptographic
    functions on the data.
</p>
<p>The following modes are vulnerable because they don't provide a HMAC:<br/>
    - CBC<br/>
    - OFB<br/>
    - CTR<br/>
    - ECB<br/><br/>
    The following snippets code are some examples of vulnerable code.<br/><br/>
<b>Code at risk:</b><br/>
<i>AES in CBC mode</i><br/></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>&lt;pre&gt;Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
</pre></div>
</td></tr></table>
<p>c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</p></p>
<br/>
<i>Triple DES with ECB mode</i><br/>
<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
<p></p>
<p>
<b>Solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
In the example solution above, the GCM mode introduces an HMAC into the resulting encrypted data, providing integrity of the result.
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://www.thoughtcrime.org/blog/the-cryptographic-doom-principle/">Moxie Marlinspike's blog: The Cryptographic Doom Principle</a><br/>
<a href="http://cwe.mitre.org/data/definitions/353.html">CWE-353: Missing Support for Integrity Check</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1083">Insecure Randomness</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Pseudorandom number generators (PRNGs) use deterministic mathematical algorithms to produce a sequence of numbers with good statistical properties. However, the sequences of numbers produced fail to achieve true randomness. PRNGs usually start with an arithmetic seed value. The algorithm uses this seed to generate an output value and a new seed, which is used to generate the next value, and so on.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The Java API provides a PRNG, the java.util.Random class. This PRNG is portable and repeatable. Consequently, two instances of the java.util.Random class that are created using the same seed will generate identical sequences of numbers in all Java implementations. Seed values are often reused on application initialization or after every system reboot. In other cases, the seed is derived from the current time obtained from the system clock. An attacker can learn the value of the seed by performing some reconnaissance on the vulnerable target and can then build a lookup table for estimating future seed values.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use a more secure random number generator, such as the java.security.SecureRandom class.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example uses the insecure java.util.Random class. This class produces an identical sequence of numbers for each given seed value; consequently, the sequence of numbers is predictable.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="n">Random</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="mi">123L</span><span class="o">);</span>
<span class="c1">//...</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
  <span class="c1">// Generate another random integer in the range [0, 20]</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">);</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">n</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution uses the java.security.SecureRandom class to produce high-quality random numbers:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
  <span class="n">SecureRandom</span> <span class="n">number</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
  <span class="c1">// Generate 20 integers 0..20</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">number</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">21</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/MSC02-J.+Generate+strong+random+numbers <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7477">Overly permissive CORS policy</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Overly permissive CORS policy</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Prior to HTML5, Web browsers enforced the Same Origin Policy which ensures that in order for JavaScript to access the contents of a Web page, both the JavaScript and the Web page must originate from the same domain. Without the Same Origin Policy, a malicious website could serve up JavaScript that loads sensitive information from other websites using a client's credentials, cull through it, and communicate it back to the attacker. HTML5 makes it possible for JavaScript to access data across domains if a new HTTP header called Access-Control-Allow-Origin is defined. With this header, a Web server defines which other domains are allowed to access its domain using cross-origin requests. However, caution should be taken when defining the header because an overly permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.
</p>
<p>
<b>Vulnerable Code:</b>
<pre>response.addHeader("Access-Control-Allow-Origin", "*");</pre>
</p>
<p>
<b>Solution:</b>
<br/>
Avoid using * as the value of the Access-Control-Allow-Origin header, which indicates that the application's data is accessible to JavaScript running on any domain.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://www.w3.org/TR/cors/">W3C Cross-Origin Resource Sharing</a><br/>
<a href="http://enable-cors.org/">Enable Cross-Origin Resource Sharing</a><br/>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7503">MD2, MD4 and MD5 are weak hash functions</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>MD2, MD4 and MD5 are weak hash functions</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The algorithms MD2, MD4 and MD5 are not a recommended MessageDigest. <b>PBKDF2</b> should be used to hash password for example.</p></p>
<blockquote>
    "The security of the MD5 hash function is severely compromised. A collision attack exists that can find collisions
    within seconds on a computer with a 2.6 GHz Pentium 4 processor (complexity of 2<sup>24.1</sup>).[1] Further, there is also a
    chosen-prefix collision attack that can produce a collision for two inputs with specified prefixes within hours, using
    off-the-shelf computing hardware (complexity 2<sup>39</sup>).[2]"<br/>
    - <a href="https://en.wikipedia.org/wiki/MD5#Security">Wikipedia: MD5 - Security</a>
</blockquote>
<blockquote>
    "<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, and SHA-512/256</b>:<br/>
    The use of these hash functions is acceptable for all hash function applications."<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<blockquote>
    "The main idea of a PBKDF is to slow dictionary or brute force attacks on the passwords by increasing the time
    needed to test each password. An attacker with a list of likely passwords can evaluate the PBKDF using the known
    iteration counter and the salt. Since an attacker has to spend a significant amount of computing time for each try,
    it becomes harder to apply the dictionary or brute force attacks."<br/>
- <a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation  p.12</a>
</blockquote>
<p><br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>MessageDigest md5Digest = MessageDigest.getInstance("MD5");
    md5Digest.update(password.getBytes());
    byte[] hashValue = md5Digest.digest();</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;pre&gt;</span>byte[] hashValue = DigestUtils.getMd5Digest().digest(password.getBytes());<span class="nt">&lt;/pre&gt;</span>
</pre></div>
</td></tr></table>
</p>
<p>
<b>Solution (Using bouncy castle):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    PKCS5S2ParametersGenerator gen = new PKCS5S2ParametersGenerator(new SHA256Digest());
    gen.init(password.getBytes("UTF-8"), salt.getBytes(), 4096);
    return ((KeyParameter) gen.generateDerivedParameters(256)).getKey();
}</pre>
<b>Solution (Java 8 and later):</b><br/>
<pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    KeySpec spec = new PBEKeySpec(password.toCharArray(), salt, 4096, 256 * 8);
    SecretKeyFactory f = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
    return f.generateSecret(spec).getEncoded();
}</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p>[1] <a href="http://www.win.tue.nl/hashclash/On%20Collisions%20for%20MD5%20-%20M.M.J.%20Stevens.pdf">On Collisions for MD5</a>: Master Thesis by M.M.J. Stevens<br/>
[2] <a href="http://homepages.cwi.nl/~stevens/papers/stJOC%20-%20Chosen-Prefix%20Collisions%20for%20MD5%20and%20Applications.pdf">Chosen-prefix collisions for MD5 and applications</a>: Paper written by Marc Stevens<br/>
[3]<a href="https://en.wikipedia.org/wiki/MD5">Wikipedia: MD5</a><br/>
[4]<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</a><br/>
[5]<a href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST: Recommendation for Password-Based Key Derivation</a><br/>
[6]<a href="https://stackoverflow.com/q/22580853/89769">Stackoverflow: Reliable implementation of PBKDF2-HMAC-SHA256 for Java</a><br/>
[7]<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7489">Cookie without the secure flag</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cookie without the secure flag</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
A new cookie is created without the <code>Secure</code> flag set.
The <code>Secure</code> flag is a directive to the browser to make sure that the cookie is not sent for insecure
communication (<code>http://</code>).
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre>
Cookie cookie = new Cookie("userName",userName);
response.addCookie(cookie);
</pre>
</p>
<p>
<b>Solution (Specific configuration):</b><br/>
<pre>
Cookie cookie = new Cookie("userName",userName);
cookie.setSecure(true); // Secure flag
cookie.setHttpOnly(true);
</pre>
</p>
<p>
<b>Solution (Servlet 3.0 configuration):</b><br/>
<pre>
&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"&gt;
[...]
&lt;session-config&gt;
 &lt;cookie-config&gt;
  &lt;http-only&gt;true&lt;/http-only&gt;
  &lt;secure&gt;true&lt;/secure&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;
&lt;/web-app&gt;
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="reference">Reference</h1>
<p><a href="https://cwe.mitre.org/data/definitions/614.html">CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a><br/>
<a href="https://cwe.mitre.org/data/definitions/315.html">CWE-315: Cleartext Storage of Sensitive Information in a Cookie</a><br/>
<a href="https://cwe.mitre.org/data/definitions/311.html">CWE-311: Missing Encryption of Sensitive Data</a><br/>
<a href="https://www.owasp.org/index.php/SecureFlag">OWASP: Secure Flag</a><br/>
<a href="https://www.rapid7.com/db/vulnerabilities/http-cookie-secure-flag">Rapid7: Missing Secure Flag From SSL Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE0133">Session Fixation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The product downloads source code or an executable from a remote location and executes the code without sufficiently verifying the origin and integrity of the code. </p>
<p>Such a scenario is commonly observed when:
1. A web application authenticates a user without first invalidating the existing session, thereby continuing to use the session already associated with the user.
2. An attacker is able to force a known session identifier on a user so that, once the user authenticates, the attacker has access to the authenticated session.
3. The application or container uses predictable session identifiers. In the generic exploit of session fixation vulnerabilities, an attacker creates a new session on a web application and records the associated session identifier. The attacker then causes the victim to associate, and possibly authenticate, against the server using that session identifier, giving the attacker access to the user's account through the active session. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>An attacker is able to force a known session identifier on a user so that, once the user authenticates, the attacker has access to the authenticated session. </p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Invalidate any existing session identifiers prior to authorizing a new user session. </p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">invalidate</span><span class="o">();</span>  
<span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="s">"DD"</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>Use invalidate() to invalidate current session identifier.</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/384.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/cwe-384.html">CWE-384</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7541">DES is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>DES is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
DES is considered strong ciphers for modern applications. Currently, NIST recommends the
usage of AES block ciphers instead of DES.
</p>
<p>
<b>Example weak code:</b>
<pre>Cipher c = Cipher.getInstance("DES/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Example solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://www.nist.gov/itl/fips/060205_des.cfm">NIST Withdraws Outdated Data Encryption Standard</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1089">Insecure Sanitizer Policy</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special characters such as "&lt;", "&gt;", and "&amp;" that could be interpreted as web-scripting elements when they are sent to a downstream component that processes web pages.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>This may allow such characters to be treated as control characters, which are executed client-side in the context of the user's session. Although this can be classified as an injection problem, the more pertinent issue is the improper conversion of such special characters to respective context-appropriate entities before displaying them to the user.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Carefully check each input parameter against a rigorous positive specification (whitelist) defining the specific characters and format allowed.</p>
</li>
<li>
<p>Use and specify an output encoding that can be handled by the downstream component that is reading the output.</p>
</li>
<li>
<p>With Struts, write all data from form beans with the bean's filter attribute set to true.</p>
</li>
<li>
<p>To help mitigate XSS attacks against the user's session cookie, set the session cookie to be HttpOnly.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>In the following example, a guestbook comment isn't properly encoded, filtered, or otherwise neutralized for script-related tags before being displayed in a client browser.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">&lt;%</span> <span class="k">for</span> <span class="o">(</span><span class="n">Iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">guestbook</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();</span> <span class="o">)</span> <span class="o">{</span>
<span class="n">Entry</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="n">Entry</span><span class="o">)</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span> <span class="k">%&gt;</span>
<span class="nt">&lt;p&gt;</span>Entry #<span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="k">&lt;%=</span> <span class="n">e</span><span class="o">.</span><span class="na">getText</span><span class="o">()</span> <span class="k">%&gt;</span><span class="nt">&lt;/p&gt;</span>
<span class="k">&lt;%</span>
<span class="o">}</span> <span class="k">%&gt;</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/80.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7563">ECB mode is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>ECB mode is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>An authentication cipher mode which provides better confidentiality of the encrypted data should be used instead of Electronic Codebook (ECB) mode, 
which does not provide good confidentiality. Specifically, ECB mode produces the same output for the same input each time. So, 
for example, if a user is sending a password, the encrypted value is the same each time. This allows an attacker to intercept 
and replay the data.</p>
<p>
To fix this, something like Galois/Counter Mode (GCM) should be used instead.
</p>
<p>
<b>Code at risk:</b>
<pre>Cipher c = Cipher.getInstance("AES/ECB/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Electronic_codebook_.28ECB.29">Wikipedia: Block cipher modes of operation</a><br/>
<a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST: Recommendation for Block Cipher Modes of Operation</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7584">Trust Boundary Violation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Trust Boundary Violation</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    "A trust boundary can be thought of as line drawn through a program. On one side of the line, data is untrusted.
    On the other side of the line, data is assumed to be trustworthy. The purpose of validation logic is to allow data
    to safely cross the trust boundary - to move from untrusted to trusted. A trust boundary violation occurs when a
    program blurs the line between what is trusted and what is untrusted. By combining trusted and untrusted data in the
    same data structure, it becomes easier for programmers to mistakenly trust unvalidated data." <sup>[1]</sup>
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre>
public void doSomething(HttpServletRequest req, String activateProperty) {
    //..
    req.getSession().setAttribute(activateProperty,"true");
}</pre>
<pre>
public void loginEvent(HttpServletRequest req, String userSubmitted) {
    //..
    req.getSession().setAttribute("user",userSubmitted);
}
</pre>
</p>
<p>
<b>Solution:</b><br/>
<p>
The solution would be to add validation prior setting a new session attribute. When possible, prefer data from
safe location rather than using direct user input.
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>low</p>
<h1 id="references">References</h1>
<p>[1] <a href="https://cwe.mitre.org/data/definitions/501.html">CWE-501: Trust Boundary Violation</a><br/>
<a href="https://www.owasp.org/index.php/Trust_Boundary_Violation">OWASP : Trust Boundary Violation</a></p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7562">Static IV</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Static IV</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Initialization vector must be regenerated for each message to be encrypted.
</p>
<p><b>Vulnerable Code:</b></p>
<p>
<pre>
private static byte[] IV = new byte[16] {(byte)0,(byte)1,(byte)2,[...]};</pre></p>
<p>public void encrypt(String message) throws Exception {</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>IvParameterSpec ivSpec = new IvParameterSpec(IV);
</pre></div>
</td></tr></table>
<p>[...]
</p></p>
<p><b>Solution:</b></p>
<p>
<pre>
public void encrypt(String message) throws Exception {</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>byte[] iv = new byte[16];
new SecureRandom().nextBytes(iv);

IvParameterSpec ivSpec = new IvParameterSpec(iv);
</pre></div>
</td></tr></table>
<p>[...]
</p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Initialization_vector">Wikipedia: Initialization vector</a><br/>
<a href="http://cwe.mitre.org/data/definitions/329.html">CWE-329: Not Using a Random IV with CBC Mode</a><br/>
<a href="https://defuse.ca/cbcmodeiv.htm">Encryption - CBC Mode IV: Secret or Not?</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1073">Code Correctness</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 3 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
<li><a href="#vulnerable-code-example-2">Vulnerable Code Example 2</a></li>
<li><a href="#fixed-code-example-2">Fixed COde Example 2</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>In a Java Virtual Machine (JVM), "Two classes are the same class (and consequently the same type) if they are loaded by the same class loader and they have the same fully qualified name" <a href="https://wiki.sei.cmu.edu/confluence/display/java/Rule+AA.+References#RuleAA.References-JVMSpec99">JVMSpec 1999</a>. Two classes with the same name but different package names are distinct, as are two classes with the same fully qualified name loaded by different class loaders.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>It could be necessary to check whether a given object has a specific class type or whether two objects have the same class type associated with them, for example, when implementing the equals() method. If the comparison is performed incorrectly, the code could assume that the two objects are of the same class when they are not. As a result, class names must not be compared.</p>
<p>Depending on the function that the insecure code performs, it could be vulnerable to a mix-and-match attack.</p>
<p>Conversely, the assumption that two classes deriving from the same codebase are the same is error prone. Although this assumption is commonly observed to be true in desktop applications, it is typically not the case with J2EE servlet containers. The containers can use different class loader instances to deploy and recall applications at runtime without having to restart the JVM.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Use class equivalency to determine type. Rather than use the class name to determine if an object is of a given type, use the getClass() method, and == operator.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This vulnerable code example compares the name of the class of object auth to the string "com.application.auth.DefaultAuthenticationHandler" and branches on the result of the comparison:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class object</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span>
      <span class="s">"com.application.auth.DefaultAuthenticationHandler"</span><span class="o">))</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>Comparing fully qualified class names is insufficient because distinct class loaders can load differing classes with identical fully qualified names into a single JVM.</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<p>This compliant solution compares the class object auth to the class object for the canonical default authentication handler:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether object auth has required/expected class name</span>
 <span class="k">if</span> <span class="o">(</span><span class="n">auth</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">com</span><span class="o">.</span><span class="na">application</span><span class="o">.</span><span class="na">auth</span><span class="o">.</span><span class="na">DefaultAuthenticationHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>The right-hand side of the comparison directly names the class of the canonical authentication handler. In the event that the canonical authentication handler had not yet been loaded, the Java runtime manages the process of loading the class. Finally, the comparison is correctly performed on the two class objects.</p>
<h3 id="vulnerable-code-example-2">Vulnerable Code Example 2</h3>
<p>This noncompliant code example compares the names of the class objects of x and y using the equals() method. Again, it is possible that x and y are distinct classes with the same name if they come from different class loaders.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether objects x and y have the same class name</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">y</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">()))</span> <span class="o">{</span>
  <span class="c1">// Objects have the same class</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example-2">Fixed COde Example 2</h3>
<p>This compliant solution correctly compares the two objects' classes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Determine whether objects x and y have the same class</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="o">{</span>
  <span class="c1">// Objects have the same class</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cert">
<p>https://wiki.sei.cmu.edu/confluence/display/java/OBJ09-J.+Compare+classes+and+not+class+names <a class="footnote-backref" href="#fnref-cert" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe">
<p>http://cwe.mitre.org/data/definitions/486.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7029">Usage of GetResource may be unsafe if class is extended</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Usage of GetResource may be unsafe if class is extended</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Calling <code>this.getClass().getResource(...)</code> could give
results other than expected if this class is extended by a class in
another package.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7539">Unencrypted Socket</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Unencrypted Socket</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The communication channel used is not encrypted. The traffic could be read by an attacker intercepting the network traffic.
</p>
<p>
<b>Vulnerable Code:</b><br/>
Plain socket (Cleartext communication):
<pre>Socket soc = new Socket("www.google.com",80);</pre>
</p>
<p>
<b>Solution:</b><br/>
SSL Socket (Secure communication):
<pre>Socket soc = SSLSocketFactory.getDefault().createSocket("www.google.com", 443);</pre>
</p>
<p>Beyond using an SSL socket, you need to make sure your use of SSLSocketFactory does all the appropriate certificate validation checks to
make sure you are not subject to man-in-the-middle attacks. Please read the OWASP Transport Layer Protection Cheat Sheet for details on how
to do this correctly.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="https://www.owasp.org/index.php/Top_10_2010-A9">OWASP: Top 10 2010-A9-Insufficient Transport Layer Protection</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure">OWASP: Top 10 2013-A6-Sensitive Data Exposure</a><br/>
<a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">OWASP: Transport Layer Protection Cheat Sheet</a><br/>
<a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7542">DESede is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>DESede is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Triple DES (also known as 3DES or DESede) is considered strong ciphers for modern applications. Currently, NIST recommends the
usage of AES block ciphers instead of 3DES.
</p>
<p>
<b>Example weak code:</b>
<pre>Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Example solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://www.nist.gov/itl/fips/060205_des.cfm">NIST Withdraws Outdated Data Encryption Standard</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7576">Broadcast (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Broadcast (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Broadcast intents can be listen by any application with the appropriate permission. It is suggested to avoid transmitting
    sensitive information when possible.
</p>
<p>
<b>Code at risk:</b><br/>
<pre>
Intent i = new Intent();
i.setAction("com.insecure.action.UserConnected");
i.putExtra("username", user);
i.putExtra("email", email);
i.putExtra("session", newSessionId);</pre></p>
<p>this.sendBroadcast(v1);
</p></p>

<br/>
<p>
<b>Solution (if possible):</b><br/>
<pre>
Intent i = new Intent();
i.setAction("com.secure.action.UserConnected");</pre></p>
<p>sendBroadcast(v1);
</p>

<br/>
<p>
<b>Configuration (receiver)<sup>[1] Source: StackOverflow</sup>:</b><br/>
<pre>
&lt;manifest ...&gt;</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;!</span><span class="nt">--</span> <span class="nt">Permission</span> <span class="nt">declaration</span> <span class="nt">--</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">permission</span> <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"my.app.PERMISSION"</span> <span class="o">/&amp;</span><span class="nt">gt</span><span class="o">;</span>

<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">receiver</span>
    <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"my.app.BroadcastReceiver"</span>
    <span class="nt">android</span><span class="p">:</span><span class="nd">permission</span><span class="o">=</span><span class="s2">"my.app.PERMISSION"</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span> <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;!</span><span class="nt">--</span> <span class="nt">Permission</span> <span class="nt">enforcement</span> <span class="nt">--</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
    <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">intent-filter</span><span class="o">&gt;</span>
        <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">action</span> <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"com.secure.action.UserConnected"</span> <span class="o">/&amp;</span><span class="nt">gt</span><span class="o">;</span>
    <span class="o">&amp;</span><span class="nt">lt</span><span class="o">;/</span><span class="nt">intent-filter</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;/</span><span class="nt">receiver</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>

<span class="o">...</span>
</pre></div>
</td></tr></table>
<p>&lt;/manifest&gt;
</p>

<p>
<b>Configuration (sender)<sup>[1] Source: StackOverflow</sup>:</b><br/>
<pre>
&lt;manifest&gt;
    &lt;!-- We declare we own the permission to send broadcast to the above receiver --&gt;
    &lt;uses-permission android:name="my.app.PERMISSION"/&gt;</pre></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;!</span><span class="nt">--</span> <span class="nt">With</span> <span class="nt">the</span> <span class="nt">following</span> <span class="nt">configuration</span><span class="o">,</span> <span class="nt">both</span> <span class="nt">the</span> <span class="nt">sender</span> <span class="nt">and</span> <span class="nt">the</span> <span class="nt">receiver</span> <span class="nt">apps</span> <span class="nt">need</span> <span class="nt">to</span> <span class="nt">be</span> <span class="nt">signed</span> <span class="nt">by</span> <span class="nt">the</span> <span class="nt">same</span> <span class="nt">developer</span> <span class="nt">certificate</span><span class="o">.</span> <span class="nt">--</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;</span>
<span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">permission</span> <span class="nt">android</span><span class="p">:</span><span class="nd">name</span><span class="o">=</span><span class="s2">"my.app.PERMISSION"</span> <span class="nt">android</span><span class="p">:</span><span class="nd">protectionLevel</span><span class="o">=</span><span class="s2">"signature"</span><span class="o">/&amp;</span><span class="nt">gt</span><span class="o">;</span>
</pre></div>
</td></tr></table>
<p>&lt;/manifest&gt;
</p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://www.securecoding.cert.org/confluence/display/java/DRD03-J.+Do+not+broadcast+sensitive+information+using+an+implicit+intent">CERT: DRD03-J. Do not broadcast sensitive information using an implicit intent</a><br/>
<a href="http://developer.android.com/reference/android/content/BroadcastReceiver.html#Security">Android Official Doc: BroadcastReceiver (Security)</a><br/>
<a href="http://developer.android.com/guide/topics/manifest/receiver-element.html">Android Official Doc: Receiver configuration (see <code>android:permission</code>)</a><br/>
<sup>[1]</sup> <a href="http://stackoverflow.com/a/21513368/89769">StackOverflow: How to set permissions in broadcast sender and receiver in android</a><br/>
<a href="https://cwe.mitre.org/data/definitions/925.html">CWE-925: Improper Verification of Intent by Broadcast Receiver</a><br/>
<a href="https://cwe.mitre.org/data/definitions/927.html">CWE-927: Use of Implicit Intent for Sensitive Communication</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7550">Blowfish usage with short key</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Blowfish usage with short key</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The Blowfish cipher supports keysizes from 32 bits to 448 bits. A small key size makes the ciphertext vulnerable to brute force attacks.
At least 128 bits of entropy should be used when generating the key if use of Blowfish is required.
</p>
<p>
If the algorithm can be changed, the AES block cipher should be used instead.
</p></p>
<p><b>Vulnerable Code:</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(64);</pre>
</p>
<p><b>Solution:</b><br/>
<pre>KeyGenerator keyGen = KeyGenerator.getInstance("Blowfish");
keyGen.init(128);</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="references">References</h1>
<p><a href="http://en.wikipedia.org/wiki/Blowfish_(cipher)">Blowfish (cipher)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7490">Cookie without the HttpOnly flag</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cookie without the HttpOnly flag</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
A new cookie is created without the <code>HttpOnly</code> flag set.
The <code>HttpOnly</code> flag is a directive to the browser to make sure that the cookie can not be read by
malicious script. When a user is the target of a "Cross-Site Scripting", the attacker would benefit greatly from getting
the session id for example.
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre>
Cookie cookie = new Cookie("email",userName);
response.addCookie(cookie);
</pre>
</p>
<p>
<b>Solution (Specific configuration):</b><br/>
<pre>
Cookie cookie = new Cookie("email",userName);
cookie.setSecure(true);
cookie.setHttpOnly(true); //HttpOnly flag
</pre>
</p>
<p>
<b>Solution (Servlet 3.0 configuration):</b><br/>
<pre>
&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"&gt;
[...]
&lt;session-config&gt;
 &lt;cookie-config&gt;
  &lt;http-only&gt;true&lt;/http-only&gt;
  &lt;secure&gt;true&lt;/secure&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;
&lt;/web-app&gt;
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="reference">Reference</h1>
<p><a href="http://blog.codinghorror.com/protecting-your-cookies-httponly/">Coding Horror blog: Protecting Your Cookies: HttpOnly</a><br/>
<a href="https://www.owasp.org/index.php/HttpOnly">OWASP: HttpOnly</a><br/>
<a href="https://www.rapid7.com/db/vulnerabilities/http-cookie-http-only-flag">Rapid7: Missing HttpOnly Flag From Cookie</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7545">Unsafe hash equals</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Unsafe hash equals</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
An attacker might be able to detect the value of the secret hash due to the exposure of comparison timing. When the
functions <code>Arrays.equals()</code> or <code>String.equals()</code> are called, they will exited earlier if less
bytes are matched.
</p>
<p>
<p><b>Vulnerable Code:</b><br/></p>
<pre>
String actualHash = ...

if(userInput.equals(actualHash)) {
    ...
}</pre>
<p></p>
<p><b>Solution:</b><br/></p>
<pre>
String actualHash = ...

if(MessageDigest.isEqual(userInput.getBytes(),actualHash.getBytes())) {
    ...
}</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://cwe.mitre.org/data/definitions/203.html">CWE-203: Information Exposure Through DiscrepancyKey</a><br/>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7506">Weak SSLContext</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Weak SSLContext</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
<b>Vulnerable Code:</b><br/>
<pre>
    SSLContext.getInstance("SSL");
</pre>
</p>
<p>
<p><b>Solution:</b><br/></p>
<p>Upgrade your implementation to the following, and configure https.protocols JVM option to include TLSv1.2:</p>
<pre>
    SSLContext.getInstance("TLS");
</pre>
<p>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://blogs.oracle.com/java-platform-group/entry/diagnosing_tls_ssl_and_https">Diagnosing TLS, SSL, and HTTPS</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7149">Public static method may expose internal representation by returning array</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Public static method may expose internal representation by returning array</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> A public static method returns a reference to
   an array that is part of the static state of the class.
   Any code that calls this method can freely modify
   the underlying array.
   One fix is to return a copy of the array.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7564">Cipher is susceptible to Padding Oracle</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Cipher is susceptible to Padding Oracle</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    This specific mode of CBC with PKCS5Padding is susceptible to padding oracle attacks. An adversary could potentially decrypt the
    message if the system exposed the difference between plaintext with invalid padding or valid padding. The distinction between
    valid and invalid padding is usually revealed through distinct error messages being returned for each condition.
</p>
<p>
<b>Code at risk:</b>
<pre>Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Solution:</b>
<pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://www.infobytesec.com/down/paddingoracle_openjam.pdf">Padding Oracles for the masses (by Matias Soler)</a><br/>
<a href="http://en.wikipedia.org/wiki/Authenticated_encryption">Wikipedia: Authenticated encryption</a><br/>
<a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01">NIST: Authenticated Encryption Modes</a><br/>
<a href="http://capec.mitre.org/data/definitions/463.html">CAPEC: Padding Oracle Crypto Attack</a><br/>
<a href="http://cwe.mitre.org/data/definitions/696.html">CWE-696: Incorrect Behavior Order</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7507">Message digest is custom</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Message digest is custom</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>Implementing a custom MessageDigest is error-prone.</p>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST</a> recommends the use of SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, or SHA-512/256.</p>
<blockquote>
    "<b>SHA-1 for digital signature generation:</b><br/>
    SHA-1 may only be used for digital signature generation where specifically allowed by NIST protocol-specific guidance.
    For all other applications, <u>SHA-1 shall not be used for digital signature generation</u>.<br/>
<b>SHA-1 for digital signature verification:</b><br/>
    For digital signature verification, <u>SHA-1 is allowed for legacy-use</u>.<br/>
    [...]<br/>
<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, and SHA-512/256</b>:<br/>
    The use of these hash functions is acceptable for all hash function applications."<br/>
    - <a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<p>
<b>Vulnerable Code:</b><br/>
<pre>MyProprietaryMessageDigest extends MessageDigest {
    @Override
    protected byte[] engineDigest() {
        [...]
        //Creativity is a bad idea
        return [...];
    }
}</pre>
</p>
<p>
<p>Upgrade your implementation to use one of the approved algorithms. Use an algorithm that is sufficiently strong for your specific security needs.</p>
<p>
<b>Example Solution:</b><br/>
<pre>MessageDigest sha256Digest = MessageDigest.getInstance("SHA256");
sha256Digest.update(password.getBytes());</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html">NIST Approved Hashing Algorithms</a><br/>
<a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1107">Weak Cryptographic Hash</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software generates a hash for a password, but it uses a scheme that does not provide a sufficient level of computational effort that would make password cracking attacks infeasible or expensive.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Many hash algorithms are designed to execute quickly with minimal overhead, even cryptographic hashes. However, this efficiency is a problem for password storage, because it can reduce an attacker's workload for brute-force password cracking. If an attacker can obtain the hashes through some other method (such as SQL injection on a database that stores hashes), then the attacker can store the hashes offline and use various techniques to crack the passwords by computing hashes efficiently.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Use an adaptive hash function that can be configured to change the amount of computational effort needed to compute the hash.</p>
</li>
<li>
<p>When using industry-approved techniques, use them correctly.</p>
</li>
</ul>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/916.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1115">Unsafe Jackson deserialization configuration</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 2 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a><ul>
<li><a href="#official-repair-method">Official repair method</a></li>
<li><a href="#repair-suggestions">Repair suggestions</a></li>
</ul>
</li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The vulnerability exists in the EnableDefaultTyping method under the Jackson framework. Through this vulnerability, an attacker can remotely execute arbitrary code on the server host to gain control of the website server.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Jackson is an open source Java serialization and deserialization tool that serializes Java objects into strings in xml or json format, or deserializes back to corresponding objects. Because of its ease of use, it is faster and does not depend on other libraries besides JDK, it used by many users. But its component, Jackson-databind, can specify a specific deserialization class, which puts the risk of code execution.</p>
<p>The serialized malicious attack code is constructed by the serialization method of the third-party inventory in the Java ecosystem, and the malicious code base64 is encoded and stitched into a well-constructed json data packet. If the code layer is using the ObjectMapper object instance (ObjectMapper mapper) = new ObjectMapper();) Turns on the enableDefaultType property (for example, mapper.enableDefaultTyping();), which will automatically call the deserialization method of the third-party library for the incoming JSON in readValue, causing the code to execute.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Critical</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<h3 id="official-repair-method">Official repair method</h3>
<p>After the vulnerabilities were generated, the official blacklisted banned code execution vulnerabilities caused by deserialization problems in third-party libraries in the blacklist.</p>
<h3 id="repair-suggestions">Repair suggestions</h3>
<p>1.Upgrade to the latest version of jackson-databind 2.7.9.2, 2.8.11, 2.9.3.1 or later version;</p>
<p>2.Disable the enableDefaultTyping() method;</p>
<p>3.Filter or type check the JSON data passed in by the client..</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ABean</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">AnotherBean</span> <span class="o">{</span>
        <span class="nd">@JsonTypeInfo</span><span class="o">(</span><span class="n">use</span> <span class="o">=</span> <span class="n">JsonTypeInfo</span><span class="o">.</span><span class="na">Id</span><span class="o">.</span><span class="na">CLASS</span><span class="o">)</span> <span class="c1">// or JsonTypeInfo.Id.MINIMAL_CLASS</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">example</span><span class="o">(</span><span class="n">String</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">JsonMappingException</span> <span class="o">{</span>
         <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">enableDefaultTyping</span><span class="o">();</span> <span class="c1">//using enableDefaultTyping() method</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">json</span><span class="o">,</span> <span class="n">ABean</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">exampleTwo</span><span class="o">(</span><span class="n">String</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">JsonMappingException</span> <span class="o">{</span>
         <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
         <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">json</span><span class="o">,</span> <span class="n">AnotherBean</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="reference">Reference</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-github1">
<p>https://github.com/FasterXML/jackson-databind/issues/1599 <a class="footnote-backref" href="#fnref-github1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-github2">
<p>https://github.com/mbechler/marshalsec <a class="footnote-backref" href="#fnref-github2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1091">Trust Boundary Violation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>A trust boundary can be thought of as line drawn through a program. On one side of the line, data is untrusted. On the other side of the line, data is assumed to be trustworthy. The purpose of validation logic is to allow data to safely cross the trust boundary - to move from untrusted to trusted. A trust boundary violation occurs when a program blurs the line between what is trusted and what is untrusted. By combining trusted and untrusted data in the same data structure, it becomes easier for programmers to mistakenly trust unvalidated data.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Without well-established and maintained trust boundaries, programmers will inevitably lose track of which pieces of data have been validated and which have not. This confusion will eventually allow some data to be used without first being validated.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Establish and respect trust boundaries.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>The following code accepts an HTTP request and stores the username parameter in the HTTP session object before checking to ensure that the user has been authenticated.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">usrname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"usrname"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">,</span> <span class="n">usrname</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe">
<p>https://cwe.mitre.org/data/definitions/501.html <a class="footnote-backref" href="#fnref-cwe" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1109">Insecure Storage</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>The software does not encrypt sensitive or critical information before storage or transmission.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>The Secure attribute for sensitive cookies in HTTPS sessions is not set, which could cause the user agent to send those cookies in plaintext over an HTTP session.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>Clearly specify which data or resources are valuable enough that they should be protected by encryption. </li>
<li>Ensure that encryption is properly integrated into the system design.</li>
<li>Identify the separate needs and contexts for encryption.</li>
<li>When using industry-approved techniques, use them correctly.</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<p>The snippet of code below, taken from a servlet doPost() method, sets an accountID cookie (sensitive) without calling setSecure(true).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Cookie</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="n">ACCOUNT_ID</span><span class="o">,</span> <span class="n">acctID</span><span class="o">);</span>
<span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-cwe1">
<p>https://cwe.mitre.org/data/definitions/614.html <a class="footnote-backref" href="#fnref-cwe1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-cwe2">
<p>https://cwe.mitre.org/data/definitions/311.html <a class="footnote-backref" href="#fnref-cwe2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1090">Privilege Management</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Creating an dangerous sphere of control for that actor, because application incorrectly assigns a privilege to a particular actor or assigns a privilege based on unknown source. </p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Improper privilege management can result in untrusted, unprivileged code performing unintended privileged operations. However, carefully restricting privileges adds complexity. This added complexity and the associated reduction of maintainability must be traded off against any security improvement.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>
<p>Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software.</p>
</li>
<li>
<p>Run your code using the lowest privileges that are required to accomplish the necessary tasks.</p>
</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<p>This application sends a special intent with a flag that allows the receiving application to read a data file for backup purposes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">();</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="s">"com.example.BackupUserData"</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">file_uri</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">addFlags</span><span class="o">(</span><span class="n">FLAG_GRANT_READ_URI_PERMISSION</span><span class="o">);</span>
<span class="n">sendBroadcast</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
</pre></div>
</td></tr></table>
<p>Any malicious application can register to receive this intent. Because of the FLAG_GRANT_READ_URI_PERMISSION included with the intent, the malicious receiver code can read the user's data：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CallReceiver</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Uri</span> <span class="n">userData</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
    <span class="n">stealUserData</span><span class="o">(</span><span class="n">userData</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CWE264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A6">
<p>https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration <a class="footnote-backref" href="#fnref-OWASP-A6" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7474">Insecure SMTP SSL connection</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Insecure SMTP SSL connection</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
Server identity verification is disabled when making SSL connections. Some email libraries that enable SSL connections do not verify the server certificate by default. This is equivalent to trusting all certificates. When trying to connect to the server, this application would readily accept a certificate issued to "hackedserver.com". The application would now potentially leak sensitive user information on a broken SSL connection to the hacked server.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>...
Email email = new SimpleEmail();
email.setHostName("smtp.servermail.com");
email.setSmtpPort(465);
email.setAuthenticator(new DefaultAuthenticator(username, password));
email.setSSLOnConnect(true);
email.setFrom("user@gmail.com");
email.setSubject("TestMail");
email.setMsg("This is a test mail ... :-)");
email.addTo("foo@bar.com");
email.send();
...</pre>
</p>
<p>
<b>Solution:</b><br/>
Please add the following check to verify the server cerfiticate:
<pre>email.setSSLCheckServerIdentity(true);</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="https://cwe.mitre.org/data/definitions/297.html">CWE-297: Improper Validation of Certificate with Host Mismatch</a><br/></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7478">Predictable pseudorandom number generator</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Predictable pseudorandom number generator</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The use of a predictable random value can lead to vulnerabilities when used in certain security critical contexts. For example, when the value is used as:</p>
<ul>
<li>a CSRF token: a predictable token can lead to a CSRF attack as an attacker will know the value of the token</li>
<li>a password reset token (sent by email): a predictable password token can lead to an account takeover, since an attacker will guess the URL of the change password form</li>
<li>any other secret value</li>
</ul>
<p>
A quick fix could be to replace the use of <b>java.util.Random</b> with something stronger, such as <b>java.security.SecureRandom</b>.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>String generateSecretToken() {
    Random r = new Random();
    return Long.toHexString(r.nextLong());
}</pre>
</p>
<p>
<b>Solution:</b>
<pre>import org.apache.commons.codec.binary.Hex;
String generateSecretToken() {
    SecureRandom secRandom = new SecureRandom();
    byte[] result = new byte[32];
    secRandom.nextBytes(result);
    return Hex.encodeHexString(result);
}</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://jazzy.id.au/default/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (http://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="http://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="http://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7505">DefaultHttpClient with default constructor is not compatible with TLS 1.2</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>DefaultHttpClient with default constructor is not compatible with TLS 1.2</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
<b>Vulnerable Code:</b><br/>
<pre>
    HttpClient client = new DefaultHttpClient();
</pre>
</p>
<p>
<p><b>Solution:</b><br/></p>
<p>Upgrade your implementation to use one of the recommended constructs and configure https.protocols JVM option to include TLSv1.2:</p></p>
<p>
<ul>
<li>Use <a href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/SystemDefaultHttpClient.html">SystemDefaultHttpClient</a> instead</li>
<p>
<b>Sample Code:</b><br/>
<pre>
HttpClient client = new SystemDefaultHttpClient();
</pre>
</p>
<li>Create an HttpClient based on SSLSocketFactory - get an SSLScoketFactory instance with <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ssl/SSLSocketFactory.html#getSystemSocketFactory()">getSystemSocketFactory()</a> and use this instance for HttpClient creation</li>
<li>Create an HttpClient based on SSLConnectionSocketFactory - get an instance with <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ssl/SSLConnectionSocketFactory.html#getSystemSocketFactory()">getSystemSocketFactory()</a> and use this instance for HttpClient creation</li>
<li>Use HttpClientBuilder - call <a href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/HttpClientBuilder.html#useSystemProperties()">useSystemProperties()</a> before calling build()</li>
<p>
<b>Sample Code:</b><br/>
<pre>
HttpClient client = HttpClientBuilder.create().useSystemProperties().build();
</pre>
</p>
<li>HttpClients - call <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/HttpClients.html#createSystem()">createSystem()</a> to create an instance</li>
<p>
<b>Sample Code:</b><br/>
<pre>
HttpClient client = HttpClients.createSystem();
</pre>
</p>
</ul>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="https://blogs.oracle.com/java-platform-group/entry/diagnosing_tls_ssl_and_https">Diagnosing TLS, SSL, and HTTPS</a>
</p></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7537">Hazelcast symmetric encryption</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Hazelcast symmetric encryption</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The network communications for Hazelcast is configured to use a symmetric cipher (probably DES or blowfish).</p>
<p>Those ciphers alone do not provide integrity or secure authentication. The use of asymmetric encryption is preferred.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://docs.hazelcast.org/docs/3.5/manual/html/encryption.html">Hazelcast Documentation: Encryption</a><br/>
<a href="http://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7543">RSA with no padding is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>RSA with no padding is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The software uses the RSA algorithm but does not incorporate Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>Cipher.getInstance("RSA/NONE/NoPadding")</pre>
</p>
<p>
<b>Solution:</b><br/>
The code should be replaced with:<br/>
<pre>Cipher.getInstance("RSA/ECB/OAEPWithMD5AndMGF1Padding")</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://cwe.mitre.org/data/definitions/780.html">CWE-780: Use of RSA Algorithm without OAEP</a><br/>
<a href="http://rdist.root.org/2009/10/06/why-rsa-encryption-padding-is-critical/">Root Labs: Why RSA encryption padding is critical</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7044">Classloaders should only be created inside doPrivileged block</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Classloaders should only be created inside doPrivileged block</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p> This code creates a classloader,  which needs permission if a security manage is installed.
  If this code might be invoked by code that does not
  have security permissions, then the classloader creation needs to occur inside a doPrivileged block.</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-bugs.html">FIND-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1070">Insecure SSL</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>When the software communicates with a host by certificate which signed by compromised Certificate Authorities, attackers can stealing sensitive data by performing man-in-the-middle (MiTM) attacks. 
In order to ensure data integrity, the certificate must be valid and it must pertain to the site that is being accessed.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Attackers will be able to intercept the SSL/TLS trusting these compromised CAs.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<ul>
<li>Use only trusted certificates</li>
<li>Use a certificate that is valid and must be relevant to the site you are visiting</li>
</ul>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">connect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">URLConnection</span> <span class="n">urlConnection</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
                <span class="k">return</span> <span class="n">urlConnection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="o">...</span>
            <span class="o">}</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>SSL/TLS connection established using default CA</p>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">safeConnect</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">TrustManager</span><span class="o">[]</span> <span class="n">tm</span> <span class="o">=</span> <span class="o">{</span> <span class="k">new</span> <span class="n">X509TrustManager</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkClientTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">checkServerTrusted</span><span class="o">(</span><span class="n">X509Certificate</span><span class="o">[]</span> <span class="n">chain</span><span class="o">,</span> <span class="n">String</span> <span class="n">authType</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CertificateException</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>

                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="n">X509Certificate</span><span class="o">[]</span> <span class="nf">getAcceptedIssuers</span><span class="o">()</span> <span class="o">{</span>
                    <span class="o">...</span>
                <span class="o">}</span>
            <span class="o">}};</span>
            <span class="n">SSLContext</span> <span class="n">context</span> <span class="o">=</span> <span class="n">SSLContext</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SSL"</span><span class="o">);</span>
            <span class="n">context</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">tm</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>

            <span class="n">HttpsURLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpsURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">setSSLSocketFactory</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getSocketFactory</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">connection</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">...</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<p>SSL/TLS connection established with custom trusted certificate</p>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE310">
<p>https://cwe.mitre.org/data/definitions/310.html <a class="footnote-backref" href="#fnref-CWE310" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A3">
<p>https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure <a class="footnote-backref" href="#fnref-OWASP-A3" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7498">HostnameVerifier that accept any signed certificates</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>HostnameVerifier that accept any signed certificates</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>A <code>HostnameVerifier</code> that accept any host are often use because of certificate reuse on many hosts.
As a consequence, this is vulnerable to
<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attacks</a>
since the client will trust any certificate.
</p>
<p>
A TrustManager allowing specific certificates (based on a truststore for example) should be built.
Wildcard certificates should be created for reused on multiples subdomains.
Detailed information for a proper implementation is available at:
<a href="http://stackoverflow.com/a/6378872/89769">[1]</a>
<a href="http://stackoverflow.com/a/5493452/89769">[2]</a>
</p>
<br/>
<p>
<b>Vulnerable Code:</b><br/>
<pre>public class AllHosts implements HostnameVerifier {
    public boolean verify(final String hostname, final SSLSession session) {
        return true;
    }
}</pre>
</p>
<br/>
<p>
<b>Solution (TrustMangager based on a keystore):</b><br/>
<pre>KeyStore ks = //Load keystore containing the certificates trusted
SSLContext sc = SSLContext.getInstance("TLS");
TrustManagerFactory tmf = TrustManagerFactory.getInstance("SunX509");
tmf.init(ks);
sc.init(kmf.getKeyManagers(), tmf.getTrustManagers(),null);
</pre>
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://projects.webappsec.org/w/page/13246945/Insufficient%20Transport%20Layer%20Protection">WASC-04: Insufficient Transport Layer Protection</a><br/>
<a href="http://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE1079">Access Specifier Manipulation</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#potential-mitigations">Potential Mitigations</a></li>
<li><a href="#demonstrative-examples">Demonstrative Examples</a><ul>
<li><a href="#vulnerable-code-example">Vulnerable Code Example</a></li>
<li><a href="#fixed-code-example">Fixed Code Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Reflection enables a Java program to analyze and modify itself. In particular, a program can discover the values of field variables that are normally inaccessible to be accessed and change them.</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p>Use of reflection complicates security analysis and can easily introduce security vulnerabilities. Consequently, programmers should avoid using the reflection APIs when it is feasible to do so. Exercise extreme caution when the use of reflection is necessary.</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>Medium</p>
<h1 id="potential-mitigations">Potential Mitigations</h1>
<p>Reflection must not be used to provide access to classes, methods, and fields unless those items are already accessible without the use of reflection. For example, the use of reflection to access or modify fields is not allowed unless those fields are already accessible and modifiable by other means, such as through getter and setter methods.</p>
<h1 id="demonstrative-examples">Demonstrative Examples</h1>
<h3 id="vulnerable-code-example">Vulnerable Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setObjectId</span><span class="o">(</span><span class="n">Example</span> <span class="n">example</span><span class="o">,</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Field</span> <span class="n">field</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
            <span class="n">field</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">example</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h3 id="fixed-code-example">Fixed Code Example</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setObjectId</span><span class="o">(</span><span class="n">Example</span> <span class="n">example</span><span class="o">,</span> <span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">example</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
<h1 id="references">References</h1>
<div class="footnote">
<hr/>
<ol>
<li id="fn-CWE264">
<p>https://cwe.mitre.org/data/definitions/264.html <a class="footnote-backref" href="#fnref-CWE264" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn-CERT-SEC05-JAVA">
<p>https://wiki.sei.cmu.edu/confluence/display/java/SEC05-J.+Do+not+use+reflection+to+increase+accessibility+of+classes%2C+methods%2C+or+fields <a class="footnote-backref" href="#fnref-CERT-SEC05-JAVA" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn-OWASP-A6">
<p>https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration <a class="footnote-backref" href="#fnref-OWASP-A6" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
</ol>
</div>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7579">WebView with JavaScript enabled (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>WebView with JavaScript enabled (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    Enabling JavaScript for the WebView means that it is now susceptible to XSS. The page render should be inspected
    for potential reflected XSS, stored XSS and DOM XSS.<br/>
<pre>
WebView myWebView = (WebView) findViewById(R.id.webView);
WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);
</pre>
</p></p>
<p>
<b>Code at risk:</b><br/>
Enabling JavaScript is not a bad practice. It just means that the backend code need to be audited for potential XSS.
The XSS can also be introduce client-side with DOM XSS.
<pre>
function updateDescription(newDescription) {
    $("#userDescription").html("&lt;p&gt;"+newDescription+"&lt;/p&gt;");
}
</pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://www.technotalkative.com/issue-using-setjavascriptenabled-can-introduce-xss-vulnerabilities-application-review-carefully/">Issue: Using setJavaScriptEnabled can introduce XSS vulnerabilities</a><br/>
<a href="http://developer.android.com/guide/webapps/webview.html#UsingJavaScript">Android Official Doc: WebView</a><br/>
<a href="http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting">WASC-8: Cross Site Scripting</a><br/>
<a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">OWASP: XSS Prevention Cheat Sheet</a><br/>
<a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29">OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)</a><br/>
<a href="http://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7479">Predictable pseudorandom number generator (Scala)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>Predictable pseudorandom number generator (Scala)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>The use of a predictable random value can lead to vulnerabilities when used in certain security critical contexts. For example, when the value is used as:</p>
<ul>
<li>a CSRF token: a predictable token can lead to a CSRF attack as an attacker will know the value of the token</li>
<li>a password reset token (sent by email): a predictable password token can lead to an account takeover, since an attacker will guess the URL of the change password form</li>
<li>any other secret value</li>
</ul>
<p>
A quick fix could be to replace the use of <b>java.util.Random</b> with something stronger, such as <b>java.security.SecureRandom</b>.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>import scala.util.Random</pre></p>
<p>def generateSecretToken() {
    val result = Seq.fill(16)(Random.nextInt)
    return result.map("%02x" format _).mkString
}</p></p>

<p>
<b>Solution:</b>
<pre>import java.security.SecureRandom</pre></p>
<p>def generateSecretToken() {
    val rand = new SecureRandom()
    val value = Array.ofDim<a href="16">Byte</a>
    rand.nextBytes(value)
    return value.map("%02x" format <em>).mkString
}</em></p>

<p>
<b>Solution:</b>
<pre>import java.security.SecureRandom
import scala.util.Random.</pre></p>
<p>def generateSecretToken() {
    val secRandom = javaRandomToRandom(new SecureRandom())
    val result = Seq.fill(16)(secRandom.nextInt)
    return result.map("%02x" format _).mkString
}</p>

<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>high</p>
<h1 id="references">References</h1>
<p><a href="http://jazzy.id.au/default/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (http://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="http://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="http://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7580">WebView with JavaScript interface (Android)</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>WebView with JavaScript interface (Android)</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
    The use of JavaScript Interface could expose the WebView to risky API. If an XSS is triggered in the WebView, the class
    could be called by the malicious JavaScript code.
</p></p>
<p>
<b>Code at risk:</b><br/>
<pre><code>WebView myWebView = (WebView) findViewById(R.id.webView);
myWebView.addJavascriptInterface(new FileWriteUtil(this), "fileWriteUtil");
WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);
[...]
class FileWriteUtil {
    Context mContext;
    FileOpenUtil(Context c) {
        mContext = c;
    }
    public void writeToFile(String data, String filename, String tag) {
        [...]
    }
}
</code></pre>
</p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>medium</p>
<h1 id="references">References</h1>
<p><a href="http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29">Android Official Doc: WebView.addJavascriptInterface()</a><br/>
<a href="https://cwe.mitre.org/data/definitions/749.html">CWE-749: Exposed Dangerous Method or Function</a></p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

        <article class="single">
            <header>
                <div class="breadcrumb">
                <ol>
                    <li>
                        <a href="../../../standard/java.html">java</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues.html">Security issues</a>
                    </li>
                    <li>
                            <a href="../../../subcategory/java/security issues/security policy management.html">Security policy management</a>
                    </li>
                </ol>
                
                </div>

                <h1 id="PE7538">NullCipher is insecure</h1>
                <p>
                    Posted on September 28, 2024 in <a href="../../../category/security-policy-management.html">Security policy management</a>

                    &#8226; 1 min read
                </p>
            </header>

                <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#vulnerability-and-risk">Vulnerability and risk</a></li>
<li><a href="#likelihood-of-exploit">Likelihood of Exploit</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</div>

            <div>
                
<h1 id="description">Description</h1>
<p>NullCipher is insecure</p>
<h1 id="vulnerability-and-risk">Vulnerability and risk</h1>
<p><p>
The NullCipher is rarely used intentionally in production applications. It implements the Cipher interface by returning ciphertext 
identical to the supplied plaintext. In a few contexts, such as testing, a NullCipher may be appropriate.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>Cipher doNothingCihper = new NullCipher();
[...]
//The ciphertext produced will be identical to the plaintext.
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
<b>Solution:</b><br/>
    Avoid using the NullCipher. Its accidental use can introduce a significant confidentiality risk.
</p></p>
<h1 id="likelihood-of-exploit">Likelihood of Exploit</h1>
<p>critical</p>
<h1 id="reference">Reference</h1>
<p><a href="http://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>
            </div>
            <div class="tag-cloud">
                <p>
                <a href="../../../tag/java.html">JAVA</a>
                <a href="../../../tag/find-sec-bugs.html">FIND-SEC-BUGS</a>
                </p>
            </div>
        </article>

    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Rights reserve
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : "../../..",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>