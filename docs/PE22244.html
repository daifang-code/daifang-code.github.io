
<!DOCTYPE html>
<html lang="en">

<head>
    <link href='./theme/fonts/googleapis.css' rel='stylesheet' type='text/css'>
    <link href="./theme/stylesheet/normalize.min.css">
    <script src="./theme/javascript/jquery.min.js"></script>
    <script type="text/javascript" src="./tipuesearch_content.js"></script>
    <link rel="stylesheet" href="./theme/tipuesearch/css/tipuesearch.css">
    <script type="text/javascript" src="./theme/tipuesearch/tipuesearch_set.js"></script>
    <script type="text/javascript" src="./theme/tipuesearch/tipuesearch.js"></script>

        <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.css">

    <link rel="stylesheet" type="text/css"
          href="./theme/pygments/xcode.min.css">
    <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/font-awesome.min.css">





    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>     <meta name="robots" content=""/>      <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">  <meta name="author" content="flake8" />
<meta name="description" content="DUO134" />
<meta name="keywords" content="flake8">

<meta property="og:site_name" content="Pinpoint Document"/>
<meta property="og:title" content="DUO134"/>
<meta property="og:description" content="DUO134"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./PE22244.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2024-09-28 09:33:05.774828+08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/flake8.html">
<meta property="article:section" content="Code style and efficiency"/>
<meta property="article:tag" content="flake8"/>
<meta property="og:image" content="">

    <title>Pinpoint Document &ndash; DUO134</title>

</head>

<body style="display: none;">

<aside>
    <div>
        <a href=".">
                <img src="./theme/img/profile.png" alt="Pinpoint Document" title="Pinpoint Document">
        </a>
        <h1><a href=".">Pinpoint Document</a></h1>

        <div style="padding-left: 0">
            <form action="./search.html" onsubmit="return validateForm(this.elements['q'].value);">
                <input id="tipue_search_input" type="text" name="q" placeholder="Input to search">
            </form>
        </div>


        <ul class="global_lang">
                    <li class="active"><a href="javascript:void(0);"
                                                                                  language-link="en">en</a>
                    </li>
                    <li><a href="javascript:void(0);"
                                                                                  language-link="zh">zh</a>
                    </li>
        </ul>

        <!--  -->

        <nav>
            <ul class="list">
                    <li>
                        <a href="./standard/language-independent.html">Language Independent documents</a>
                        (3)
                    </li>
                    <li>
                        <a href="./standard/c.html">c/c++ documents</a>
                        (317)
                    </li>
                    <li>
                        <a href="./standard/csharp.html">csharp documents</a>
                        (39)
                    </li>
                    <li>
                        <a href="./standard/golang.html">golang documents</a>
                        (34)
                    </li>
                    <li>
                        <a href="./standard/java.html">java documents</a>
                        (555)
                    </li>
                    <li>
                        <a href="./standard/javascript.html">javascript documents</a>
                        (295)
                    </li>
                    <li>
                        <a href="./standard/objective-c.html">objective-c documents</a>
                        (124)
                    </li>
                    <li>
                        <a href="./standard/python.html">python documents</a>
                        (618)
                    </li>
                    <li>
                        <a href="./standard/shell.html">shell documents</a>
                        (334)
                    </li>
                    <li>
                        <a href="./standard/swift.html">swift documents</a>
                        (26)
                    </li>

            </ul>
        </nav>

        <ul class="social">
        </ul>
    </div>


</aside>
<main>
  <article class="single">
  <header>
    <div class="breadcrumb">
      <ol>
        <li>
              <a href="./standard/python.html">python</a>
        </li>
        <li>
            <a href="./standard/style-issues.html">Style issues</a>
        </li>
        <li>
            <a href="./category/code-style-and-efficiency.html">Code style and efficiency</a>
        </li>
        
    </ol>
    
    </div>

    <h1 id="PE22244">DUO134</h1>
    <p>
        Posted on September 28, 2024 in <a href="./category/code-style-and-efficiency.html">Code style and efficiency</a>

        &#8226; 1 min read
    </p>
  </header>

    <div class="toc">
<ul>
<li><a href="#duo134">DUO134</a><ul>
<li><a href="#problematic-code">Problematic code</a></li>
<li><a href="#correct-code">Correct code</a></li>
<li><a href="#rationale">Rationale</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>
</div>

  <div>
    
<h1 id="duo134">DUO134</h1>
<p>This linter searches for insecure attribute use of the <code>cryptography</code> module.</p>
<p>The Python <code>cryptography</code> library has become the defacto standard for
crytographic operations. Cryptographic operations are notoriously difficult
to get correct and often come with many gotchas. This linter searches for
insecure cryptographic primitives and operations in the <code>cryptography</code> library.</p>
<h2 id="problematic-code">Problematic code</h2>
<p>Any code using the following primitives/attributes should be considered
cryptographically deprecated and insecure:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">hashes</span><span class="o">.</span><span class="n">MD5</span>
<span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA1</span>
<span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">ECB</span>
<span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">Blowfish</span>
<span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span>
<span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">IDEA</span>
</pre></div>
</td></tr></table>
<p>Dlint also looks for PKCS1 v1.5 usage via the following attribute:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">asymmetric</span><span class="o">.</span><span class="n">padding</span><span class="o">.</span><span class="n">PKCS1v15</span>
</pre></div>
</td></tr></table>
<p>This primitive is not as strictly insecure as the above primitives, but its
usage should still be limited.</p>
<h2 id="correct-code">Correct code</h2>
<p>There are secure alternatives documented in the following locations:</p>
<ul>
<li><a href="https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/">https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/</a></li>
<li><a href="https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#algorithms">https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#algorithms</a></li>
</ul>
<p>For PKCS1 v1.5 alternatives consider the following:</p>
<ul>
<li>For signing operations: <a href="https://cryptography.io/en/latest/hazmat/primitives/asymmetric/rsa/#cryptography.hazmat.primitives.asymmetric.padding.PSS"><code>cryptography.hazmat.primitives.asymmetric.padding.PSS</code></a></li>
<li>For encryption operations: <a href="https://cryptography.io/en/latest/hazmat/primitives/asymmetric/rsa/#cryptography.hazmat.primitives.asymmetric.padding.OAEP"><code>cryptography.hazmat.primitives.asymmetric.padding.OAEP</code></a></li>
</ul>
<h2 id="rationale">Rationale</h2>
<p>The problematic hashing algorithms mentioned above have known collision
weaknesses.</p>
<p>The use of the ECB cipher mode can leave significant patterns in the output,
which can be used for cryptanalysis.</p>
<p>The problematic cipher algorithms mentioned above are susceptible to attacks
when using weak keys and can have serious weaknesses in their initial stream
output.</p>
<p>Finally, PKCS1 v1.5, when used in encryption operations, is vulnerable to chosen
ciphertext attacks.</p>
<h2 id="exceptions">Exceptions</h2>
<ul>
<li><code>PKCS1v15</code> may be used for legacy applications, but should not be considered
for new applications. It is still recommended to move away from <code>PKCS1v15</code>
usage as soon as possible.</li>
</ul>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/flake8.html">flake8</a>
    </p>
  </div>



    <div class="addthis_relatedposts_inline">


</article>
    <footer>
 <p>
  &copy; Pinpoint 2016-Present, Rights reserve
</p>

<p>
</p>     </footer>
</main>

  <script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pinpoint Document ",
  "url" : ".",
  "image": "",
  "description": "Manual and documents for Sourcebrella Pinpoint"
}
</script> 
<div id="initDiv"
     style="position: fixed; z-index: 1000; background-color: white; top: 0; right: 0; bottom: 0; left: 0; "></div>
<script type="text/javascript">
    window.onload = function () {
        document.getElementsByTagName('body')[0].style.display = "block";
        document.getElementById('initDiv').style.display = 'none';

        document.querySelectorAll('.global_lang li a').forEach(elm => {
            elm.addEventListener('click', (e) => {
                var lang = e.target.getAttribute('language-link');
                var abs_url = '/' + lang + '/';
                var reg = /\/(en|zh)\//;
                var newRef;
                var location = window.location;
                if (reg.test(location.href)) {
                    newRef = location.href.replace(reg, abs_url);
                } else {
                    var match = /\/(output|docs)\//.exec(window.location.href);
                    if (match) {
                        newRef = window.location.href.replace(match[0], '/' + match[1] + abs_url)
                    } else {
                        return;
                    }
                }
                window.open(newRef, '_self')
            })
        })
    };

</script>
</body>

</html>