<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7571">BE7571: Potential code injection when using OGNL expression</h2>
    <h3>Potential code injection when using OGNL expression</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>BE7571</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>Potential code injection when using OGNL expression</p>
<h4>Vulnerability and risk</h4>
<p>
    A expression is built with a dynamic value. The source of the value(s) should be verified to avoid
    that unfiltered values fall into this risky code evaluation.
</p>
<p><b>Code at risk:</b></p>
<p>
<pre>
public void getUserProperty(String property) {
  [...]
  //The first argument is the dynamic expression.
  return ognlUtil.getValue("user."+property, ctx, root, String.class);
}
</pre>
</p>
<p><b>Solution:</b></p>
<p>
In general, method evaluating OGNL expression should not received user input. It is intented to be used in static configurations and JSP.
</p>
<h4>Likelihood of Exploit</h4>
<p>medium</p>
<h4>References</h4>
<p>&lt;a href=&quot;https://community.saas.hpe.com/t5/Security-Research/Struts-2-OGNL-Expression-Injections/ba-p/288881&quot;&gt;HP Enterprise: Struts 2 OGNL Expression Injections by Alvaro MuÃ±oz&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://blog.gdssecurity.com/labs/2017/3/27/an-analysis-of-cve-2017-5638.html&quot;&gt;Gotham Digital Science: An Analysis Of CVE-2017-5638&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://struts.apache.org/docs/s2-016.html&quot;&gt;Apache Struts2: Vulnerability S2-016&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://struts.apache.org/docs/ognl.html&quot;&gt;Apache Struts 2 Documentation: OGNL&lt;/a&gt;&lt;br/&gt;</p>
</p>

    </section>
</article>
