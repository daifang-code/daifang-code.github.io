<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE1093">PE1093: 包含危险文件</h2>
    <h3>包含危险文件漏洞允许攻击者包含一个文件，通常是利用目标程序中实现的”动态包含文件“机制来实现的</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>PE1093</dd>
                    <dt>标签</dt>
                    <dd>JAVA</dd>
                    <dt>目录</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>缺陷描述</h4>
<p>包含危险文件漏洞允许攻击者包含一个文件，通常是利用目标程序中实现的”动态包含文件“机制来实现的。该漏洞主要出现在不会对用户提供的输入进行合理验证的系统中。</p>
<h4>漏洞与风险</h4>
<h5>包含远程文件</h5>
<p>当一个Web应用下载并运行一个远程文件时，可能会出现包含远程文件（Remote File Inclusion, RFI）问题。这些远程文件通常是从用户提供给本Web应用的HTTP或FTP的URI参数中获取的。</p>
<h5>包含本地文件</h5>
<p>包含本地文件（Local File Inclusion, LFI）问题与包含远程文件问题类似，不同之处在于只有Web应用所在的服务器下的本地文件才能被包含。但因为攻击者可能会包含一个受攻击者控制的数据文件，如Web服务器的访问日志，因此还是会存在远程代码执行的风险。</p>
<h4>漏洞利用威胁</h4>
<p>中</p>
<h4>缓解与预防</h4>
<ul>
<li>避免将用户提交的输入数据传递给文件系统或Web框架的API。</li>
<li>维护一个文件白名单列表，声明哪些文件能被页面包含，并通过使用标识符（如序号）来访问指定的那个的文件。</li>
</ul>
<h4>演示实例</h4>
<h5>漏洞代码示例</h5>
<div class="highlight"><pre><span></span><span class="k">&lt;%</span>
   <span class="n">String</span> <span class="n">p</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;p&quot;</span><span class="o">);</span>
   <span class="nd">@include</span> <span class="n">file</span><span class="o">=</span><span class="s">&quot;&lt;%=&quot;</span><span class="n">includes</span><span class="o">/</span><span class="s">&quot; + p +&quot;</span><span class="o">.</span><span class="na">jsp</span><span class="err">&quot;</span><span class="k">%&gt;</span>&quot;
%&gt;
</pre></div>
<h4>参考资料</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>https://www.owasp.org/index.php/Testing_for_Local_File_Inclusion<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
<li id="fn-2"><p>https://en.wikipedia.org/wiki/File_inclusion_vulnerability<a href="#fnref-2" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
