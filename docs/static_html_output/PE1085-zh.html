<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE1085">PE1085: 公式注入</h2>
    <h3>当网站在CSV文件中嵌入了不受信的输入时，有可能发生公式注入（也叫CSV注入）</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>PE1085</dd>
                    <dt>标签</dt>
                    <dd>JAVA</dd>
                    <dt>目录</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>缺陷描述</h4>
<p>当网站在CSV文件中嵌入了不受信的输入时，有可能发生公式注入（也叫CSV注入）。</p>
<h4>漏洞与风险</h4>
<p>当使用像<code>Microsoft Excel</code>或<code>LibreOffice Calc</code>这样的软件来打开一个CSV文件时，CSV中所有以<code>'='</code>开头的单元格都会被解释为公式。恶意构造的公式可以用作以下三种攻击：</p>
<ul>
<li>通过利用制表软件的漏洞，攻击者可以劫持用户的电脑，可见CVE-2014-3524。</li>
<li>通过利用用户不会在意自己网站上下载的表格文件这一惯性思维来劫持用户的电脑。</li>
<li>从当前或别的打开的表格文件中窃取数据。</li>
</ul>
<h4>漏洞利用威胁</h4>
<p>中</p>
<h4>缓解与预防</h4>
<p>这种攻击难以防范，为了防御这样的攻击，请确保没有单元格会以以下字符起首：</p>
<ul>
<li>等号'='</li>
<li>加号 '+'</li>
<li>减号 '-'</li>
<li>地址符 '@'</li>
</ul>
<h4>参考资料</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>https://www.owasp.org/index.php/CSV_Injection<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
