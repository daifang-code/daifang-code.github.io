<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7579">BE7579: WebView with JavaScript enabled (Android)</h2>
    <h3>WebView with JavaScript enabled (Android)</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>BE7579</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>WebView with JavaScript enabled (Android)</p>
<h4>Vulnerability and risk</h4>
<p>
    Enabling JavaScript for the WebView means that it is now susceptible to XSS. The page render should be inspected
    for potential reflected XSS, stored XSS and DOM XSS.<br/>
<pre>
WebView myWebView = (WebView) findViewById(R.id.webView);
WebSettings webSettings = myWebView.getSettings();
webSettings.setJavaScriptEnabled(true);
</pre>
</p>
<p>
    <b>Code at risk:</b><br/>
Enabling JavaScript is not a bad practice. It just means that the backend code need to be audited for potential XSS.
The XSS can also be introduce client-side with DOM XSS.
<pre>
function updateDescription(newDescription) {
    $("#userDescription").html("<p<"+newDescription+"</p<");
}
</pre>
</p>
<h4>Likelihood of Exploit</h4>
<p>medium</p>
<h4>References</h4>
<p>&lt;a href=&quot;http://www.technotalkative.com/issue-using-setjavascriptenabled-can-introduce-xss-vulnerabilities-application-review-carefully/&quot;&gt;Issue: Using setJavaScriptEnabled can introduce XSS vulnerabilities&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://developer.android.com/guide/webapps/webview.html#UsingJavaScript&quot;&gt;Android Official Doc: WebView&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://projects.webappsec.org/w/page/13246920/Cross%20Site%20Scripting&quot;&gt;WASC-8: Cross Site Scripting&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet&quot;&gt;OWASP: XSS Prevention Cheat Sheet&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_%28XSS%29&quot;&gt;OWASP: Top 10 2013-A3: Cross-Site Scripting (XSS)&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cwe.mitre.org/data/definitions/79.html&quot;&gt;CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')&lt;/a&gt;</p>

    </section>
</article>
