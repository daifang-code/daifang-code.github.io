<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE0134">PE0134: Exposes Session IDs in the URL</h2>
    <h3>Exposes Session IDs in the URL (e.g., URL rewriting)</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>PE0134</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>If the browser does not support cookies or the user blocks all cookies, the session ID can be appended to all URLs in the HTML page and these pages are sent to the client in response. In this way, when the user clicks on the URL, the session ID is automatically sent back to the server as part of the request line, not as a header line. This method is called URL rewriting.</p>
<h4>Vulnerability and risk</h4>
<p>With URL rewriting, the session ID in the URL is exposed to the attacker, so that an attacker can enter the system without authentication and obtain sensitive data of the system.</p>
<h4>Potential Mitigations</h4>
<p>Do not use URL rewriting or use HTTP POST method instead of directly using URL.</p>
<h4>Likelihood of Exploit</h4>
<p>Critical</p>
<h4>Demonstrative Examples</h4>
<h5>Vulnerable code Example</h5>
<div class="highlight"><pre><span></span><span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">encodeRedirectURL</span><span class="o">(</span><span class="s">&quot;dfddf.jsp?ID=admin&quot;</span><span class="o">));</span>
</pre></div>
<p>The session ID admin is exposed through the URL.</p>
<h5>Fixing Suggestion</h5>
<p>Use HTTP POST method instead of directly using URL.</p>
<h4>References</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>https://cwe.mitre.org/data/definitions/264.html<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
<li id="fn-2"><p>https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication<a href="#fnref-2" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
