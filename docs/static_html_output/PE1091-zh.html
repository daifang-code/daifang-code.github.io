<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE1091">PE1091: 违反信任边界</h2>
    <h3>该软件在同一个数据结构或结构化的消息中混入了受信的与不受信的数据</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>PE1091</dd>
                    <dt>标签</dt>
                    <dd>JAVA</dd>
                    <dt>目录</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>缺陷描述</h4>
<p>可以把信任边界想象成划分一个程序的一条界线，在线的一边，这不是的数据是不受信的；而在线的另外一边，数据都是受信的。程序的验证逻辑都是围绕这条线开展的——通过验证不受信一边的数据，把验证通过的数据移动到受信数据的一边。当程序模糊了信任边界时，我们称程序违反了信任边界原则。当在同一个数据结构中混杂了受信与不受信的数据时，程序员会更轻易地把不受信的数据当成受信数据。</p>
<h4>漏洞与风险</h4>
<p>当没有明确定义或久不维护信任边界时，程序员不可避免地会对哪些数据经过了认证而哪些没有经过验证的问题摸不着头脑。放任这种情况不管，最终会使得程序员直接使用没有经过验证的不受信数据。</p>
<h4>漏洞利用威胁</h4>
<p>中</p>
<h4>缓解与预防</h4>
<p>明确定义并尊重信任边界。</p>
<h4>演示实例</h4>
<h5>漏洞代码示例</h5>
<p>以下的代码展现了程序不对HTTP请求中的用户名信息验证，判断用户是否经过了认证，直接就把用户名参数存在了HTTP会话对象中：</p>
<div class="highlight"><pre><span></span><span class="n">usrname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;usrname&quot;</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="n">ATTR_USR</span><span class="o">,</span> <span class="n">usrname</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
<h4>参考资料</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>https://cwe.mitre.org/data/definitions/501.html<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
