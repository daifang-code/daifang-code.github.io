<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7508">BE7508: 污染的文件名读取</h2>
    <h3>污染的文件名读取</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>BE7508</dd>
                    <dt>标签</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>目录</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>缺陷描述</h4>
<p>污染的文件名读取</p>
<h4>漏洞与风险</h4>
<p>FileUpload API提供的文件名可以被客户机篡改，以引用未经授权的文件。</p>
<p>
例如：</p>
<ul>
<li><code>"../../../config/overide_file"</code></li>
<li><code>"shell.jsp\u0000expected.gif"</code></li>
</ul>
<p>因此，这些值不应该直接传递给文件系统API。如果可以接受，应用程序应该生成它自己的文件名并使用它们。否则，所提供的文件名应该经过适当的验证以确保它的结构正确，其中不应包含未经授权的路径字符（例如，/ \），并引用一个授权文件。
</p>
<h4>漏洞利用威胁</h4>
<p>中</p>
<h4>引用</h4>
<p>&lt;a href=&quot;http://blogs.securiteam.com/index.php/archives/1268&quot;&gt;Securiteam: File upload security recommendations&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cwe.mitre.org/data/definitions/22.html&quot;&gt;CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://projects.webappsec.org/w/page/13246952/Path%20Traversal&quot;&gt;WASC-33: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://www.owasp.org/index.php/Path_Traversal&quot;&gt;OWASP: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://capec.mitre.org/data/definitions/126.html&quot;&gt;CAPEC-126: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cwe.mitre.org/data/definitions/22.html&quot;&gt;CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')&lt;/a&gt;</p>

    </section>
</article>
