<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE0066">PE0066: Memory Leak</h2>
    <h3>Program does not track and release allocated memory after it has been used.</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>PE0066</dd>
                    <dt>Tags</dt>
                    <dd>C, CPP</dd>
                    <dt>Category</dt>
                    <dd>Checkers/CPP</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>When a memory is allocated, developers are responsible for tracking memory allocation and releasing the memory. If there are no more pointers or references to the memory, then it can no longer be tracked and identified for release.</p>
<h4>Vulnerability and risk</h4>
<p>Most memory leaks result in general software reliability problems, but if an attacker can intentionally trigger a memory leak, the attacker might be able to launch a denial of service attack (by crashing or hanging the program) or take advantage of other unexpected program behavior resulting from a low memory condition.</p>
<h4>Likelihood of Exploit</h4>
<p>High</p>
<h4>Potential mitigations</h4>
<p>Release memory after it is no longer used.</p>
<h4>Demonstrative Examples</h4>
<h5>Code example</h5>
<div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">bad</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
<p>In this example, after bad method execution, point p's pointing memory has not been released, which causes memory leak.</p>
<h5>Fixed code example</h5>
<div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">good</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
  <span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>In this example, at the end of good method execution, p's pointing memory has been released.</p>
<h4>References</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>https://cwe.mitre.org/data/definitions/404.html<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
