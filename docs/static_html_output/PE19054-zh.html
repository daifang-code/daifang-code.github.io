<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE19054">PE19054: webshell32</h2>
    <h3>webshell32</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>PE19054</dd>
                    <dt>标签</dt>
                    <dd>cobra</dd>
                    <dt>目录</dt>
                    <dd>Code style and efficiency</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h2>安全风险</h2>

<pre><code>    代码中存在webshell

    特征 `dQ99shell` 对应webshell样例
    [link](https://github.com/tennc/webshell/blob/4ca96011884b892ec15de130f76eb2a047b77493/www-7jyewu-cn/%E5%9B%BD%E5%A4%96%E5%85%8D%E6%9D%80PHP%E5%A4%A7%E9%A9%AC_%E6%9C%AA%E7%BF%BB%E8%AF%91.php)

    特征 `c999shexit` 对应webshell样例
    [link](https://github.com/tennc/webshell/blob/4ca96011884b892ec15de130f76eb2a047b77493/web-malware-collection-13-06-2012/PHP/c99-bd.txt)

</code></pre>
<h2>修复方案</h2>

<pre><code>    将该标记片段代码删除

</code></pre>
<h2>匹配规则</h2>
<p>$nofuncs='no\s<em>exec\s</em>functions|udf.dll|$b374k|POWER-BY\s<em>WWW.XXDDOS.COM|&lt;title&gt;Safes\s</em>Mode\s<em>Shell&lt;/title&gt;|Siyanur.PHP\s</em>&lt;/font&gt;|c999shexit()|$c99sh_|c99_sess_put(|Coded\s<em>by\s</em>cyb3r|cyb3r_getupdate(|coded\s<em>by\s</em>tjomi4|john.barker446@gmail.com|eval(&quot;\$x=gzin&quot;|eval(&quot;?&gt;&quot;.gzinflate(base64_decode(|eval(gzinflate(base64_decode(|eval(gzuncompress(base64_decode(|eval(gzinflate(str_rot13(base64_decode(|function_exists(&quot;zigetwar_buff_prepare&quot;)|dQ99shell|r57shell|c99shell|lama's'hell\s<em>v|Carbylamine\s</em>PHP\s<em>Encoder|Safe\s</em>Mode\s<em>Shell|$dI3h=${'_REQUEST'};|new\s</em>COM(&quot;IIS://localhost/w3svc&quot;)|n57http-based[\s<em>-]terminal|Dosya\s</em>Olu|errorlog(&quot;BACKEND:\s<em>startReDuh,|form\s</em>name=sh311Form|PHPJackal&lt;br&gt;|Reddragonfly's\s<em>WebShell|(&quot;system&quot;==$seletefunc)?system($shellcmd)|eNrsvGmT40iSKPZ5xmz|CrystalShell\s</em>v.|Special\s<em>99\s</em>Shell|Simple\s<em>PHP\s</em>Mysql\s*client|'_de'.'code'|phpsocks5_encrypt(|define('PHPSHELL_VERSION',|ZXZhbCgkX1BPU1RbMV0p|$__H_H($__C_C&quot;</p>
<h4>References</h4>
<p>[^cobra] : https://github.com/WhaleShark-Team/cobra</p>

    </section>
</article>
