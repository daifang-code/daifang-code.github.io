<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE0099">PE0099: Less assignment operator in class</h2>
    <h3>Less assignment operator in class.</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>PE0099</dd>
                    <dt>Tags</dt>
                    <dd>CPP</dd>
                    <dt>Category</dt>
                    <dd>Checkers/CPP</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>The class only defines the copy constructor without defining an assignment operator, or only defines the assignment operator without defining a copy constructor.</p>
<h4>Vulnerability and risk</h4>
<p>The default copy constructor and assignment operator generated by the C++ compiler can only implement shallow copying of data members of the class. Therefore, if the copy constructor and the assignment operator are not explicitly defined, errors such as memory leaks, resource leaks, use after free, double free may occur.</p>
<h4>Likelihood of Exploit</h4>
<p>Low</p>
<h4>Potential Mitigations</h4>
<p>If the member variable of a class contains dynamically allocated memory or resources, the copy constructor and the assignment operator should be explicitly defined.</p>
<h4>Demonstrative Examples</h4>
<h5>Vulnerable Code Example</h5>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span>  <span class="c1">//The class only defines the copy constructor</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
  <span class="n">MyClass</span><span class="p">(</span><span class="k">const</span> <span class="n">MyClass</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">);</span>  <span class="c1">//Copy constructor</span>
<span class="p">};</span>
</pre></div>
<p>In the above code, the class MyClass only defines the copy constructor, and the assignment operator is missing.</p>
<h5>Fixed Code Example</h5>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span>      
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
  <span class="n">MyClass</span><span class="p">(</span><span class="k">const</span> <span class="n">MyClass</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">);</span>  <span class="c1">///Copy constructor</span>
  <span class="n">MyClass</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">MyClass</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">);</span>  <span class="c1">//Assignment operator</span>
<span class="p">}</span>
</pre></div>
<h4>Reference</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>SJ/T 11682-2017 6.4.4<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
