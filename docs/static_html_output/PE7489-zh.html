<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7489">BE7489: 没有安全标志的Cookie</h2>
    <h3>没有安全标志的Cookie</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>BE7489</dd>
                    <dt>标签</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>目录</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>缺陷描述</h4>
<p>没有安全标志的Cookie</p>
<h4>漏洞与风险</h4>
<p>
  一个新的cookie在没有<code>Secure</code>标志的情况下创建。
<code>Secure</code>标志是对浏览器的一个指令，以确保cookie不会被发送到不安全的通信中 (<code>http://</code>)。
 </p>
 <p>
<p>&lt;b&gt;有风险的代码：&lt;/b&gt;&lt;br/&gt;</p>
<pre>
Cookie cookie = new Cookie("userName",userName);
response.addCookie(cookie);
</pre>
 </p>
 <p>
<p>&lt;b&gt;解决方案(特定配置)：&lt;/b&gt;&lt;br/&gt;</p>
<pre>
Cookie cookie = new Cookie("userName",userName);
cookie.setSecure(true); // Secure flag
cookie.setHttpOnly(true);
</pre>
 </p>
 <p>
<p>&lt;b&gt;解决方案(Servlet 3.0配置)：&lt;/b&gt;&lt;br/&gt;</p>
<pre>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"<
[...]
<session-config<
 <cookie-config<
  <http-only<true</http-only<
  <secure<true</secure<
 </cookie-config<
</session-config<
</web-app<
</pre>
 </p>
<h4>漏洞利用威胁</h4>
<p>中</p>
<h4>Reference</h4>
<p>&lt;a href=&quot;https://cwe.mitre.org/data/definitions/614.html&quot;&gt;CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;https://cwe.mitre.org/data/definitions/315.html&quot;&gt;CWE-315: Cleartext Storage of Sensitive Information in a Cookie&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;https://cwe.mitre.org/data/definitions/311.html&quot;&gt;CWE-311: Missing Encryption of Sensitive Data&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;https://www.owasp.org/index.php/SecureFlag&quot;&gt;OWASP: Secure Flag&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;https://www.rapid7.com/db/vulnerabilities/http-cookie-secure-flag&quot;&gt;Rapid7: Missing Secure Flag From SSL Cookie&lt;/a&gt;</p>

    </section>
</article>
