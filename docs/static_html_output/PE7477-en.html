<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7477">BE7477: Overly permissive CORS policy</h2>
    <h3>Overly permissive CORS policy</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>BE7477</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>Overly permissive CORS policy</p>
<h4>Vulnerability and risk</h4>
<p>
Prior to HTML5, Web browsers enforced the Same Origin Policy which ensures that in order for JavaScript to access the contents of a Web page, both the JavaScript and the Web page must originate from the same domain. Without the Same Origin Policy, a malicious website could serve up JavaScript that loads sensitive information from other websites using a client's credentials, cull through it, and communicate it back to the attacker. HTML5 makes it possible for JavaScript to access data across domains if a new HTTP header called Access-Control-Allow-Origin is defined. With this header, a Web server defines which other domains are allowed to access its domain using cross-origin requests. However, caution should be taken when defining the header because an overly permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.
</p>
<p>
    <b>Vulnerable Code:</b>
<pre>response.addHeader("Access-Control-Allow-Origin", "*");</pre>
</p>
<p>
    <b>Solution:</b>
<br/>
Avoid using * as the value of the Access-Control-Allow-Origin header, which indicates that the application's data is accessible to JavaScript running on any domain.
</p>
<h4>Likelihood of Exploit</h4>
<p>high</p>
<h4>References</h4>
<p>&lt;a href=&quot;https://www.w3.org/TR/cors/&quot;&gt;W3C Cross-Origin Resource Sharing&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://enable-cors.org/&quot;&gt;Enable Cross-Origin Resource Sharing&lt;/a&gt;&lt;br/&gt;</p>
</p>

    </section>
</article>
