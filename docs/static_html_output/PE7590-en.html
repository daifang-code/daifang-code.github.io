<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7590">BE7590: Potential template injection with Freemarker</h2>
    <h3>Potential template injection with Freemarker</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>BE7590</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>Potential template injection with Freemarker</p>
<h4>Vulnerability and risk</h4>
<p>
Freemarker template engine is powerful. It is possible to add logic including condition statements, loops and external calls.
It is not design to be sandbox to templating operations. A malicious user in control of a template can run malicious code
on the server-side. Freemarker templates should be seen as scripts.
</p>
<p>
    <b>Vulnerable Code:</b>
<pre>Template template = cfg.getTemplate(inputTemplate);
[...]
template.process(data, swOut);</pre>
</p>
<p>
    <b>Solution:</b>
<br/>
Avoid letting end users manipulate templates with Freemarker. If you need to expose template editing to your users,
prefer logic-less template engines such as Handlebars or Moustache (See references).
</p>
<h4>Likelihood of Exploit</h4>
<p>low</p>
<h4>References</h4>
<p>&lt;a href=&quot;http://blog.portswigger.net/2015/08/server-side-template-injection.html&quot;&gt;PortSwigger: Server-Side Template Injection &lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://jknack.github.io/handlebars.java/&quot;&gt;Handlebars.java&lt;/a&gt;&lt;br/&gt;</p>
</p>

    </section>
</article>
