<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE1075">PE1075: JavaScript Hijacking</h2>
    <h3>An attacker targets a system that uses JSON as a transport mechanism between the client and the server to steal possibly confidential information transmitted from the server back to the client inside the JSON object</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>PE1075</dd>
                    <dt>Tags</dt>
                    <dd>JAVA</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>Also known as JSON Hijacking. An attacker targets a system that uses JavaScript Object Notation (JSON) as a transport mechanism between the client and the server (common in Web 2.0 systems using AJAX) to steal possibly confidential information transmitted from the server back to the client inside the JSON object by taking advantage of the loophole in the browser's Same Origin Policy that does not prohibit JavaScript from one website to be included and executed in the context of another website.</p>
<h4>Vulnerability and risk</h4>
<p>An attacker gets the victim to visit his or her malicious page that contains a script tag whose source points to the vulnerable system with a URL that requests a response from the server containing a JSON object with possibly confidential information. The malicious page also contains malicious code to capture the JSON object returned by the server before any other processing on it can take place, typically by overriding the JavaScript function used to create new objects. This hook allows the malicious code to get access to the creation of each object and transmit the possibly sensitive contents of the captured JSON object to the attackers' server. There is nothing in the browser's security model to prevent the attackers' malicious JavaScript code (originating from attacker's domain) to set up an environment (as described above) to intercept a JSON object response (coming from the vulnerable target system's domain), read its contents and transmit to the attackers' controlled site. The same origin policy protects the domain object model (DOM), but not the JSON.</p>
<h4>Likelihood of Exploit</h4>
<p>Medium</p>
<h4>Potential Mitigations</h4>
<ul>
<li><p>Ensure that server side code can differentiate between legitimate requests and forged requests.</p>
</li>
<li><p>Make the URLs in the system used to retrieve JSON objects unpredictable and unique for each user session.</p>
</li>
<li><p>Ensure that to the extent possible, no sensitive data is passed from the server to the client via JSON objects.</p>
</li>
</ul>
<h4>References</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>https://capec.mitre.org/data/definitions/111.html<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
