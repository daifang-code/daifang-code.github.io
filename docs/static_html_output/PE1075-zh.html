<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE1075">PE1075: JavaScript劫持</h2>
    <h3>攻击者瞄准以JSON文件作为服务器与客户端间的传播媒介的系统，从由服务器传向客户端的JSON文件中盗取可能存在的机密信息</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>PE1075</dd>
                    <dt>标签</dt>
                    <dd>JAVA</dd>
                    <dt>目录</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>缺陷描述</h4>
<p>也被称作JSON劫持，攻击者瞄准以JSON文件作为服务器与客户端间的传播媒介的系统（在使用到AJAX的Web2.0系统中极其普遍），通过利用浏览器中同源政策（Same Origin Policy）不会禁止来自一个网站的JavaScript被另外一个网站的上下文包含并运行的行为漏洞，从由服务器传向客户端的JSON文件中盗取可能存在的机密信息。</p>
<h4>漏洞与风险</h4>
<p>攻击者会迫使受害者访问一个带脚本标签的恶意页面，该脚本标签的源指向存在漏洞的系统并且包含一条请求该服务器以一个可能包含机密信息的JSON文件作为响应的URL。这个恶意页面还包含用作捕获服务器返回的JSON文件的恶意代码，这段代码能在任何别的处理发生之前完成捕获，通常是通过重写用作创建新对象的JavaScript函数来实现。这个钩子将使得恶意代码能访问每个对象的创建过程，进而将捕获到的可能存在机密信息的JSON文件传输到攻击者的服务器上，然而浏览器的安全模型里没有任何办法能够这样的行为。尽管上面提到的同源政策能够保护DOM，但它对瞄准JSON的攻击无能为力。</p>
<h4>漏洞利用威胁</h4>
<p>中</p>
<h4>缓解与预防</h4>
<ul>
<li>确保服务器端的代码能够识别合法与伪造的请求。</li>
<li>想办法使获取JSON对象的URL无法预测且独特于每个用户的session信息。</li>
<li>尽可能确保从服务器端向客户端传输数据的过程中没有机密信息会以JSON作为媒介。</li>
</ul>
<h4>参考资料</h4>
<section class="footnotes">
<ol>
<li id="fn-1"><p>https://capec.mitre.org/data/definitions/111.html<a href="#fnref-1" class="footnote">&#8617;</a></p></li>
</ol>
</section>

    </section>
</article>
