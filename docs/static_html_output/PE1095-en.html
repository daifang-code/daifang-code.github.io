<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE1095">PE1095: XQuery Injection</h2>
    <h3>The software uses external input to dynamically construct an XQuery expression used to retrieve data from an XML database, but it does not neutralize or incorrectly neutralizes that input</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>PE1095</dd>
                    <dt>Tags</dt>
                    <dd>JAVA</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>The software uses external input to dynamically construct an XQuery expression used to retrieve data from an XML database, but it does not neutralize or incorrectly neutralizes that input. This allows an attacker to control the structure of the query.</p>
<h4>Vulnerability and risk</h4>
<p>The net effect is that the attacker will have control over the information selected from the XML database and may use that ability to control application flow, modify logic, retrieve unauthorized data, or bypass important checks (e.g. authentication).</p>
<h4>Likelihood of Exploit</h4>
<p>Medium</p>
<h4>Potential Mitigations</h4>
<ul>
<li><p>Use parameterized queries.</p>
</li>
<li><p>Properly validate user input.</p>
</li>
</ul>
<h4>Demonstrative Examples</h4>
<h5>Vulnerable Code Example</h5>
<p>The string below is an example of an attacker accessing the accounts.xml to request the service provider send all user names back:</p>

<pre><code>doc(accounts.xml)//user[Name='*']
</code></pre>
<h4>References</h4>
<p>[^capec]ï¼š https://capec.mitre.org/data/definitions/84.html</p>

    </section>
</article>
