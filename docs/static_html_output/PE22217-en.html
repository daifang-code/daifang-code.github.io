<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:PE22217">PE22217: DUO107</h2>
    <h3>DUO107</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>PE22217</dd>
                    <dt>Tags</dt>
                    <dd>flake8</dd>
                    <dt>Category</dt>
                    <dd>Code style and efficiency</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>DUO107</h4>
<p>This linter searches for use of the <code>lxml</code>, <code>xml</code>, <code>xmlrpclib</code> modules. These
libraries are not hardened against many common XML attacks. The <code>defusedxml</code>
library should be preferred to these modules.</p>
<h2>Problematic code</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xml.etree.ElementTree</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="n">et</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">xmlfile</span><span class="p">)</span>
</pre></div>
<h2>Correct code</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">defusedxml.ElementTree</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="n">et</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">xmlfile</span><span class="p">)</span>
</pre></div>
<h2>Rationale</h2>
<p>The XML data format is notoriously complex and provides many attack vectors.
Common Python XML libriaries are vulnerable to various attacks such as
exponential entity expansion, quadratic entity expansion, remote and local
external entity expansion, DTD retrieval, etc.</p>
<p>For more information on specific vulnerabilities see <a href="https://pypi.org/project/defusedxml/#python-xml-libraries">Python XML Libraries</a>.</p>
<h2>Exceptions</h2>
<ul>
<li>The <code>xml.sax.saxutils</code> sub-module is safe to use</li>
</ul>

    </section>
</article>
