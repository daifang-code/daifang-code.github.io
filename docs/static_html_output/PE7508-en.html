<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7508">BE7508: Tainted filename read</h2>
    <h3>Tainted filename read</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>BE7508</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>Tainted filename read</p>
<h4>Vulnerability and risk</h4>
<p>The filename provided by the FileUpload API can be tampered with by the client to reference unauthorized files.</p>
<p>For example:</p>
<ul>
<li><code>"../../../config/overide_file"</code></li>
<li><code>"shell.jsp\u0000expected.gif"</code></li>
</ul>
<p>Therefore, such values should not be passed directly to the filesystem API. If acceptable, the application should generate its 
own file names and use those. Otherwise, the provided filename should be properly validated to ensure it's properly structured, 
contains no unauthorized path characters (e.g., / \), and refers to an authorized file.</p>
<h4>Likelihood of Exploit</h4>
<p>medium</p>
<h4>References</h4>
<p>&lt;a href=&quot;http://blogs.securiteam.com/index.php/archives/1268&quot;&gt;Securiteam: File upload security recommendations&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cwe.mitre.org/data/definitions/22.html&quot;&gt;CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://projects.webappsec.org/w/page/13246952/Path%20Traversal&quot;&gt;WASC-33: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://www.owasp.org/index.php/Path_Traversal&quot;&gt;OWASP: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://capec.mitre.org/data/definitions/126.html&quot;&gt;CAPEC-126: Path Traversal&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cwe.mitre.org/data/definitions/22.html&quot;&gt;CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')&lt;/a&gt;</p>

    </section>
</article>
