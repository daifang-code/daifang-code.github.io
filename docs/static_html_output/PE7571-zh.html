<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7571">BE7571: 使用OGNL表达式时可能的代码注入</h2>
    <h3>使用OGNL表达式时可能的代码注入</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">缺陷信息</h4>
                <dl>
                    <dt>缺陷ID</dt>
                    <dd>BE7571</dd>
                    <dt>标签</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>目录</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>作者</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>缺陷描述</h4>
<p>使用OGNL表达式时可能的代码注入</p>
<h4>漏洞与风险</h4>
<p>
表达式使用动态值构建。应验证值的来源，如果数据来源于外部用户输入，请确保检查内部没有恶意代码。
</p>
<p><b>风险代码：</b></p>
<p>
<pre>
public void getUserProperty(String property) {
  [...]
  //第一个参数是动态表达式。
  return ognlUtil.getValue("user."+property, ctx, root, String.class);
}
</pre>
</p>
<p><b>解决方案：</b></p>
<p>
通常，评估OGNL表达式的方法不应该接收用户输入。它旨在用于静态配置和JSP。
</p>
<h4>漏洞利用威胁</h4>
<p>中</p>
<h4>引用</h4>
<p>&lt;a href=&quot;https://community.saas.hpe.com/t5/Security-Research/Struts-2-OGNL-Expression-Injections/ba-p/288881&quot;&gt;HP Enterprise: Struts 2 OGNL Expression Injections by Alvaro MuÃ±oz&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://blog.gdssecurity.com/labs/2017/3/27/an-analysis-of-cve-2017-5638.html&quot;&gt;Gotham Digital Science: An Analysis Of CVE-2017-5638&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://struts.apache.org/docs/s2-016.html&quot;&gt;Apache Struts2: Vulnerability S2-016&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://struts.apache.org/docs/ognl.html&quot;&gt;Apache Struts 2 Documentation: OGNL&lt;/a&gt;&lt;br/&gt;</p>
</p>

    </section>
</article>
