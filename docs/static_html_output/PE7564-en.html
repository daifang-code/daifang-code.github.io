<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7564">BE7564: Cipher is susceptible to Padding Oracle</h2>
    <h3>Cipher is susceptible to Padding Oracle</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>BE7564</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>Cipher is susceptible to Padding Oracle</p>
<h4>Vulnerability and risk</h4>
<p>
    This specific mode of CBC with PKCS5Padding is susceptible to padding oracle attacks. An adversary could potentially decrypt the
    message if the system exposed the difference between plaintext with invalid padding or valid padding. The distinction between
    valid and invalid padding is usually revealed through distinct error messages being returned for each condition.
</p>
<p>
    <b>Code at risk:</b>
    <pre>Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<p>
    <b>Solution:</b>
    <pre>Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);</pre>
</p>
<h4>Likelihood of Exploit</h4>
<p>high</p>
<h4>References</h4>
<p>&lt;a href=&quot;http://www.infobytesec.com/down/paddingoracle_openjam.pdf&quot;&gt;Padding Oracles for the masses (by Matias Soler)&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://en.wikipedia.org/wiki/Authenticated_encryption&quot;&gt;Wikipedia: Authenticated encryption&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html#01&quot;&gt;NIST: Authenticated Encryption Modes&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://capec.mitre.org/data/definitions/463.html&quot;&gt;CAPEC: Padding Oracle Crypto Attack&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cwe.mitre.org/data/definitions/696.html&quot;&gt;CWE-696: Incorrect Behavior Order&lt;/a&gt;</p>
</p>

    </section>
</article>
