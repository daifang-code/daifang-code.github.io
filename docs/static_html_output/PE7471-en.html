<article class="bugdoc">
    <h2 class="bugdoc-title" id="Bug-Doc:BE7471">BE7471: RequestDispatcher File Disclosure</h2>
    <h3>RequestDispatcher File Disclosure</h3>
    <section id="tip">
     <h4 style="border-top: 0pt; padding: 0pt 4pt 4pt 4pt;">Bug info</h4>
                <dl>
                    <dt>BugTypeID</dt>
                    <dd>BE7471</dd>
                    <dt>Tags</dt>
                    <dd>JAVA ,FIND-SEC-BUGS</dd>
                    <dt>Category</dt>
                    <dd>Checkers/JAVA</dd>
                    <dt>Authors</dt>
                    <dd>pinpoint</dd>
                </dl>
    <h4>Description</h4>
<p>RequestDispatcher File Disclosure</p>
<h4>Vulnerability and risk</h4>
<p>
Constructing a server-side redirect path with user input could allow an attacker to download application binaries (including application classes or jar files) or view arbitrary files within protected directories.<br/>
An attacker may be able to forge a request parameter to match sensitive file locations. For example, requesting "http://example.com/?jspFile=../applicationContext.xml%3F" would display the application's applicationContext.xml file. The attacker would be able to locate and download the applicationContext.xml referenced in the other configuration files, and even class files or jar files, obtaining sensitive information and launching other types of attacks.
</p>
<p>
    <b>Vulnerable Code:</b><br/>
<pre>...
String jspFile = request.getParameter("jspFile");
request.getRequestDispatcher("/WEB-INF/jsps/" + jspFile + ".jsp").include(request, response);
...</pre>
</p>
<p>
    <b>Solution:</b><br/>
Avoid constructing server-side redirects using user controlled input.
</p>
<br/>
<h4>Likelihood of Exploit</h4>
<p>high</p>
<h4>References</h4>
<p>&lt;a href=&quot;https://cwe.mitre.org/data/definitions/552.html&quot;&gt;CWE-552: Files or Directories Accessible to External Parties&lt;/a&gt;&lt;br/&gt;</p>

    </section>
</article>
